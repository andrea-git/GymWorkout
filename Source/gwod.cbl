      *{TOTEM}PRG-COMMENT
      * gwod.Cbl
      * gwod.Cbl is generated by TOTEM
      * This is a generated file. DO NOT modify this file directly.
      *{TOTEM}END
       IDENTIFICATION       DIVISION.
      *{TOTEM}PRGID
       PROGRAM-ID.          gwod.
       AUTHOR.              andre.
       DATE-WRITTEN.        sabato 21 ottobre 2023 14:21:56.
       REMARKS.
      *{TOTEM}END

       ENVIRONMENT          DIVISION.
       CONFIGURATION        SECTION.
       SPECIAL-NAMES.
      *{TOTEM}SPECIAL-NAME
      * <TOTEM:EPT. INIT:gwod, INIT:gwod, SpecialName>
      * <TOTEM:END>
      *{TOTEM}END
      *{TOTEM}ACTIVEX-DEF
      *{TOTEM}END
      *{TOTEM}DECIMAL-POINT
           DECIMAL-POINT IS COMMA.
      *{TOTEM}END

       INPUT-OUTPUT         SECTION.
       FILE-CONTROL.
      *{TOTEM}FILE-CONTROL
           COPY "exercises.sl".
           COPY "groups.sl".
           COPY "macrogroups.sl".
           COPY "duration.sl".
           COPY "tmp-exe-effort.sl".
           COPY "wodmap.sl".
           COPY "tmp-wod-exe.sl".
           COPY "tmp-exe.sl".
           COPY "intexe.sl".
           COPY "tmp-exe-dupl.sl".
           COPY "zoom-exe-mcg.sl".
           COPY "tmp-hit.sl".
           COPY "tmp-grp-exe.sl".
           COPY "tmp-superset.sl".
           COPY "zoom-wodbook.sl".
           COPY "rwodbook.sl".
           COPY "twodbook.sl".
      *{TOTEM}END
       DATA                 DIVISION.
       FILE                 SECTION.
      *{TOTEM}FILE
           COPY "exercises.fd".
           COPY "groups.fd".
           COPY "macrogroups.fd".
           COPY "duration.fd".
           COPY "tmp-exe-effort.fd".
           COPY "wodmap.fd".
           COPY "tmp-wod-exe.fd".
           COPY "tmp-exe.fd".
           COPY "intexe.fd".
           COPY "tmp-exe-dupl.fd".
           COPY "zoom-exe-mcg.fd".
           COPY "tmp-hit.fd".
           COPY "tmp-grp-exe.fd".
           COPY "tmp-superset.fd".
           COPY "zoom-wodbook.fd".
           COPY "rwodbook.fd".
           COPY "twodbook.fd".
      *{TOTEM}END

       WORKING-STORAGE      SECTION.
      *{TOTEM}ACU-DEF
               COPY "acugui.def".
               COPY "acucobol.def".
               COPY "fonts.def".
               COPY "crtvars.def".
               COPY "showmsg.def".
               COPY "totem.def".
               COPY "comune.def".
               COPY "custom.def".
               COPY "UTYDATA.DEF".
      *{TOTEM}END

      *{TOTEM}COPY-WORKING
      * Key Status
       77 Key-Status IS SPECIAL-NAMES CRT STATUS PIC 9(5) VALUE 0.
          88 Enter-Pushed VALUE 13.
          88 Exit-Pushed VALUE 27.
          88 Message-Received VALUE 95.
          88 Event-Occurred VALUE 96.
          88 Screen-No-Input-Field VALUE 97.
          88 Screen-Time-Out VALUE 99.
      * Properties & User defined Working Stoarge
       78 titolo VALUE IS "Gestione WOD". 
           COPY  "EXTERNALS.DEF".
       77 Form1-Tb-1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 toolbar-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 E-ESCI           PIC  9
                  VALUE IS 1.
       77 E-NUOVO          PIC  9
                  VALUE IS 1.
       77 E-CANCELLA       PIC  9
                  VALUE IS 1.
       77 E-SALVA          PIC  9
                  VALUE IS 1.
       77 E-ANTEPRIMA      PIC  9
                  VALUE IS 1.
       77 E-MODIFICA       PIC  9
                  VALUE IS 1.
       77 E-STAMPA         PIC  9
                  VALUE IS 0.
       77 E-CERCA          PIC  9
                  VALUE IS 0.
       77 E-SELEZIONA      PIC  9
                  VALUE IS 1.
       77 Small-Font
                  USAGE IS HANDLE OF FONT SMALL-FONT.
       01 FILLER           PIC  9.
           88 chiamata-normale VALUE IS 1. 
           88 chiamata-lookup VALUE IS 2. 
       77 Form1-St-1-Handle
                  USAGE IS HANDLE OF STATUS-BAR.
       77 form1-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 como-hit         PIC  xxx.
       77 link-stampante   PIC  x(200).
       77 como-effort      PIC  99.
       77 tot-series       PIC  999.
       77 como-giorno      PIC  99.
       77 como-tit-macro   PIC  x(13).
       77 save-day         PIC  9.
       77 como-series      PIC  999.
       77 como-grp-desc    PIC  x(100).
       77 nessuna-scelta   PIC  9
                  VALUE IS 0.
       77 s-data           PIC  9(8)
                  VALUE IS 0.
       77 el-dati-wod      PIC  x(200)
                  OCCURS 999 TIMES.
       77 ws-narg          PIC  99
                  USAGE IS COMP-1.
       01 filtro-tipo      PIC  9.
           88 filtro-testa VALUE IS 1. 
           88 filtro-righe VALUE IS 2. 
       77 riga-div         PIC  999.
       77 como-grp-code    PIC  x(5).
       77 riga-aggiunta    PIC  999.
       77 sec-squeeze      PIC  99.
       77 exe-probabili    PIC  99.
       77 como-split       PIC  99.
       77 tentativo        PIC  99.
       77 como-code        PIC  9(18).
       77 como-data-x10    PIC  99/99/9999.
       77 s-tod-code       PIC  9(18).
       77 como-tod-code    PIC  x(18).
       77 primo-giorno     PIC  9(8).
       77 como-data-from   PIC  9(8).
       77 como-data-to     PIC  9(8).
       77 text-len
                  USAGE IS UNSIGNED-INT.
       77 countChar        PIC  9(3).
       78 78-lab-tutti VALUE IS "Vuoto = Tutti". 
       01 como-tex-data-tab.
           05 como-tex-data-el PIC  x(1000)
                      OCCURS 99 TIMES.
       01 exe-probabili-tab.
           05 exe-code-probabile-el        PIC  x(5)
                      OCCURS 50 TIMES.
       01 FILLER           PIC  9
                  VALUE IS 0.
           88 reloadGrid VALUE IS 1    WHEN SET TO FALSE  0. 
       01 s-tex-key.
           05 s-tex-day        PIC  9.
           05 s-tex-split      PIC  9(3).
       01 mcg-sigle-tab.
           05 el-mcg-sigla     PIC  x
                      OCCURS 10 TIMES.
       77 s-int-buf        PIC  x(100).
       77 s-dur-desc       PIC  x(100).
       77 como-mm          PIC  xx.
       77 como-hh          PIC  xx.
       77 como-xx1         PIC  xxx.
       77 como-xx2         PIC  xxx.
       77 como-durata      PIC  x(100).
       77 s-gio-buf        PIC  x(100).
       77 como-nome        PIC  x(100).
       77 tot-subst        PIC  999.
       77 AUTO-ID          PIC  9(6)
                  VALUE IS 0,00.
       77 como-minuto-i    PIC  x(6).
       77 como-ora-e       PIC  x(3).
       77 colore           PIC  999.
       77 como-e           PIC  999.
       77 s-mcg-code       PIC  x(5).
       77 s-int-effort     PIC  99.
       01 tab-prim.
           05 como-prim        PIC  9
                      OCCURS 10 TIMES.
       77 BOTTONE-annulla-BMP          PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 Form1-Tb-1-Handlea
                  USAGE IS HANDLE OF WINDOW.
       01 FILLER           PIC  9.
           88 ApriLookup VALUE IS 1    WHEN SET TO FALSE  0. 
       77 Form1-Tb-1-Handlea
                  USAGE IS HANDLE OF WINDOW.
       01 rec-schema.
           05 sigle-effort.
               10 sigle-effort-1   PIC  x(8).
               10 sigle-effort-2   PIC  x(8).
               10 sigle-effort-3   PIC  x(8).
               10 sigle-effort-4   PIC  x(8).
               10 sigle-effort-5   PIC  x(8).
               10 sigle-effort-6   PIC  x(8).
               10 sigle-effort-7   PIC  x(8).
               10 sigle-effort-8   PIC  x(8).
               10 sigle-effort-9   PIC  x(8).
               10 sigle-effort-10  PIC  x(8).
           05 mcg.
               10 mcg-1            PIC  x(5).
               10 mcg-2            PIC  x(5).
               10 mcg-3            PIC  x(5).
               10 mcg-4            PIC  x(5).
               10 mcg-5            PIC  x(5).
               10 mcg-6            PIC  x(5).
               10 mcg-7            PIC  x(5).
               10 mcg-8            PIC  x(5).
               10 mcg-9            PIC  x(5).
               10 mcg-10           PIC  x(5).
       01 tab-exe.
           05 el-exe
                      OCCURS 20 TIMES.
               10 el-exe-code      PIC  x(5).
               10 el-exe-desc      PIC  x(100).
               10 el-exe-used      PIC  9.
               10 el-exe-effort    PIC  99.
               10 el-exe-isRestpause           PIC  9.
       01 tab-wod-exe.
           05 el-wod-day
                      OCCURS 7 TIMES.
               10 el-wod-mcg-exe
                          OCCURS 20 TIMES.
                   15 el-wod-mcg       PIC  x(5).
                   15 el-wod-exe-code  PIC  x(5).
                   15 el-wod-exe-desc  PIC  x(100).
                   15 el-wod-exe-effort            PIC  9.
       77 RigheIniziali    PIC  9(3).
       77 como-giorni      PIC  99.
       77 hh   PIC  99.
       77 mm   PIC  99.
       77 resto            PIC  9(5).
       77 tot-durata       PIC  9(10).
       77 lastIdx          PIC  9(3).
       77 idx1 PIC  9(3).
       77 idx1-p           PIC  9(3).
       77 idx2 PIC  9(3).
       77 idx-days         PIC  9(3).
       77 idx-split        PIC  9(3).
       77 como-range-from  PIC  xx.
       77 como-range-to    PIC  xx.
       77 como-x           PIC  x.
       77 primari-rimasti  PIC  99.
       77 tot-mcg          PIC  99.
       77 tot-mcg-p        PIC  99.
       77 tot-exe          PIC  99.
       01 como-tab-mcg.
           05 como-el-mcg-desc PIC  x(100)
                      OCCURS 10 TIMES.
       01 tab-mcg.
           05 el-mcg-desc      PIC  x(100)
                      OCCURS 10 TIMES.
       01 como-tab-mcg-p.
           05 como-el-mcg-desc-p           PIC  x(100)
                      OCCURS 10 TIMES.
       01 tab-mcg-p.
           05 el-mcg-desc-p    PIC  x(100)
                      OCCURS 10 TIMES.
       77 tot-gruppi       PIC  999.
       77 tot-hit          PIC  999.
       77 idx-gruppi       PIC  999.
       01 tab-mgroups.
           05 el-mgroups
                      OCCURS 10 TIMES.
               10 el-mgroup        PIC  x(100).
               10 el-mcg-code      PIC  x(5).
               10 el-hit           PIC  99.
               10 el-mcg-color     PIC  999.
       01 rec-grid.
           05 col-day          PIC  9.
           05 col-exe-prg      PIC  99.
           05 col-grp-code     PIC  x(5).
           05 col-grp-desc     PIC  x(100).
           05 col-exe-code     PIC  x(5).
           05 col-exe-desc     PIC  x(100).
           05 col-series       PIC  99.
           05 col-reps         PIC  x(20).
           05 col-ss           PIC  z.
       77 Calibri14-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 Calibri14B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 cambia-cliente-bmp           PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 Calibri12-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 Calibri12B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 contact-bmp
                  USAGE IS HANDLE OF BITMAP.
       77 Calibri18B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 default-bmp
                  USAGE IS HANDLE OF BITMAP.
       77 Calibri16B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 form-prezz-SF-HANDLE
                  USAGE IS HANDLE OF WINDOW.
       77 Calibri12BI-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 STATUS-exercises PIC  X(2).
           88 Valid-STATUS-exercises VALUE IS "00" THRU "09". 
       77 STATUS-groups    PIC  X(2).
           88 Valid-STATUS-groups VALUE IS "00" THRU "09". 
       77 STATUS-intensity PIC  X(2).
           88 Valid-STATUS-intensity VALUE IS "00" THRU "09". 
       77 STATUS-macrogroups           PIC  X(2).
           88 Valid-STATUS-macrogroups VALUE IS "00" THRU "09". 
       77 STATUS-wodbook   PIC  X(2).
           88 Valid-STATUS-wodbook VALUE IS "00" THRU "09". 
       77 cb-mg1-buf       PIC  X(100).
       77 cb-mg2-buf       PIC  X(100).
       77 cb-mg3-buf       PIC  X(100).
       77 cb-mg4-buf       PIC  X(100).
       77 cb-mg5-buf       PIC  X(100).
       77 cb-mgtb-buf      PIC  X(100).
       77 cb-int-buf       PIC  X(100).
       77 old-cb-dur-buf   PIC  X(100).
       77 STATUS-duration  PIC  X(2).
           88 Valid-STATUS-duration VALUE IS "00" THRU "09". 
       77 cb-rnd-buf       PIC  X(100).
       77 cb-dur-buf       PIC  X(100).
       77 Default-Font
                  USAGE IS HANDLE OF FONT DEFAULT-FONT.
       78 78-col-day VALUE IS 1. 
       78 78-col-prg VALUE IS 2. 
       78 78-col-grp-code VALUE IS 3. 
       78 78-col-grp-desc VALUE IS 4. 
       78 78-col-exe-code VALUE IS 5. 
       78 78-col-exe-desc VALUE IS 6. 
       78 78-col-series VALUE IS 7. 
       78 78-col-reps VALUE IS 8. 
       78 78-col-ss VALUE IS 9. 
       77 ex-remain        PIC  99.
       77 effort-wod       PIC  99.
       77 path-tmp-exe-effort          PIC  X(256).
       77 STATUS-tmp-exe-effort        PIC  X(2).
           88 Valid-STATUS-tmp-exe-effort VALUE IS "00" THRU "09". 
       77 cb-gio-buf       PIC  x(5).
       77 cb-mul-buf       PIC  X(100).
       77 cb-wod-buf       PIC  x(100).
       77 STATUS-wodmap    PIC  X(2).
           88 Valid-STATUS-wodmap VALUE IS "00" THRU "09". 
       77 cb-mg6-buf       PIC  X(100).
       77 path-tmp-wod-exe PIC  X(256).
       77 STATUS-tmp-wod-exe           PIC  X(2).
           88 Valid-STATUS-tmp-wod-exe VALUE IS "00" THRU "09". 
       77 path-tmp-exe     PIC  X(256).
       77 STATUS-tmp-exe   PIC  X(2).
           88 Valid-STATUS-tmp-exe VALUE IS "00" THRU "09". 
       77 STATUS-intexe    PIC  X(2).
           88 Valid-STATUS-intexe VALUE IS "00" THRU "09". 
       77 cb-mg7-buf       PIC  X(100).
       77 Calibri10-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 genera-bmp       PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 random-bmp       PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 como-day         PIC  X(200).
       77 counter          PIC  9(3).
       77 schema-exe       PIC  999.
       77 path-tmp-exe-dupl            PIC  X(256).
       77 STATUS-tmp-exe-dupl          PIC  X(2).
           88 Valid-STATUS-tmp-exe-dupl VALUE IS "00" THRU "09". 
       77 Courier-New8-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 Calibri10B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 hid-tot-exe      PIC  99.
       01 hiddenData.
           05 hid-restpause    PIC  9.
           05 hid-mcg-code     PIC  x(5).
           05 hid-tex-key.
               10 hid-tex-day      PIC  9.
               10 hid-tex-split    PIC  9(3).
       77 Calibri14BU-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 path-zoom-exe-mcg            PIC  X(256).
       77 STATUS-zoom-exe-mcg          PIC  X(2).
           88 Valid-STATUS-zoom-exe-mcg VALUE IS "00" THRU "09". 
       77 Screen2-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 Verdana12-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 scr-stampa-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 78-ID-ef-st-tipo PIC  9(6)
                  VALUE IS 0.
       77 ef-ricerca-piva-buf          PIC  X(11).
       77 BOTTONE-OK-BMP   PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 BOTTONE-CANCEL-BMP           PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 scr-attesa-Handle
                  USAGE IS HANDLE OF WINDOW.
       77 Calibri24B-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 lab-attesa-buf   PIC  x(50).
       77 path-tmp-hit     PIC  X(256).
       77 STATUS-tmp-hit   PIC  X(2).
           88 Valid-STATUS-tmp-hit VALUE IS "00" THRU "09". 
       77 path-tmp-grp-exe PIC  X(256).
       77 STATUS-tmp-grp-exe           PIC  X(2).
           88 Valid-STATUS-tmp-grp-exe VALUE IS "00" THRU "09". 
       77 Calibri12BU-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 up-down-bmp      PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 piu-meno-bmp     PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 TECNICHE-BMP     PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 intens-BMP       PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 path-tmp-superset            PIC  X(256).
       77 STATUS-tmp-superset          PIC  X(2).
           88 Valid-STATUS-tmp-superset VALUE IS "00" THRU "09". 
       77 scr-date-Handle
                  USAGE IS HANDLE OF WINDOW.
       01 Screen2-Gd-1-Record.
           05 Gd-1-Col-1       PIC  X(08).
           05 Gd-1-Col-2       PIC  X(08).
           05 Gd-1-Col-3       PIC  X(08).
           05 Gd-1-Col-4       PIC  X(08).
           05 Gd-1-Col-5       PIC  X(08).
       77 Calibri16-Occidentale
                  USAGE IS HANDLE OF FONT.
       77 ef-gg1-buf       PIC  99/99/9999.
       77 ef-gg2-buf       PIC  99/99/9999.
       77 ef-gg4-buf       PIC  99/99/9999.
       77 ef-gg5-buf       PIC  99/99/9999.
       77 ef-gg3-buf       PIC  99/99/9999.
       77 ef-gg6-buf       PIC  99/99/9999.
       77 ef-gg7-buf       PIC  99/99/9999.
       77 e-gg1            PIC  9
                  VALUE IS 1.
       77 e-gg2            PIC  9
                  VALUE IS 1.
       77 e-gg3            PIC  9
                  VALUE IS 1.
       77 e-gg4            PIC  9
                  VALUE IS 1.
       77 e-gg5            PIC  9
                  VALUE IS 1.
       77 e-gg6            PIC  9
                  VALUE IS 1.
       77 e-gg7            PIC  9
                  VALUE IS 1.
       77 ef-desc-buf      PIC  X(100).
       77 lab-desc-buf     PIC  X(100).
       77 lab-code-buf     PIC  z(18).
       77 lab-ins-mod-buf  PIC  x(50).
       77 ripristino-bmp   PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 scr-filtro-handle
                  USAGE IS HANDLE OF WINDOW.
       77 tipo-filtro      PIC  99
                  VALUE IS 1.
       77 e-des            PIC  9
                  VALUE IS 1.
       77 e-dta            PIC  9
                  VALUE IS 1.
       77 e-dtc            PIC  9
                  VALUE IS 1.
       77 e-map            PIC  9
                  VALUE IS 1.
       01 FILLER           PIC  9.
           88 record-ok VALUE IS 1    WHEN SET TO FALSE  0. 
       77 e-exe            PIC  9
                  VALUE IS 1.
       77 e-mul            PIC  9
                  VALUE IS 1.
       77 e-rep            PIC  9
                  VALUE IS 1.
       77 e-gss            PIC  9
                  VALUE IS 1.
       77 ef-gss-buf       PIC  X(5).
       77 ef-rep-buf       PIC  X(5).
       77 ef-mul-buf       PIC  X(5).
       77 ef-exe-buf       PIC  X(5).
       77 ef-map-buf       PIC  zzz.
       77 ef-dtc-from-buf  PIC  99/99/9999.
       77 ef-dtc-to-buf    PIC  99/99/9999.
       77 ef-dta-from-buf  PIC  99/99/9999.
       77 ef-dta-to-buf    PIC  99/99/9999.
       77 ef-des-buf       PIC  X(100).
       77 lab-gss-buf      PIC  x(50).
       77 lab-rep-buf      PIC  x(50).
       77 lab-mul-buf      PIC  X(50).
       77 lab-exe-buf      PIC  X(50).
       77 lab-map-buf      PIC  X(50).
       77 e-mcg            PIC  9
                  VALUE IS 1.
       77 ef-mcg-buf       PIC  X(5).
       77 lab-mcg-buf      PIC  x(50)
                  VALUE IS "Vuoto =Tutti".
       77 cb-eff-buf       PIC  X(100).
       77 path-zoom-wodbook            PIC  X(256).
       77 STATUS-zoom-wodbook          PIC  X(2).
           88 Valid-STATUS-zoom-wodbook VALUE IS "00" THRU "09". 
       77 STATUS-rwodbook  PIC  X(2).
           88 Valid-STATUS-rwodbook VALUE IS "00" THRU "09". 
       77 STATUS-twodbook  PIC  X(2).
           88 Valid-STATUS-twodbook VALUE IS "00" THRU "09". 
       77 e-eff            PIC  9
                  VALUE IS 1.
       77 e-dur            PIC  9
                  VALUE IS 1.
       77 ef-dur-buf       PIC  zz.
       77 lab-dur-buf      PIC  x(50)
                  VALUE IS "Vuoto =Tutti".
       77 mod-BMP          PIC  S9(9)
                  USAGE IS COMP-4
                  VALUE IS 0.
       77 v-form1          PIC  9
                  VALUE IS 0.

      ***********************************************************
      *   Code Gen's Buffer                                     *
      ***********************************************************
       77 STATUS-Form1-FLAG-REFRESH PIC  9.
          88 Form1-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-Form1-KEY1-ORDER  PIC X VALUE "A".
       77 TMP-Form1-twodbook-RESTOREBUF  PIC X(2305).
       77 TMP-Form1-KEYIS  PIC 9(3) VALUE 1.
       77 Form1-MULKEY-TMPBUF   PIC X(2305).
       77 STATUS-scr-attesa-FLAG-REFRESH PIC  9.
          88 scr-attesa-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-scr-date-FLAG-REFRESH PIC  9.
          88 scr-date-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 STATUS-scr-filtro-FLAG-REFRESH PIC  9.
          88 scr-filtro-FLAG-REFRESH  VALUE 1 FALSE 0. 
       77 TMP-DataSet1-exercises-BUF     PIC X(1189).
       77 TMP-DataSet1-groups-BUF     PIC X(1182).
       77 TMP-DataSet1-macrogroups-BUF     PIC X(1177).
       77 TMP-DataSet1-duration-BUF     PIC X(1163).
       77 TMP-DataSet1-tmp-exe-effort-BUF     PIC X(112).
       77 TMP-DataSet1-wodmap-BUF     PIC X(18384).
       77 TMP-DataSet1-tmp-wod-exe-BUF     PIC X(116).
       77 TMP-DataSet1-tmp-exe-BUF     PIC X(529).
       77 TMP-DataSet1-intexe-BUF     PIC X(1188).
       77 TMP-DataSet1-tmp-exe-dupl-BUF     PIC X(190).
       77 TMP-DataSet1-zoom-exe-mcg-BUF     PIC X(312).
       77 TMP-DataSet1-tmp-hit-BUF     PIC X(6).
       77 TMP-DataSet1-tmp-grp-exe-BUF     PIC X(207).
       77 TMP-DataSet1-tmp-superset-BUF     PIC X(44).
       77 TMP-DataSet1-zoom-wodbook-BUF     PIC X(440).
       77 TMP-DataSet1-rwodbook-BUF     PIC X(2346).
       77 TMP-DataSet1-twodbook-BUF     PIC X(2305).
      * VARIABLES FOR RECORD LENGTH.
       77  TotemFdSlRecordClearOffset   PIC 9(5) COMP-4.
       77  TotemFdSlRecordLength        PIC 9(5) COMP-4.
      * FILE'S LOCK MODE FLAG
       77 DataSet1-exercises-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-exercises-LOCK  VALUE "Y".
       77 DataSet1-exercises-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-exercises-KEY-Asc  VALUE "A".
          88 DataSet1-exercises-KEY-Desc VALUE "D".
       77 DataSet1-groups-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-groups-LOCK  VALUE "Y".
       77 DataSet1-groups-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-groups-KEY-Asc  VALUE "A".
          88 DataSet1-groups-KEY-Desc VALUE "D".
       77 DataSet1-macrogroups-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-macrogroups-LOCK  VALUE "Y".
       77 DataSet1-macrogroups-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-macrogroups-KEY-Asc  VALUE "A".
          88 DataSet1-macrogroups-KEY-Desc VALUE "D".
       77 DataSet1-duration-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-duration-LOCK  VALUE "Y".
       77 DataSet1-duration-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-duration-KEY-Asc  VALUE "A".
          88 DataSet1-duration-KEY-Desc VALUE "D".
       77 DataSet1-tmp-exe-effort-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-exe-effort-LOCK  VALUE "Y".
       77 DataSet1-tmp-exe-effort-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-exe-effort-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-exe-effort-KEY-Desc VALUE "D".
       77 DataSet1-wodmap-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-wodmap-LOCK  VALUE "Y".
       77 DataSet1-wodmap-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-wodmap-KEY-Asc  VALUE "A".
          88 DataSet1-wodmap-KEY-Desc VALUE "D".
       77 DataSet1-tmp-wod-exe-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-wod-exe-LOCK  VALUE "Y".
       77 DataSet1-tmp-wod-exe-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-wod-exe-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-wod-exe-KEY-Desc VALUE "D".
       77 DataSet1-tmp-exe-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-exe-LOCK  VALUE "Y".
       77 DataSet1-tmp-exe-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-exe-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-exe-KEY-Desc VALUE "D".
       77 DataSet1-intexe-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-intexe-LOCK  VALUE "Y".
       77 DataSet1-intexe-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-intexe-KEY-Asc  VALUE "A".
          88 DataSet1-intexe-KEY-Desc VALUE "D".
       77 DataSet1-tmp-exe-dupl-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-exe-dupl-LOCK  VALUE "Y".
       77 DataSet1-tmp-exe-dupl-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-exe-dupl-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-exe-dupl-KEY-Desc VALUE "D".
       77 DataSet1-zoom-exe-mcg-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-zoom-exe-mcg-LOCK  VALUE "Y".
       77 DataSet1-zoom-exe-mcg-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-zoom-exe-mcg-KEY-Asc  VALUE "A".
          88 DataSet1-zoom-exe-mcg-KEY-Desc VALUE "D".
       77 DataSet1-tmp-hit-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-hit-LOCK  VALUE "Y".
       77 DataSet1-tmp-hit-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-hit-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-hit-KEY-Desc VALUE "D".
       77 DataSet1-tmp-grp-exe-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-grp-exe-LOCK  VALUE "Y".
       77 DataSet1-tmp-grp-exe-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-grp-exe-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-grp-exe-KEY-Desc VALUE "D".
       77 DataSet1-tmp-superset-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-tmp-superset-LOCK  VALUE "Y".
       77 DataSet1-tmp-superset-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-tmp-superset-KEY-Asc  VALUE "A".
          88 DataSet1-tmp-superset-KEY-Desc VALUE "D".
       77 DataSet1-zoom-wodbook-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-zoom-wodbook-LOCK  VALUE "Y".
       77 DataSet1-zoom-wodbook-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-zoom-wodbook-KEY-Asc  VALUE "A".
          88 DataSet1-zoom-wodbook-KEY-Desc VALUE "D".
       77 DataSet1-rwodbook-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-rwodbook-LOCK  VALUE "Y".
       77 DataSet1-rwodbook-KEY-ORDER  PIC X VALUE "A".
          88 DataSet1-rwodbook-KEY-Asc  VALUE "A".
          88 DataSet1-rwodbook-KEY-Desc VALUE "D".
       77 DataSet1-twodbook-LOCK-FLAG   PIC X VALUE SPACE.
           88 DataSet1-twodbook-LOCK  VALUE "Y".
       77 DataSet1-KEYIS   PIC 9(3) VALUE 1.
       77 DataSet1-twodbook-KEY1-ORDER  PIC X VALUE "A".
          88 DataSet1-twodbook-KEY1-Asc  VALUE "A".
          88 DataSet1-twodbook-KEY1-Desc VALUE "D".

       77 exercises-exe-k-desc-SPLITBUF  PIC X(101).
       77 exercises-exe-k-group-SPLITBUF  PIC X(11).
       77 groups-grp-k-desc-SPLITBUF  PIC X(101).
       77 groups-grp-k-mcg-SPLITBUF  PIC X(11).
       77 macrogroups-mcg-k-desc-SPLITBUF  PIC X(101).
       77 duration-dur-k-desc-SPLITBUF  PIC X(101).
       77 duration-dur-k-exercises-SPLITBUF  PIC X(3).
       77 wodmap-wom-k-desc-SPLITBUF  PIC X(101).
       77 tmp-exe-tex-k-dupl-SPLITBUF  PIC X(102).
       77 tmp-exe-tex-k-mcg-SPLITBUF  PIC X(10).
       77 tmp-exe-tex-k-day-exe-SPLITBUF  PIC X(102).
       77 tmp-exe-tex-k-exe-SPLITBUF  PIC X(101).
       77 intexe-int-k-desc-SPLITBUF  PIC X(101).
       77 intexe-int-k-effort-SPLITBUF  PIC X(3).
       77 tmp-exe-dupl-ted-k-num-SPLITBUF  PIC X(111).
       77 zoom-exe-mcg-zem-k-int-SPLITBUF  PIC X(203).
       77 tmp-grp-exe-tge-k-prg-SPLITBUF  PIC X(4).
       77 zoom-wodbook-key01-SPLITBUF  PIC X(119).
       77 zoom-wodbook-key02-SPLITBUF  PIC X(109).
       77 zoom-wodbook-key03-SPLITBUF  PIC X(109).
       77 rwodbook-rod-k-day-SPLITBUF  PIC X(29).
       77 rwodbook-rod-k-prg-SPLITBUF  PIC X(30).
       77 rwodbook-rod-k-mcg-SPLITBUF  PIC X(34).
       77 rwodbook-rod-k-exe-SPLITBUF  PIC X(34).
       77 rwodbook-rod-k-multi-SPLITBUF  PIC X(35).
       77 rwodbook-rod-k-rp-SPLITBUF  PIC X(35).
       77 rwodbook-rod-k-ss-SPLITBUF  PIC X(35).
       77 rwodbook-rod-k-confronto-SPLITBUF  PIC X(16).
       77 twodbook-tod-k-creazione-SPLITBUF  PIC X(27).
       77 twodbook-tod-k-wom-SPLITBUF  PIC X(22).
       77 twodbook-tod-k-desc-SPLITBUF  PIC X(119).
       77 twodbook-tod-k-ini-SPLITBUF  PIC X(27).
       77 twodbook-tod-k-eff-SPLITBUF  PIC X(21).
       77 twodbook-tod-k-dur-SPLITBUF  PIC X(21).

       01                 pic 9.
           88 s-excell    value 1.
           88 s-stampa    value 2.
           88 s-anteprima value 3.

       77  s-cb-mg1-buf   pic x(100).
       77  s-cb-mg2-buf   pic x(100).
       77  s-cb-mg3-buf   pic x(100).
       77  s-cb-mg4-buf   pic x(100).
       77  s-cb-mg5-buf   pic x(100).
       77  s-cb-mg6-buf   pic x(100).
       77  s-cb-mg7-buf   pic x(100).
       77  s-cb-mul-buf   pic x(100).
       77  s-cb-int-buf   pic x(100).
       77  s-cb-dur-buf   pic x(100).
       77  s-cb-gio-buf   pic x(100).
       77  s-cb-wod-buf   pic x(100). 

       77  s-tex-exe-code     pic x(5).  
       77  s-tex-exe-desc     pic x(100).   
       77  s-tex-exe-isMulti  pic 9.

       01 como-tex-rec.
           05 como-tex-key.
               10 como-tex-day          PIC  9.
               10 como-tex-split        PIC  9(3).
           05 como-tex-data.
               10 como-tex-exe-desc-univoca         PIC  x(100).
               10 como-tex-mcg-code     PIC  x(5).
               10 como-tex-exe-code     PIC  x(5).
               10 como-tex-exe-desc     PIC  x(100).
               10 como-tex-nome-dupl    PIC  x(100).
               10 como-tex-int-code     PIC  99.
               10 como-tex-exe-isMulti  PIC  9.
               10 como-tex-reps         PIC  x(10).
               10 como-tex-series       PIC  99.
               10 como-tex-int-restpause            PIC  9.
               10 como-tex-ss           PIC  9.
      *{TOTEM}END

      *{TOTEM}ID-LOGICI
      ***** Elenco ID Logici *****
       78  78-ID-cb-mg1 VALUE 5001.
       78  78-ID-cb-mg2 VALUE 5002.
       78  78-ID-cb-mg3 VALUE 5003.
       78  78-ID-cb-mg4 VALUE 5004.
       78  78-ID-cb-mg5 VALUE 5005.
       78  78-ID-cb-mg6 VALUE 5006.
       78  78-ID-cb-mg7 VALUE 5007.
       78  78-ID-gd1 VALUE 5008.
       78  78-ID-ef-gg1 VALUE 5001.
       78  78-ID-ef-gg2 VALUE 5002.
       78  78-ID-ef-gg3 VALUE 5003.
       78  78-ID-ef-gg4 VALUE 5004.
       78  78-ID-ef-gg5 VALUE 5005.
       78  78-ID-ef-gg6 VALUE 5006.
       78  78-ID-ef-gg7 VALUE 5007.
       78  78-ID-rb-tut VALUE 5001.
       78  78-ID-rb-des VALUE 5002.
       78  78-ID-ef-des VALUE 5003.
       78  78-ID-rb-dta VALUE 5004.
       78  78-ID-ef-dta-from VALUE 5005.
       78  78-ID-ef-dta-to VALUE 5006.
       78  78-ID-rb-dtc VALUE 5007.
       78  78-ID-ef-dtc-from VALUE 5008.
       78  78-ID-ef-dtc-to VALUE 5009.
       78  78-ID-rb-map VALUE 5010.
       78  78-ID-ef-map VALUE 5011.
       78  78-ID-rb-eff VALUE 5012.
       78  78-ID-cb-eff VALUE 5013.
       78  78-ID-rb-exe VALUE 5014.
       78  78-ID-ef-exe VALUE 5015.
       78  78-ID-rb-mul VALUE 5016.
       78  78-ID-ef-mul VALUE 5017.
       78  78-ID-rb-rep VALUE 5018.
       78  78-ID-ef-rep VALUE 5019.
       78  78-ID-rb-gss VALUE 5020.
       78  78-ID-ef-gss VALUE 5021.
       78  78-ID-rb-mcg VALUE 5022.
       78  78-ID-ef-mcg VALUE 5023.
       78  78-ID-rb-dur VALUE 5024.
       78  78-ID-ef-dur VALUE 5025.
      ***** Fine ID Logici *****
      *{TOTEM}END

       LINKAGE          SECTION.
      *{TOTEM}LINKAGE
           COPY  "F:\STUDIOPOSTURA\COPYLIB\BLOCKPGM.LKS".
       01 lnk-code         PIC  9(18).

      *{TOTEM}END

       SCREEN           SECTION.
      *{TOTEM}COPY-SCREEN
      * FORM
       01 
           Form1, 
           .

      * COMBO-BOX
       05
           cb-mg1, 
           Combo-Box, 
           COL 17,80, 
           LINE 1,70,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg1-buf,
           AFTER PROCEDURE cb-mg1-AfterProcedure, 
           BEFORE PROCEDURE cb-mg1-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg1, 
           Push-Button, 
           COL 62,00, 
           LINE 1,70,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1005,
           ID IS 14,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg1-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg1-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mg2, 
           Combo-Box, 
           COL 17,80, 
           LINE 3,17,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg2-buf,
           AFTER PROCEDURE cb-mg2-AfterProcedure, 
           BEFORE PROCEDURE cb-mg2-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg2, 
           Push-Button, 
           COL 62,00, 
           LINE 3,17,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1006,
           ID IS 15,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg2-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg2-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mg3, 
           Combo-Box, 
           COL 17,80, 
           LINE 4,70,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg3-buf,
           AFTER PROCEDURE cb-mg3-AfterProcedure, 
           BEFORE PROCEDURE cb-mg3-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg3, 
           Push-Button, 
           COL 62,00, 
           LINE 4,70,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1011,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg3-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg3-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mg4, 
           Combo-Box, 
           COL 17,80, 
           LINE 6,17,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg4-buf,
           AFTER PROCEDURE cb-mg4-AfterProcedure, 
           BEFORE PROCEDURE cb-mg4-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg4, 
           Push-Button, 
           COL 62,00, 
           LINE 6,17,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1010,
           ID IS 21,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg4-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg4-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mg5, 
           Combo-Box, 
           COL 17,80, 
           LINE 7,70,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg5,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg5-buf,
           AFTER PROCEDURE cb-mg5-AfterProcedure, 
           BEFORE PROCEDURE cb-mg5-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg5, 
           Push-Button, 
           COL 62,00, 
           LINE 7,70,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1009,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg5-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg5-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mg6, 
           Combo-Box, 
           COL 17,80, 
           LINE 9,17,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg6,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg6-buf,
           AFTER PROCEDURE cb-mg6-AfterProcedure, 
           BEFORE PROCEDURE cb-mg6-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg6, 
           Push-Button, 
           COL 62,00, 
           LINE 9,17,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1008,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg6-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg6-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mg7, 
           Combo-Box, 
           COL 17,80, 
           LINE 10,70,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 78-ID-cb-mg7,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mg7-buf,
           AFTER PROCEDURE cb-mg7-AfterProcedure, 
           BEFORE PROCEDURE cb-mg7-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-mcg7, 
           Push-Button, 
           COL 62,00, 
           LINE 10,70,
           LINES 1,30 ,
           SIZE 7,00 ,
           ENABLED 0,
           EXCEPTION-VALUE 1007,
           ID IS 40,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Mai",
           AFTER PROCEDURE pb-mcg7-AfterProcedure, 
           BEFORE PROCEDURE pb-mcg7-BeforeProcedure, 
           .

      * COMBO-BOX
       05
           cb-mul, 
           Combo-Box, 
           COL 17,80, 
           LINE 15,09,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cb-mul-buf,
           AFTER PROCEDURE cb-rnd-AfterProcedure, 
           BEFORE PROCEDURE cb-rnd-BeforeProcedure, 
           .
      * COMBO-BOX
       05
           cb-int, 
           Combo-Box, 
           COL 17,80, 
           LINE 17,09,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 17,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cb-int-buf,
           AFTER PROCEDURE cb-int-AfterProcedure, 
           BEFORE PROCEDURE cb-int-BeforeProcedure, 
           .
      * COMBO-BOX
       05
           cb-dur, 
           Combo-Box, 
           COL 17,80, 
           LINE 18,57,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cb-dur-buf,
           AFTER PROCEDURE cb-dur-AfterProcedure, 
           BEFORE PROCEDURE cb-dur-BeforeProcedure, 
           .
      * COMBO-BOX
       05
           cb-gio, 
           Combo-Box, 
           COL 17,80, 
           LINE 20,09,
           LINES 10,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 24,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cb-gio-buf,
           AFTER PROCEDURE cb-gio-AfterProcedure, 
           BEFORE PROCEDURE cb-gio-BeforeProcedure, 
           .
      * COMBO-BOX
       05
           cb-wod, 
           Combo-Box, 
           COL 17,80, 
           LINE 21,57,
           LINES 16,00 ,
           SIZE 43,00 ,
           BOXED,
           COLOR IS 513,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           NOTIFY-SELCHANGE,
           DROP-LIST,
           UNSORTED,
           VALUE cb-wod-buf,
           AFTER PROCEDURE cb-wod-AfterProcedure, 
           BEFORE PROCEDURE cb-wod-BeforeProcedure, 
           EXCEPTION PROCEDURE cb-wod-Exception-Proc, 
           .
      * PUSH BUTTON
       05
           pb-genera, 
           Push-Button, 
           COL 17,80, 
           LINE 23,35,
           LINES 55 PIXELS,
           SIZE 148 PIXELS,
           BITMAP-HANDLE genera-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 1000,
           FONT IS Small-Font,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "&GENERA",
           .

      * PUSH BUTTON
       05
           pb-random, 
           Push-Button, 
           COL 17,80, 
           LINE 12,35,
           LINES 55 PIXELS,
           SIZE 148 PIXELS,
           BITMAP-HANDLE random-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 1002,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "&Random",
           .

      * GRID
       05
           gd1, 
           Grid, 
           COL 71,50, 
           LINE 1,70,
           LINES 34,87 ,
           SIZE 82,00 ,
           BOXED,
           DATA-COLUMNS (1, 2, 4, 9, 109, 114, 214, 216, 236),
           ALIGNMENT ("C", "R", "U", "L", "U", "L", "U", "U", "C"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("91)", "z9", "X(5)", "X(100)", "X(5)", "X(100)", 
           "9(2)", "x(20)", "9(1)"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 2,
           DIVIDER-COLOR 1,
           FONT IS Calibri12-Occidentale,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 78-ID-gd1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 98,
           VPADDING 5,
           VSCROLL,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * LABEL
       05
           Screen1-blockpgm-1, 
           Label, 
           COL 83,70, 
           LINE 1,00,
           LINES 0,61 ,
           SIZE 1,50 ,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "BlockPgm",
           VISIBLE v-custom,
           .

      * LABEL
       05
           Screen1-Custom1-1, 
           Label, 
           COL 90,70, 
           LINE 1,13,
           LINES 0,52 ,
           SIZE 0,80 ,
           ID IS 12,
           TRANSPARENT,
           TITLE "CUSTOM CONTROL",
           VISIBLE v-custom,
           .

      * LABEL
       05
           lab-a, 
           Label, 
           COL 3,00, 
           LINE 1,70,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo A",
           .

      * LABEL
       05
           lab-b, 
           Label, 
           COL 3,00, 
           LINE 3,17,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo B",
           .

      * LABEL
       05
           lab-c, 
           Label, 
           COL 3,00, 
           LINE 4,70,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo C",
           .

      * LABEL
       05
           lab-d, 
           Label, 
           COL 3,00, 
           LINE 6,17,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo D",
           .

      * LABEL
       05
           lab-e, 
           Label, 
           COL 3,00, 
           LINE 7,70,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 6,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo E",
           .

      * LABEL
       05
           Screen1-La-2a, 
           Label, 
           COL 3,00, 
           LINE 17,09,
           LINES 1,30 ,
           SIZE 13,00 ,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Intensità",
           .

      * LABEL
       05
           Screen1-La-2aa, 
           Label, 
           COL 3,00, 
           LINE 18,57,
           LINES 1,30 ,
           SIZE 13,00 ,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Durata",
           .

      * LABEL
       05
           Screen1-La-2aaa, 
           Label, 
           COL 3,00, 
           LINE 20,09,
           LINES 1,30 ,
           SIZE 13,00 ,
           ID IS 23,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorni",
           .

      * LABEL
       05
           Screen1-La-2ba, 
           Label, 
           COL 3,00, 
           LINE 15,09,
           LINES 1,30 ,
           SIZE 13,00 ,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Multiarticolari",
           .

      * LABEL
       05
           Screen1-La-2aaaa, 
           Label, 
           COL 3,00, 
           LINE 21,57,
           LINES 1,30 ,
           SIZE 13,00 ,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Modello",
           .

      * LABEL
       05
           lab-f, 
           Label, 
           COL 3,00, 
           LINE 9,17,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 27,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo F",
           .

      * LABEL
       05
           lab-g, 
           Label, 
           COL 3,00, 
           LINE 10,70,
           LINES 1,30 ,
           SIZE 14,00 ,
           FONT IS Calibri14-Occidentale,
           ID IS 29,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Macrogruppo G",
           .

      * GRID
       05
           gd-schema, 
           Grid, 
           COL 2,30, 
           LINE 26,13,
           LINES 10,52 ,
           SIZE 66,70 ,
           ADJUSTABLE-COLUMNS,
           BOXED,
           DATA-COLUMNS (1, 3, 8, 13, 18, 23, 28, 33, 38, 43, 48, 53),
           ALIGNMENT ("R", "L", "L", "L", "L", "L", "L", "L", "L", "L", 
           "L", "U"),
           SEPARATION (5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5),
           DATA-TYPES ("z9", "x(5)", "X(5)", "X(100)", "X(5)", "X(100)"
           , "z9", "z9", "X", "X", "X", "X"),
           NUM-COL-HEADINGS 1,
           COLUMN-HEADINGS,
           CURSOR-FRAME-WIDTH 0,
           DIVIDER-COLOR 1,
           FONT IS Calibri10B-Occidentale,
           HEADING-COLOR 257,
           HEADING-DIVIDER-COLOR 1,
           ID IS 37,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TILED-HEADINGS,
           VIRTUAL-WIDTH 90,
           VPADDING 5,
           EVENT PROCEDURE Screen1-Gd-1-Event-Proc,
           .

      * PUSH BUTTON
       05
           pb-aggiungi, 
           Push-Button, 
           COL 154,20, 
           LINE 1,70,
           LINES 1,17 ,
           SIZE 28 PIXELS,
           BITMAP-HANDLE PIU-MENO-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1012,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "+",
           .

      * PUSH BUTTON
       05
           pb-elimina, 
           Push-Button, 
           COL 154,20, 
           LINE 2,96,
           LINES 1,17 ,
           SIZE 28 PIXELS,
           BITMAP-HANDLE PIU-MENO-BMP,
           BITMAP-NUMBER 2,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1004,
           ID IS 36,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "-",
           .

      * PUSH BUTTON
       05
           pb-su, 
           Push-Button, 
           COL 154,20, 
           LINE 4,26,
           LINES 1,17 ,
           SIZE 28 PIXELS,
           BITMAP-HANDLE UP-DOWN-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1001,
           ID IS 38,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "SU",
           .

      * PUSH BUTTON
       05
           pb-giu, 
           Push-Button, 
           COL 154,20, 
           LINE 5,52,
           LINES 1,17 ,
           SIZE 28 PIXELS,
           BITMAP-HANDLE UP-DOWN-BMP,
           BITMAP-NUMBER 2,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1003,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "GIU",
           .

      * PUSH BUTTON
       05
           pb-int, 
           Push-Button, 
           COL 154,20, 
           LINE 6,78,
           LINES 1,17 ,
           SIZE 28 PIXELS,
           BITMAP-HANDLE intens-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 1013,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Modifica serie/reps",
           .

      * PUSH BUTTON
       05
           pb-mod, 
           Push-Button, 
           COL 154,20, 
           LINE 8,04,
           LINES 1,17 ,
           SIZE 28 PIXELS,
           BITMAP-HANDLE mod-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED 0,
           EXCEPTION-VALUE 1015,
           ID IS 47,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Modifica serie/reps",
           .

      * BAR
       05
           Screen1-Br-1, 
           Bar,
           COL 70,20, 
           LINE 1,00,
           LINES 37,04 ,
           ID IS 43,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           WIDTH 1,
           .

      * LABEL
       05
           lab-desc, 
           Label, 
           COL 7,30, 
           LINE 36,70,
           LINES 1,00 ,
           SIZE 61,70 ,
           COLOR IS 5,
           ID IS 44,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-desc-buf,
           .

      * LABEL
       05
           lab-code, 
           Label, 
           COL 2,30, 
           LINE 36,70,
           LINES 1,00 ,
           SIZE 4,00 ,
           COLOR IS 5,
           ID IS 45,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           TRANSPARENT,
           TITLE lab-code-buf,
           .

      * PUSH BUTTON
       05
           pb-ripristino, 
           Push-Button, 
           COL 31,20, 
           LINE 12,35,
           LINES 55 PIXELS,
           SIZE 148 PIXELS,
           BITMAP-HANDLE RIPRISTINO-BMP,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED 1,
           EXCEPTION-VALUE 1014,
           FONT IS Small-Font,
           ID IS 46,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Ri&pristino",
           .

      * TOOLBAR
       01
           Form1-Tb-1,
           .    

      * PUSH BUTTON
       05
           TOOL-ESCI, 
           Push-Button, 
           COL 1,00, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 1,
           FRAMED,
           SQUARE,
           ENABLED E-ESCI,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 72,
           SELF-ACT,
           ESCAPE-BUTTON,
           TITLE "Esci (Esc)",
           .

      * PUSH BUTTON
       05
           TOOL-NUOVO, 
           Push-Button, 
           COL 6,20, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-NUOVO,
           EXCEPTION-VALUE 2,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 73,
           SELF-ACT,
           TITLE "Nuovo (F2)",
           BITMAP-NUMBER BitmapNumNew
           .

      * PUSH BUTTON
       05
           TOOL-SALVA, 
           Push-Button, 
           COL 11,40, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-SALVA,
           EXCEPTION-VALUE 3,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 75,
           SELF-ACT,
           TITLE "Salva (F3)",
           BITMAP-NUMBER BitmapNumSave
           .

      * PUSH BUTTON
       05
           TOOL-ANTEPRIMA, 
           Push-Button, 
           COL 27,00, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 6,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 6,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 76,
           SELF-ACT,
           TITLE "Anteprima (F6)",
           .

      * PUSH BUTTON
       05
           TOOL-STAMPA, 
           Push-Button, 
           COL 32,20, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 7,
           FRAMED,
           SQUARE,
           EXCEPTION-VALUE 7,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 110,
           SELF-ACT,
           TITLE "Stampa (F7)",
           .

      * PUSH BUTTON
       05
           TOOL-CERCA, 
           Push-Button, 
           COL 21,80, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CERCA,
           EXCEPTION-VALUE 8,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 111,
           SELF-ACT,
           TITLE "Cerca (F8)",
           BITMAP-NUMBER BitmapNumZoom
           .

      * PUSH BUTTON
       05
           tool-modifica, 
           Push-Button, 
           COL 49,80, 
           LINE 1,04,
           LINES 1,35 ,
           SIZE 3,10 ,
           FONT IS Calibri12B-Occidentale,
           ID IS 112,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Push Button",
           VISIBLE 0,
           .

      * PUSH BUTTON
       05
           tool-cancellad, 
           Push-Button, 
           COL 52,90, 
           LINE 1,13,
           LINES 1,35 ,
           SIZE 3,10 ,
           FONT IS Small-Font,
           ID IS 113,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Push Button",
           VISIBLE 0,
           .

      * PUSH BUTTON
       05
           tool-seleziona, 
           Push-Button, 
           COL 56,00, 
           LINE 1,09,
           LINES 1,35 ,
           SIZE 3,10 ,
           FONT IS Calibri14BU-Occidentale,
           ID IS 114,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Push Button",
           VISIBLE 0,
           .

      * PUSH BUTTON
       05
           TOOL-SELEZIONAa, 
           Push-Button, 
           COL 37,50, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           BITMAP-NUMBER 9,
           FRAMED,
           SQUARE,
           ENABLED E-SELEZIONA,
           EXCEPTION-VALUE 9,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 115,
           SELF-ACT,
           TITLE "Seleziona (F9)",
           .

      * PUSH BUTTON
       05
           TOOL-CANCELLA, 
           Push-Button, 
           COL 16,60, 
           LINE 1,09,
           LINES 64,00 ,
           SIZE 48,00 ,
           BITMAP-HANDLE toolbar-bmp,
           FRAMED,
           SQUARE,
           ENABLED E-CANCELLA,
           EXCEPTION-VALUE 4,
           FLAT,
           FONT IS Calibri14-Occidentale,
           ID IS 74,
           SELF-ACT,
           TITLE "Cancella (F4)",
           BITMAP-NUMBER BitmapNumDelete
           .

      * FORM
       01 
           scr-attesa, 
           .

      * LABEL
       05
           scr-attesa-La-1, 
           Label, 
           COL 4,00, 
           LINE 1,46,
           LINES 1,85 ,
           SIZE 38,18 ,
           FONT IS Calibri24B-Occidentale,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE "Sto generando l'allenamento...",
           .

      * LABEL
       05
           lab-attesa, 
           Label, 
           COL 4,00, 
           LINE 3,50,
           LINES 1,08 ,
           SIZE 38,18 ,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE lab-attesa-buf,
           .

      * FORM
       01 
           scr-date, 
           .

      * FRAME
       05
           Screen2-Fr-1, 
           Frame, 
           COL 14,45, 
           LINE 2,69,
           LINES 12,96 ,
           SIZE 25,82 ,
           ENGRAVED,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Indicare le date di allenamento",
           TITLE-POSITION 2,
           .

      * LABEL
       05
           Screen2-La-1, 
           Label, 
           COL 17,09, 
           LINE 4,23,
           LINES 1,23 ,
           SIZE 7,82 ,
           ID IS 4,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 1",
           .

      * LABEL
       05
           Screen2-La-1a, 
           Label, 
           COL 17,09, 
           LINE 5,77,
           LINES 1,23 ,
           SIZE 7,82 ,
           ID IS 5,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 2",
           .

      * LABEL
       05
           Screen2-La-1b, 
           Label, 
           COL 17,09, 
           LINE 7,31,
           LINES 1,00 ,
           SIZE 7,82 ,
           ID IS 6,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 3",
           .

      * LABEL
       05
           Screen2-La-1c, 
           Label, 
           COL 17,09, 
           LINE 8,84,
           LINES 1,23 ,
           SIZE 7,82 ,
           ID IS 7,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 4",
           .

      * LABEL
       05
           Screen2-La-1d, 
           Label, 
           COL 17,09, 
           LINE 10,38,
           LINES 1,23 ,
           SIZE 7,82 ,
           ID IS 8,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 5",
           .

      * LABEL
       05
           Screen2-La-1e, 
           Label, 
           COL 17,09, 
           LINE 11,92,
           LINES 1,23 ,
           SIZE 7,82 ,
           ID IS 9,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 6",
           .

      * LABEL
       05
           Screen2-La-1f, 
           Label, 
           COL 17,09, 
           LINE 13,46,
           LINES 1,00 ,
           SIZE 7,82 ,
           ID IS 10,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Giorno 7",
           .

      * ENTRY FIELD
       05
           ef-gg1, 
           Entry-Field, 
           COL 27,63, 
           LINE 4,23,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg1,
           ID IS 78-ID-ef-gg1,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg1-buf,
           AFTER PROCEDURE ef-gg1-AfterProcedure, 
           BEFORE PROCEDURE ef-gg1-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg2, 
           Entry-Field, 
           COL 27,63, 
           LINE 5,77,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg2,
           ID IS 78-ID-ef-gg2,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg2-buf,
           AFTER PROCEDURE ef-gg2-AfterProcedure, 
           BEFORE PROCEDURE ef-gg2-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg3, 
           Entry-Field, 
           COL 27,63, 
           LINE 7,31,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg3,
           ID IS 78-ID-ef-gg3,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg3-buf,
           AFTER PROCEDURE ef-gg3-AfterProcedure, 
           BEFORE PROCEDURE ef-gg3-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg4, 
           Entry-Field, 
           COL 27,63, 
           LINE 8,84,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg4,
           ID IS 78-ID-ef-gg4,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg4-buf,
           AFTER PROCEDURE ef-gg4-AfterProcedure, 
           BEFORE PROCEDURE ef-gg4-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg5, 
           Entry-Field, 
           COL 27,63, 
           LINE 10,38,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg5,
           ID IS 78-ID-ef-gg5,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg5-buf,
           AFTER PROCEDURE ef-gg5-AfterProcedure, 
           BEFORE PROCEDURE ef-gg5-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg6, 
           Entry-Field, 
           COL 27,63, 
           LINE 11,92,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg6,
           ID IS 78-ID-ef-gg6,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg6-buf,
           AFTER PROCEDURE ef-gg6-AfterProcedure, 
           BEFORE PROCEDURE ef-gg6-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-gg7, 
           Entry-Field, 
           COL 27,63, 
           LINE 13,46,
           LINES 1,23 ,
           SIZE 10,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gg7,
           ID IS 78-ID-ef-gg7,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gg7-buf,
           AFTER PROCEDURE ef-gg7-AfterProcedure, 
           BEFORE PROCEDURE ef-gg7-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-desc, 
           Entry-Field, 
           COL 11,45, 
           LINE 16,27,
           LINES 1,15 ,
           SIZE 41,64 ,
           BOXED,
           COLOR IS 513,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-desc-buf,
           AFTER PROCEDURE ef-desc-AfterProcedure, 
           BEFORE PROCEDURE ef-desc-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-ok, 
           Push-Button, 
           COL 20,09, 
           LINE 17,85,
           LINES 1,42 ,
           SIZE 81 PIXELS,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           EXCEPTION-VALUE 333,
           FLAT,
           FONT IS Small-Font,
           ID IS 3,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           AFTER PROCEDURE pb-ok-AfterProcedure, 
           BEFORE PROCEDURE pb-ok-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-cancel, 
           Push-Button, 
           COL 27,27, 
           LINE 17,85,
           LINES 1,42 ,
           SIZE 81 PIXELS,
           BITMAP-HANDLE BOTTONE-ANNULLA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Small-Font,
           ID IS 18,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-cancel-AfterProcedure, 
           BEFORE PROCEDURE pb-cancel-BeforeProcedure, 
           .

      * LABEL
       05
           Screen2-La-1fa, 
           Label, 
           COL 1,64, 
           LINE 16,31,
           LINES 1,00 ,
           SIZE 10,00 ,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE "Descrizione",
           .

      * LABEL
       05
           lab-ins-mod, 
           Label, 
           COL 1,91, 
           LINE 1,15,
           LINES 1,00 ,
           SIZE 51,00 ,
           COLOR IS 5,
           ID IS 20,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           TRANSPARENT,
           TITLE lab-ins-mod-buf,
           .

      * FORM
       01 
           scr-filtro, 
           .

      * FRAME
       05
           Screen3-Fr-1, 
           Frame, 
           COL 2,73, 
           LINE 1,12,
           LINES 20,65 ,
           SIZE 75,45 ,
           ENGRAVED,
           ID IS 1,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TITLE "Ricerca WOD per:",
           TITLE-POSITION 2,
           .

      * RADIO BUTTON
       05
           rb-tut, 
           Radio-Button, 
           COL 5,09, 
           LINE 2,54,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1000
           FLAT,
           GROUP 1,
           GROUP-VALUE 1,
           ID IS 78-ID-rb-tut,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Tutto",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-tut-AfterProcedure, 
           BEFORE PROCEDURE rb-tut-BeforeProcedure, 
           .
      * RADIO BUTTON
       05
           rb-des, 
           Radio-Button, 
           COL 5,09, 
           LINE 4,08,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1001
           FLAT,
           GROUP 1,
           GROUP-VALUE 2,
           ID IS 78-ID-rb-des,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Descrizione",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-des-AfterProcedure, 
           BEFORE PROCEDURE rb-des-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-des, 
           Entry-Field, 
           COL 26,82, 
           LINE 4,04,
           LINES 1,23 ,
           SIZE 50,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-des,
           ID IS 78-ID-ef-des,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-des-buf,
           AFTER PROCEDURE ef-des-AfterProcedure, 
           BEFORE PROCEDURE ef-des-BeforeProcedure, 
           .

      * RADIO BUTTON
       05
           rb-dta, 
           Radio-Button, 
           COL 5,09, 
           LINE 5,62,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1002
           FLAT,
           GROUP 1,
           GROUP-VALUE 3,
           ID IS 78-ID-rb-dta,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Data allenamento",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-dta-AfterProcedure, 
           BEFORE PROCEDURE rb-dta-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-dta-from, 
           Entry-Field, 
           COL 26,82, 
           LINE 5,58,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-dta,
           ID IS 78-ID-ef-dta-from,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           VALUE ef-dta-from-buf,
           AFTER PROCEDURE ef-dta-from-AfterProcedure, 
           BEFORE PROCEDURE ef-dta-from-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-dta-to, 
           Entry-Field, 
           COL 36,82, 
           LINE 5,58,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-dta,
           ID IS 78-ID-ef-dta-to,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           VALUE ef-dta-to-buf,
           AFTER PROCEDURE ef-dta-to-AfterProcedure, 
           BEFORE PROCEDURE ef-dta-to-BeforeProcedure, 
           .

      * RADIO BUTTON
       05
           rb-dtc, 
           Radio-Button, 
           COL 5,09, 
           LINE 7,16,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1003
           FLAT,
           GROUP 1,
           GROUP-VALUE 4,
           ID IS 78-ID-rb-dtc,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Data creazione",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-dtc-AfterProcedure, 
           BEFORE PROCEDURE rb-dtc-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-dtc-from, 
           Entry-Field, 
           COL 26,82, 
           LINE 7,12,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-dtc,
           ID IS 78-ID-ef-dtc-from,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           VALUE ef-dtc-from-buf,
           AFTER PROCEDURE ef-dtc-from-AfterProcedure, 
           BEFORE PROCEDURE ef-dtc-from-BeforeProcedure, 
           .

      * ENTRY FIELD
       05
           ef-dtc-to, 
           Entry-Field, 
           COL 36,82, 
           LINE 7,12,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-dtc,
           ID IS 78-ID-ef-dtc-to,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           CENTER,
           VALUE ef-dtc-to-buf,
           AFTER PROCEDURE ef-dtc-to-AfterProcedure, 
           BEFORE PROCEDURE ef-dtc-to-BeforeProcedure, 
           .

      * RADIO BUTTON
       05
           rb-map, 
           Radio-Button, 
           COL 5,09, 
           LINE 8,70,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1004
           FLAT,
           GROUP 1,
           GROUP-VALUE 5,
           ID IS 78-ID-rb-map,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Mappatura",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-map-AfterProcedure, 
           BEFORE PROCEDURE rb-map-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-map, 
           Entry-Field, 
           COL 26,82, 
           LINE 8,70,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-map,
           ID IS 78-ID-ef-map,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           RIGHT,
           VALUE ef-map-buf,
           AFTER PROCEDURE ef-map-AfterProcedure, 
           BEFORE PROCEDURE ef-map-BeforeProcedure, 
           .

      * RADIO BUTTON
       05
           rb-eff, 
           Radio-Button, 
           COL 5,09, 
           LINE 10,35,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1016
           FLAT,
           GROUP 1,
           GROUP-VALUE 11,
           ID IS 78-ID-rb-eff,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Effort",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-eff-AfterProcedure, 
           BEFORE PROCEDURE rb-eff-BeforeProcedure, 
           .
      * COMBO-BOX
       05
           cb-eff, 
           Combo-Box, 
           COL 26,82, 
           LINE 10,27,
           LINES 5,00 ,
           SIZE 50,00 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-eff,
           ID IS 78-ID-cb-eff,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           MASS-UPDATE 0,
           DROP-LIST,
           UNSORTED,
           VALUE cb-eff-buf,
           AFTER PROCEDURE Screen3-Cm-1-AfterProcedure, 
           BEFORE PROCEDURE Screen3-Cm-1-BeforeProcedure, 
           .
      * PUSH BUTTON
       05
           pb-map, 
           Push-Button, 
           COL 36,82, 
           LINE 8,70,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-map,
           EXCEPTION-VALUE 1009,
           FONT IS Small-Font,
           ID IS 2,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * RADIO BUTTON
       05
           rb-exe, 
           Radio-Button, 
           COL 5,09, 
           LINE 11,89,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1005
           FLAT,
           GROUP 1,
           GROUP-VALUE 6,
           ID IS 78-ID-rb-exe,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Esercizio",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-exe-AfterProcedure, 
           BEFORE PROCEDURE rb-exe-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-exe, 
           Entry-Field, 
           COL 26,82, 
           LINE 11,89,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-exe,
           ID IS 78-ID-ef-exe,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-exe-buf,
           AFTER PROCEDURE ef-exe-AfterProcedure, 
           BEFORE PROCEDURE ef-exe-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-exe, 
           Push-Button, 
           COL 36,82, 
           LINE 11,89,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-exe,
           EXCEPTION-VALUE 1010,
           FONT IS Small-Font,
           ID IS 16,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * RADIO BUTTON
       05
           rb-mul, 
           Radio-Button, 
           COL 5,09, 
           LINE 13,43,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1006
           FLAT,
           GROUP 1,
           GROUP-VALUE 7,
           ID IS 78-ID-rb-mul,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Gruppo / Multiarticolare",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-mul-AfterProcedure, 
           BEFORE PROCEDURE rb-mul-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-mul, 
           Entry-Field, 
           COL 26,82, 
           LINE 13,43,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-mul,
           ID IS 78-ID-ef-mul,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-mul-buf,
           AFTER PROCEDURE ef-mul-AfterProcedure, 
           BEFORE PROCEDURE ef-mul-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-mul, 
           Push-Button, 
           COL 36,82, 
           LINE 13,43,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-mul,
           EXCEPTION-VALUE 1011,
           FONT IS Small-Font,
           ID IS 19,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * RADIO BUTTON
       05
           rb-rep, 
           Radio-Button, 
           COL 5,09, 
           LINE 14,97,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1007
           FLAT,
           GROUP 1,
           GROUP-VALUE 8,
           ID IS 78-ID-rb-rep,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Gruppo / rest pause",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-rep-AfterProcedure, 
           BEFORE PROCEDURE rb-rep-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-rep, 
           Entry-Field, 
           COL 26,82, 
           LINE 14,97,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-rep,
           ID IS 78-ID-ef-rep,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-rep-buf,
           AFTER PROCEDURE ef-rep-AfterProcedure, 
           BEFORE PROCEDURE ef-rep-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-rep, 
           Push-Button, 
           COL 36,82, 
           LINE 14,97,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-rep,
           EXCEPTION-VALUE 1012,
           FONT IS Small-Font,
           ID IS 22,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * RADIO BUTTON
       05
           rb-gss, 
           Radio-Button, 
           COL 5,09, 
           LINE 16,50,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1008
           FLAT,
           GROUP 1,
           GROUP-VALUE 9,
           ID IS 78-ID-rb-gss,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Gruppo / super set",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-gss-AfterProcedure, 
           BEFORE PROCEDURE rb-gss-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-gss, 
           Entry-Field, 
           COL 26,82, 
           LINE 16,50,
           LINES 1,23 ,
           SIZE 9,50 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-gss,
           ID IS 78-ID-ef-gss,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-gss-buf,
           AFTER PROCEDURE ef-gss-AfterProcedure, 
           BEFORE PROCEDURE ef-gss-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-gss, 
           Push-Button, 
           COL 36,82, 
           LINE 16,50,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-gss,
           EXCEPTION-VALUE 1013,
           FONT IS Small-Font,
           ID IS 25,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * RADIO BUTTON
       05
           rb-mcg, 
           Radio-Button, 
           COL 5,09, 
           LINE 18,04,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1008
           FLAT,
           GROUP 1,
           GROUP-VALUE 10,
           ID IS 78-ID-rb-mcg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Gruppo",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-mcg-AfterProcedure, 
           BEFORE PROCEDURE rb-mcg-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-mcg, 
           Entry-Field, 
           COL 26,82, 
           LINE 18,04,
           LINES 1,23 ,
           SIZE 9,55 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-mcg,
           ID IS 78-ID-ef-mcg,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-mcg-buf,
           AFTER PROCEDURE ef-mcg-AfterProcedure, 
           BEFORE PROCEDURE ef-mcg-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-mcg, 
           Push-Button, 
           COL 36,82, 
           LINE 18,04,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-mcg,
           EXCEPTION-VALUE 1014,
           FONT IS Small-Font,
           ID IS AUTO-ID,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * LABEL
       05
           lab-map, 
           Label, 
           COL 41,09, 
           LINE 8,70,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 30,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-map-buf,
           .

      * LABEL
       05
           lab-exe, 
           Label, 
           COL 41,09, 
           LINE 11,89,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 31,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-exe-buf,
           .

      * LABEL
       05
           lab-mul, 
           Label, 
           COL 41,09, 
           LINE 13,43,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 32,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-mul-buf,
           .

      * LABEL
       05
           lab-rep, 
           Label, 
           COL 41,09, 
           LINE 14,97,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 33,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-rep-buf,
           .

      * LABEL
       05
           lab-gss, 
           Label, 
           COL 41,09, 
           LINE 16,50,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 34,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-gss-buf,
           .

      * LABEL
       05
           lab-mcg, 
           Label, 
           COL 41,09, 
           LINE 18,04,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 35,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-mcg-buf,
           .

      * RADIO BUTTON
       05
           rb-dur, 
           Radio-Button, 
           COL 5,09, 
           LINE 19,58,
           LINES 1,23 ,
           SIZE 21,00 ,
           EXCEPTION-VALUE 1017
           FLAT,
           GROUP 1,
           GROUP-VALUE 12,
           ID IS 78-ID-rb-dur,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           NO-GROUP-TAB,
           NOTIFY,
           TITLE "Durata",
           VALUE tipo-filtro,
           AFTER PROCEDURE rb-dur-AfterProcedure, 
           BEFORE PROCEDURE rb-dur-BeforeProcedure, 
           .
      * ENTRY FIELD
       05
           ef-dur, 
           Entry-Field, 
           COL 26,82, 
           LINE 19,58,
           LINES 1,23 ,
           SIZE 9,55 ,
           BOXED,
           COLOR IS 513,
           ENABLED e-dur,
           ID IS 78-ID-ef-dur,                
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           VALUE ef-dur-buf,
           AFTER PROCEDURE ef-dur-AfterProcedure, 
           BEFORE PROCEDURE ef-dur-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-dur, 
           Push-Button, 
           COL 36,82, 
           LINE 19,58,
           LINES 1,23 ,
           SIZE 3,00 ,
           ENABLED e-dur,
           EXCEPTION-VALUE 1018,
           FONT IS Small-Font,
           ID IS 39,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           SELF-ACT,
           TITLE "...",
           .

      * LABEL
       05
           lab-dur, 
           Label, 
           COL 41,09, 
           LINE 19,58,
           LINES 1,23 ,
           SIZE 36,00 ,
           COLOR IS 5,
           ID IS 40,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           TRANSPARENT,
           TITLE lab-dur-buf,
           .

      * PUSH BUTTON
       05
           pb-ok-f, 
           Push-Button, 
           COL 33,18, 
           LINE 22,08,
           LINES 1,42 ,
           SIZE 81 PIXELS,
           BITMAP-HANDLE BOTTONE-OK-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           EXCEPTION-VALUE 1015,
           FLAT,
           FONT IS Small-Font,
           ID IS 41,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           AFTER PROCEDURE pb-ok-f-AfterProcedure, 
           BEFORE PROCEDURE pb-ok-f-BeforeProcedure, 
           .

      * PUSH BUTTON
       05
           pb-cancel-f, 
           Push-Button, 
           COL 40,36, 
           LINE 22,08,
           LINES 1,42 ,
           SIZE 81 PIXELS,
           BITMAP-HANDLE BOTTONE-ANNULLA-BMP,
           BITMAP-NUMBER 1,
           UNFRAMED,
           EXCEPTION-VALUE 27,
           FLAT,
           FONT IS Small-Font,
           ID IS 42,
           HEIGHT-IN-CELLS,
           WIDTH-IN-CELLS,
           ESCAPE-BUTTON,
           AFTER PROCEDURE pb-cancel-f-AfterProcedure, 
           BEFORE PROCEDURE pb-cancel-f-BeforeProcedure, 
           .

      *{TOTEM}END

      *{TOTEM}LINKPARA
       PROCEDURE  DIVISION USING LK-BLOCKPGM, lnk-code.
      *{TOTEM}END

      *{TOTEM}DECLARATIVE
       DECLARATIVES.
      * <TOTEM:EPT. INIT:gwod, INIT:gwod, BeforeDeclarative>
       TWODBOOK-ERROR SECTION.
           use after error procedure on TWODBOOK.
           set RecLocked to false.
           evaluate status-TWODBOOK
           when "35"
                display message "File [TWODBOOK] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [TWODBOOK] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[TWODBOOK] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99"
           when "93"
                set RecLocked to true
                set errori    to true
           end-evaluate.                 
           
      ***--     
       RWODBOOK-ERROR SECTION.
           use after error procedure on RWODBOOK.
           set RecLocked to false.
           evaluate status-RWODBOOK
           when "35"
                display message "File [RWODBOOK] not found!"
                           title titolo
                            icon 3
                set errori to true
           when "39"
                display message "File [RWODBOOK] Mismatch size!"
                           title titolo
                            icon 3
                set errori to true
           when "98"
                display message "[RWODBOOK] Indexed file corrupt!"
                           title titolo
                            icon 3
                set errori to true
           when "99"
           when "93"
                set RecLocked to true
                set errori    to true
           end-evaluate.

      * <TOTEM:END>
       INPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON INPUT.
       0100-DECL.
           EXIT.
       I-O-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON I-O.
       0200-DECL.
           EXIT.
       OUTPUT-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON OUTPUT.
       0300-DECL.
           EXIT.
       TRANSACTION-ERROR SECTION.
           USE AFTER STANDARD ERROR PROCEDURE ON TRANSACTION.
       0400-DECL.
           EXIT.
       END DECLARATIVES.
      *{TOTEM}END

       MAIN-LOGIC.
      *{TOTEM}ENTRY-BEFPRG
      *    Before-Program
           PERFORM ginqui-Ev-Before-Program
      *{TOTEM}END
           PERFORM INITIALIZE-ROUTINE.
      * run main screen
      *{TOTEM}RUN-MAINSCR
           PERFORM Form1-OPEN-ROUTINE.
      *{TOTEM}END

      *{TOTEM}COPY-PROCEDURE
       EXIT-STOP-ROUTINE.
           PERFORM CLOSE-FILE-RTN
      * <TOTEM:EPT. INIT:gwod, INIT:gwod, BeforeDestroyResource>
      * <TOTEM:END>
           DESTROY Calibri12-Occidentale
           DESTROY Calibri14-Occidentale
           DESTROY Calibri10B-Occidentale
           DESTROY Calibri12B-Occidentale
           DESTROY Calibri14BU-Occidentale
           DESTROY Calibri24B-Occidentale
           DESTROY Calibri16B-Occidentale
           DESTROY Calibri16-Occidentale
           CALL "w$bitmap" USING WBITMAP-DESTROY, genera-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, random-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, PIU-MENO-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, UP-DOWN-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, intens-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, mod-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, RIPRISTINO-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, toolbar-bmp
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-OK-BMP
           CALL "w$bitmap" USING WBITMAP-DESTROY, BOTTONE-ANNULLA-BMP
      *    After-Program
           PERFORM ginqui-Ev-After-Program
           EXIT PROGRAM TOTEM-PgmStatus
           STOP RUN.

       INITIALIZE-ROUTINE.
      *    Before Init
      * initialize program status variable
           Initialize TOTEM-PgmStatus.
      * get system information
           ACCEPT SYSTEM-INFORMATION FROM SYSTEM-INFO.
      * get terminal information
           ACCEPT TERMINAL-ABILITIES FROM TERMINAL-INFO.
      * set font
           PERFORM INIT-FONT.
      * load bitmap
           PERFORM INIT-BMP.
      * load resource
           PERFORM INIT-RES.
      * create pop-up menu
           PERFORM INIT-POPUP.
      * open files
           PERFORM OPEN-FILE-RTN.
      *    After Init
           .
    
       INIT-FONT.
      * Calibri12-Occidentale
           INITIALIZE WFONT-DATA Calibri12-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri12-Occidentale, WFONT-DATA
      * Calibri14-Occidentale
           INITIALIZE WFONT-DATA Calibri14-Occidentale
           MOVE 14 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri14-Occidentale, WFONT-DATA
      * Calibri10B-Occidentale
           INITIALIZE WFONT-DATA Calibri10B-Occidentale
           MOVE 10 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri10B-Occidentale, WFONT-DATA
      * Calibri12B-Occidentale
           INITIALIZE WFONT-DATA Calibri12B-Occidentale
           MOVE 12 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri12B-Occidentale, WFONT-DATA
      * Calibri14BU-Occidentale
           INITIALIZE WFONT-DATA Calibri14BU-Occidentale
           MOVE 14 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO TRUE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri14BU-Occidentale, WFONT-DATA
      * Calibri24B-Occidentale
           INITIALIZE WFONT-DATA Calibri24B-Occidentale
           MOVE 24 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri24B-Occidentale, WFONT-DATA
      * Calibri16B-Occidentale
           INITIALIZE WFONT-DATA Calibri16B-Occidentale
           MOVE 16 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO TRUE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri16B-Occidentale, WFONT-DATA
      * Calibri16-Occidentale
           INITIALIZE WFONT-DATA Calibri16-Occidentale
           MOVE 16 TO WFONT-SIZE
           MOVE "Calibri" TO WFONT-NAME
           SET WFCHARSET-DONT-CARE TO TRUE
           SET WFONT-BOLD TO FALSE
           SET WFONT-ITALIC TO FALSE
           SET WFONT-UNDERLINE TO FALSE
           SET WFONT-STRIKEOUT TO FALSE
           SET WFONT-FIXED-PITCH TO FALSE
           MOVE 0 TO WFONT-CHAR-SET
           CALL "W$FONT" USING WFONT-GET-FONT, 
                     Calibri16-Occidentale, WFONT-DATA
           .

       INIT-BMP.
      * pb-genera
           COPY RESOURCE "genera.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "genera.bmp", 
                   GIVING genera-bmp.
      * pb-random
           COPY RESOURCE "random.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "random.bmp", 
                   GIVING random-bmp.
      * pb-aggiungi
           COPY RESOURCE "PIU-MENO.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "PIU-MENO.BMP", 
                   GIVING PIU-MENO-BMP.
      * pb-su
           COPY RESOURCE "UP-DOWN.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "UP-DOWN.BMP", 
                   GIVING UP-DOWN-BMP.
      * pb-int
           COPY RESOURCE "intens.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "intens.BMP", 
                   GIVING intens-BMP.
      * pb-mod
           COPY RESOURCE "MOD.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "MOD.BMP", 
                   GIVING mod-bmp.
      * pb-ripristino
           COPY RESOURCE "RIPRISTINO.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "RIPRISTINO.BMP", 
                   GIVING RIPRISTINO-BMP.
      * TOOL-ESCI
           COPY RESOURCE "toolbar.bmp".
           CALL "w$bitmap" USING WBITMAP-LOAD "toolbar.bmp", 
                   GIVING toolbar-bmp.
      * pb-ok
           COPY RESOURCE "BOTTONE-OK.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-OK.BMP", 
                   GIVING BOTTONE-OK-BMP.
      * pb-cancel
           COPY RESOURCE "BOTTONE-ANNULLA.BMP".
           CALL "w$bitmap" USING WBITMAP-LOAD "BOTTONE-ANNULLA.BMP", 
                   GIVING BOTTONE-ANNULLA-BMP.
           .

       INIT-RES.
           .

       INIT-POPUP.
           .

       OPEN-FILE-RTN.
      *    Before Open
           PERFORM OPEN-exercises
           PERFORM OPEN-groups
           PERFORM OPEN-macrogroups
           PERFORM OPEN-duration
      *    tmp-exe-effort OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-exe-effort
           PERFORM OPEN-wodmap
      *    tmp-wod-exe OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-wod-exe
      *    tmp-exe OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-exe
           PERFORM OPEN-intexe
      *    tmp-exe-dupl OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-exe-dupl
      *    zoom-exe-mcg OPEN MODE IS FALSE
      *    PERFORM OPEN-zoom-exe-mcg
      *    tmp-hit OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-hit
      *    tmp-grp-exe OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-grp-exe
      *    tmp-superset OPEN MODE IS FALSE
      *    PERFORM OPEN-tmp-superset
      *    zoom-wodbook OPEN MODE IS FALSE
      *    PERFORM OPEN-zoom-wodbook
           PERFORM OPEN-rwodbook
           PERFORM OPEN-twodbook
      *    After Open
           .

       OPEN-exercises.
      * <TOTEM:EPT. INIT:gwod, FD:exercises, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT exercises
           IF NOT Valid-STATUS-exercises
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:exercises, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-groups.
      * <TOTEM:EPT. INIT:gwod, FD:groups, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT groups
           IF NOT Valid-STATUS-groups
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:groups, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-macrogroups.
      * <TOTEM:EPT. INIT:gwod, FD:macrogroups, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT macrogroups
           IF NOT Valid-STATUS-macrogroups
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:macrogroups, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-duration.
      * <TOTEM:EPT. INIT:gwod, FD:duration, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT duration
           IF NOT Valid-STATUS-duration
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:duration, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-exe-effort.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe-effort, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-exe-effort
           IF NOT Valid-STATUS-tmp-exe-effort
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe-effort, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-wodmap.
      * <TOTEM:EPT. INIT:gwod, FD:wodmap, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT wodmap
           IF NOT Valid-STATUS-wodmap
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:wodmap, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-wod-exe.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-wod-exe, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-wod-exe
           IF NOT Valid-STATUS-tmp-wod-exe
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-wod-exe, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-exe.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-exe
           IF NOT Valid-STATUS-tmp-exe
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-intexe.
      * <TOTEM:EPT. INIT:gwod, FD:intexe, BeforeOpen>
      * <TOTEM:END>
           OPEN  INPUT intexe
           IF NOT Valid-STATUS-intexe
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:intexe, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-exe-dupl.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe-dupl, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-exe-dupl
           IF NOT Valid-STATUS-tmp-exe-dupl
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe-dupl, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-zoom-exe-mcg.
      * <TOTEM:EPT. INIT:gwod, FD:zoom-exe-mcg, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT zoom-exe-mcg
           IF NOT Valid-STATUS-zoom-exe-mcg
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:zoom-exe-mcg, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-hit.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-hit, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-hit
           IF NOT Valid-STATUS-tmp-hit
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-hit, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-grp-exe.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-grp-exe, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-grp-exe
           IF NOT Valid-STATUS-tmp-grp-exe
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-grp-exe, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-tmp-superset.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-superset, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT tmp-superset
           IF NOT Valid-STATUS-tmp-superset
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:tmp-superset, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-zoom-wodbook.
      * <TOTEM:EPT. INIT:gwod, FD:zoom-wodbook, BeforeOpen>
      * <TOTEM:END>
           OPEN  OUTPUT zoom-wodbook
           IF NOT Valid-STATUS-zoom-wodbook
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:zoom-wodbook, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-rwodbook.
      * <TOTEM:EPT. INIT:gwod, FD:rwodbook, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O rwodbook
           IF STATUS-rwodbook = "35"
              OPEN OUTPUT rwodbook
                IF Valid-STATUS-rwodbook
                   CLOSE rwodbook
                   OPEN I-O rwodbook
                END-IF
           END-IF
           IF NOT Valid-STATUS-rwodbook
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:rwodbook, AfterOpen>
      * <TOTEM:END>
           .

       OPEN-twodbook.
      * <TOTEM:EPT. INIT:gwod, FD:twodbook, BeforeOpen>
      * <TOTEM:END>
           OPEN  I-O twodbook
           IF STATUS-twodbook = "35"
              OPEN OUTPUT twodbook
                IF Valid-STATUS-twodbook
                   CLOSE twodbook
                   OPEN I-O twodbook
                END-IF
           END-IF
           IF NOT Valid-STATUS-twodbook
              PERFORM  Form1-EXTENDED-FILE-STATUS
              GO TO EXIT-STOP-ROUTINE
           END-IF
      * <TOTEM:EPT. INIT:gwod, FD:twodbook, AfterOpen>
      * <TOTEM:END>
           .

       CLOSE-FILE-RTN.
      *    Before Close
           PERFORM CLOSE-exercises
           PERFORM CLOSE-groups
           PERFORM CLOSE-macrogroups
           PERFORM CLOSE-duration
      *    tmp-exe-effort CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-exe-effort
           PERFORM CLOSE-wodmap
      *    tmp-wod-exe CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-wod-exe
      *    tmp-exe CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-exe
           PERFORM CLOSE-intexe
      *    tmp-exe-dupl CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-exe-dupl
      *    zoom-exe-mcg CLOSE MODE IS FALSE
      *    PERFORM CLOSE-zoom-exe-mcg
      *    tmp-hit CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-hit
      *    tmp-grp-exe CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-grp-exe
      *    tmp-superset CLOSE MODE IS FALSE
      *    PERFORM CLOSE-tmp-superset
      *    zoom-wodbook CLOSE MODE IS FALSE
      *    PERFORM CLOSE-zoom-wodbook
           PERFORM CLOSE-rwodbook
           PERFORM CLOSE-twodbook
      *    After Close
           .

       CLOSE-exercises.
      * <TOTEM:EPT. INIT:gwod, FD:exercises, BeforeClose>
      * <TOTEM:END>
           CLOSE exercises
           .

       CLOSE-groups.
      * <TOTEM:EPT. INIT:gwod, FD:groups, BeforeClose>
      * <TOTEM:END>
           CLOSE groups
           .

       CLOSE-macrogroups.
      * <TOTEM:EPT. INIT:gwod, FD:macrogroups, BeforeClose>
      * <TOTEM:END>
           CLOSE macrogroups
           .

       CLOSE-duration.
      * <TOTEM:EPT. INIT:gwod, FD:duration, BeforeClose>
      * <TOTEM:END>
           CLOSE duration
           .

       CLOSE-tmp-exe-effort.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe-effort, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-wodmap.
      * <TOTEM:EPT. INIT:gwod, FD:wodmap, BeforeClose>
      * <TOTEM:END>
           CLOSE wodmap
           .

       CLOSE-tmp-wod-exe.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-wod-exe, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tmp-exe.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-intexe.
      * <TOTEM:EPT. INIT:gwod, FD:intexe, BeforeClose>
      * <TOTEM:END>
           CLOSE intexe
           .

       CLOSE-tmp-exe-dupl.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-exe-dupl, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-zoom-exe-mcg.
      * <TOTEM:EPT. INIT:gwod, FD:zoom-exe-mcg, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tmp-hit.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-hit, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tmp-grp-exe.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-grp-exe, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-tmp-superset.
      * <TOTEM:EPT. INIT:gwod, FD:tmp-superset, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-zoom-wodbook.
      * <TOTEM:EPT. INIT:gwod, FD:zoom-wodbook, BeforeClose>
      * <TOTEM:END>
           .

       CLOSE-rwodbook.
      * <TOTEM:EPT. INIT:gwod, FD:rwodbook, BeforeClose>
      * <TOTEM:END>
           CLOSE rwodbook
           .

       CLOSE-twodbook.
      * <TOTEM:EPT. INIT:gwod, FD:twodbook, BeforeClose>
      * <TOTEM:END>
           CLOSE twodbook
           .

       exercises-exe-k-desc-MERGE-SPLITBUF.
           INITIALIZE exercises-exe-k-desc-SPLITBUF
           MOVE exe-desc(1:100) TO exercises-exe-k-desc-SPLITBUF(1:100)
           .

       exercises-exe-k-group-MERGE-SPLITBUF.
           INITIALIZE exercises-exe-k-group-SPLITBUF
           MOVE exe-grp-code(1:5) TO exercises-exe-k-group-SPLITBUF(1:5)
           MOVE exe-key(1:5) TO exercises-exe-k-group-SPLITBUF(6:5)
           .

       DataSet1-exercises-INITSTART.
           IF DataSet1-exercises-KEY-Asc
              MOVE Low-Value TO exe-key
           ELSE
              MOVE High-Value TO exe-key
           END-IF
           .

       DataSet1-exercises-INITEND.
           IF DataSet1-exercises-KEY-Asc
              MOVE High-Value TO exe-key
           ELSE
              MOVE Low-Value TO exe-key
           END-IF
           .

      * exercises
       DataSet1-exercises-START.
           IF DataSet1-exercises-KEY-Asc
              START exercises KEY >= exe-key
           ELSE
              START exercises KEY <= exe-key
           END-IF
           .

       DataSet1-exercises-START-NOTGREATER.
           IF DataSet1-exercises-KEY-Asc
              START exercises KEY <= exe-key
           ELSE
              START exercises KEY >= exe-key
           END-IF
           .

       DataSet1-exercises-START-GREATER.
           IF DataSet1-exercises-KEY-Asc
              START exercises KEY > exe-key
           ELSE
              START exercises KEY < exe-key
           END-IF
           .

       DataSet1-exercises-START-LESS.
           IF DataSet1-exercises-KEY-Asc
              START exercises KEY < exe-key
           ELSE
              START exercises KEY > exe-key
           END-IF
           .

       DataSet1-exercises-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-exercises-LOCK
              READ exercises WITH LOCK 
              KEY exe-key
           ELSE
              READ exercises WITH NO LOCK 
              KEY exe-key
           END-IF
           PERFORM exercises-exe-k-desc-MERGE-SPLITBUF
           PERFORM exercises-exe-k-group-MERGE-SPLITBUF
           MOVE STATUS-exercises TO TOTEM-ERR-STAT 
           MOVE "exercises" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-exercises-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-exercises-KEY-Asc
              IF DataSet1-exercises-LOCK
                 READ exercises NEXT WITH LOCK
              ELSE
                 READ exercises NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-exercises-LOCK
                 READ exercises PREVIOUS WITH LOCK
              ELSE
                 READ exercises PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM exercises-exe-k-desc-MERGE-SPLITBUF
           PERFORM exercises-exe-k-group-MERGE-SPLITBUF
           MOVE STATUS-exercises TO TOTEM-ERR-STAT
           MOVE "exercises" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-exercises-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-exercises-KEY-Asc
              IF DataSet1-exercises-LOCK
                 READ exercises PREVIOUS WITH LOCK
              ELSE
                 READ exercises PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-exercises-LOCK
                 READ exercises NEXT WITH LOCK
              ELSE
                 READ exercises NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM exercises-exe-k-desc-MERGE-SPLITBUF
           PERFORM exercises-exe-k-group-MERGE-SPLITBUF
           MOVE STATUS-exercises TO TOTEM-ERR-STAT
           MOVE "exercises" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-exercises-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-exercises TO TOTEM-ERR-STAT
           MOVE "exercises" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-exercises-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-exercises TO TOTEM-ERR-STAT
           MOVE "exercises" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-exercises-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-exercises TO TOTEM-ERR-STAT
           MOVE "exercises" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:exercises, AfterDelete>
      * <TOTEM:END>
           .

       groups-grp-k-desc-MERGE-SPLITBUF.
           INITIALIZE groups-grp-k-desc-SPLITBUF
           MOVE grp-desc(1:100) TO groups-grp-k-desc-SPLITBUF(1:100)
           .

       groups-grp-k-mcg-MERGE-SPLITBUF.
           INITIALIZE groups-grp-k-mcg-SPLITBUF
           MOVE grp-mcg-code(1:5) TO groups-grp-k-mcg-SPLITBUF(1:5)
           MOVE grp-key(1:5) TO groups-grp-k-mcg-SPLITBUF(6:5)
           .

       DataSet1-groups-INITSTART.
           IF DataSet1-groups-KEY-Asc
              MOVE Low-Value TO grp-key
           ELSE
              MOVE High-Value TO grp-key
           END-IF
           .

       DataSet1-groups-INITEND.
           IF DataSet1-groups-KEY-Asc
              MOVE High-Value TO grp-key
           ELSE
              MOVE Low-Value TO grp-key
           END-IF
           .

      * groups
       DataSet1-groups-START.
           IF DataSet1-groups-KEY-Asc
              START groups KEY >= grp-key
           ELSE
              START groups KEY <= grp-key
           END-IF
           .

       DataSet1-groups-START-NOTGREATER.
           IF DataSet1-groups-KEY-Asc
              START groups KEY <= grp-key
           ELSE
              START groups KEY >= grp-key
           END-IF
           .

       DataSet1-groups-START-GREATER.
           IF DataSet1-groups-KEY-Asc
              START groups KEY > grp-key
           ELSE
              START groups KEY < grp-key
           END-IF
           .

       DataSet1-groups-START-LESS.
           IF DataSet1-groups-KEY-Asc
              START groups KEY < grp-key
           ELSE
              START groups KEY > grp-key
           END-IF
           .

       DataSet1-groups-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-groups-LOCK
              READ groups WITH LOCK 
              KEY grp-key
           ELSE
              READ groups WITH NO LOCK 
              KEY grp-key
           END-IF
           PERFORM groups-grp-k-desc-MERGE-SPLITBUF
           PERFORM groups-grp-k-mcg-MERGE-SPLITBUF
           MOVE STATUS-groups TO TOTEM-ERR-STAT 
           MOVE "groups" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-groups-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-groups-KEY-Asc
              IF DataSet1-groups-LOCK
                 READ groups NEXT WITH LOCK
              ELSE
                 READ groups NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-groups-LOCK
                 READ groups PREVIOUS WITH LOCK
              ELSE
                 READ groups PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM groups-grp-k-desc-MERGE-SPLITBUF
           PERFORM groups-grp-k-mcg-MERGE-SPLITBUF
           MOVE STATUS-groups TO TOTEM-ERR-STAT
           MOVE "groups" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-groups-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-groups-KEY-Asc
              IF DataSet1-groups-LOCK
                 READ groups PREVIOUS WITH LOCK
              ELSE
                 READ groups PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-groups-LOCK
                 READ groups NEXT WITH LOCK
              ELSE
                 READ groups NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM groups-grp-k-desc-MERGE-SPLITBUF
           PERFORM groups-grp-k-mcg-MERGE-SPLITBUF
           MOVE STATUS-groups TO TOTEM-ERR-STAT
           MOVE "groups" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-groups-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-groups TO TOTEM-ERR-STAT
           MOVE "groups" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-groups-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-groups TO TOTEM-ERR-STAT
           MOVE "groups" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-groups-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:groups, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-groups TO TOTEM-ERR-STAT
           MOVE "groups" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:groups, AfterDelete>
      * <TOTEM:END>
           .

       macrogroups-mcg-k-desc-MERGE-SPLITBUF.
           INITIALIZE macrogroups-mcg-k-desc-SPLITBUF
           MOVE mcg-desc(1:100) TO 
           macrogroups-mcg-k-desc-SPLITBUF(1:100)
           .

       DataSet1-macrogroups-INITSTART.
           IF DataSet1-macrogroups-KEY-Asc
              MOVE Low-Value TO mcg-key
           ELSE
              MOVE High-Value TO mcg-key
           END-IF
           .

       DataSet1-macrogroups-INITEND.
           IF DataSet1-macrogroups-KEY-Asc
              MOVE High-Value TO mcg-key
           ELSE
              MOVE Low-Value TO mcg-key
           END-IF
           .

      * macrogroups
       DataSet1-macrogroups-START.
           IF DataSet1-macrogroups-KEY-Asc
              START macrogroups KEY >= mcg-key
           ELSE
              START macrogroups KEY <= mcg-key
           END-IF
           .

       DataSet1-macrogroups-START-NOTGREATER.
           IF DataSet1-macrogroups-KEY-Asc
              START macrogroups KEY <= mcg-key
           ELSE
              START macrogroups KEY >= mcg-key
           END-IF
           .

       DataSet1-macrogroups-START-GREATER.
           IF DataSet1-macrogroups-KEY-Asc
              START macrogroups KEY > mcg-key
           ELSE
              START macrogroups KEY < mcg-key
           END-IF
           .

       DataSet1-macrogroups-START-LESS.
           IF DataSet1-macrogroups-KEY-Asc
              START macrogroups KEY < mcg-key
           ELSE
              START macrogroups KEY > mcg-key
           END-IF
           .

       DataSet1-macrogroups-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-macrogroups-LOCK
              READ macrogroups WITH LOCK 
              KEY mcg-key
           ELSE
              READ macrogroups WITH NO LOCK 
              KEY mcg-key
           END-IF
           PERFORM macrogroups-mcg-k-desc-MERGE-SPLITBUF
           MOVE STATUS-macrogroups TO TOTEM-ERR-STAT 
           MOVE "macrogroups" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-macrogroups-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-macrogroups-KEY-Asc
              IF DataSet1-macrogroups-LOCK
                 READ macrogroups NEXT WITH LOCK
              ELSE
                 READ macrogroups NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-macrogroups-LOCK
                 READ macrogroups PREVIOUS WITH LOCK
              ELSE
                 READ macrogroups PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM macrogroups-mcg-k-desc-MERGE-SPLITBUF
           MOVE STATUS-macrogroups TO TOTEM-ERR-STAT
           MOVE "macrogroups" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-macrogroups-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-macrogroups-KEY-Asc
              IF DataSet1-macrogroups-LOCK
                 READ macrogroups PREVIOUS WITH LOCK
              ELSE
                 READ macrogroups PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-macrogroups-LOCK
                 READ macrogroups NEXT WITH LOCK
              ELSE
                 READ macrogroups NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM macrogroups-mcg-k-desc-MERGE-SPLITBUF
           MOVE STATUS-macrogroups TO TOTEM-ERR-STAT
           MOVE "macrogroups" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-macrogroups-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-macrogroups TO TOTEM-ERR-STAT
           MOVE "macrogroups" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-macrogroups-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-macrogroups TO TOTEM-ERR-STAT
           MOVE "macrogroups" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-macrogroups-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-macrogroups TO TOTEM-ERR-STAT
           MOVE "macrogroups" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:macrogroups, AfterDelete>
      * <TOTEM:END>
           .

       duration-dur-k-desc-MERGE-SPLITBUF.
           INITIALIZE duration-dur-k-desc-SPLITBUF
           MOVE dur-desc(1:100) TO duration-dur-k-desc-SPLITBUF(1:100)
           .

       duration-dur-k-exercises-MERGE-SPLITBUF.
           INITIALIZE duration-dur-k-exercises-SPLITBUF
           MOVE dur-exercises(1:2) TO 
           duration-dur-k-exercises-SPLITBUF(1:2)
           .

       DataSet1-duration-INITSTART.
           IF DataSet1-duration-KEY-Asc
              MOVE Low-Value TO dur-key
           ELSE
              MOVE High-Value TO dur-key
           END-IF
           .

       DataSet1-duration-INITEND.
           IF DataSet1-duration-KEY-Asc
              MOVE High-Value TO dur-key
           ELSE
              MOVE Low-Value TO dur-key
           END-IF
           .

      * duration
       DataSet1-duration-START.
           IF DataSet1-duration-KEY-Asc
              START duration KEY >= dur-key
           ELSE
              START duration KEY <= dur-key
           END-IF
           .

       DataSet1-duration-START-NOTGREATER.
           IF DataSet1-duration-KEY-Asc
              START duration KEY <= dur-key
           ELSE
              START duration KEY >= dur-key
           END-IF
           .

       DataSet1-duration-START-GREATER.
           IF DataSet1-duration-KEY-Asc
              START duration KEY > dur-key
           ELSE
              START duration KEY < dur-key
           END-IF
           .

       DataSet1-duration-START-LESS.
           IF DataSet1-duration-KEY-Asc
              START duration KEY < dur-key
           ELSE
              START duration KEY > dur-key
           END-IF
           .

       DataSet1-duration-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-duration-LOCK
              READ duration WITH LOCK 
              KEY dur-key
           ELSE
              READ duration WITH NO LOCK 
              KEY dur-key
           END-IF
           PERFORM duration-dur-k-desc-MERGE-SPLITBUF
           PERFORM duration-dur-k-exercises-MERGE-SPLITBUF
           MOVE STATUS-duration TO TOTEM-ERR-STAT 
           MOVE "duration" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-duration-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-duration-KEY-Asc
              IF DataSet1-duration-LOCK
                 READ duration NEXT WITH LOCK
              ELSE
                 READ duration NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-duration-LOCK
                 READ duration PREVIOUS WITH LOCK
              ELSE
                 READ duration PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM duration-dur-k-desc-MERGE-SPLITBUF
           PERFORM duration-dur-k-exercises-MERGE-SPLITBUF
           MOVE STATUS-duration TO TOTEM-ERR-STAT
           MOVE "duration" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-duration-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-duration-KEY-Asc
              IF DataSet1-duration-LOCK
                 READ duration PREVIOUS WITH LOCK
              ELSE
                 READ duration PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-duration-LOCK
                 READ duration NEXT WITH LOCK
              ELSE
                 READ duration NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM duration-dur-k-desc-MERGE-SPLITBUF
           PERFORM duration-dur-k-exercises-MERGE-SPLITBUF
           MOVE STATUS-duration TO TOTEM-ERR-STAT
           MOVE "duration" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-duration-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-duration TO TOTEM-ERR-STAT
           MOVE "duration" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-duration-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-duration TO TOTEM-ERR-STAT
           MOVE "duration" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-duration-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:duration, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-duration TO TOTEM-ERR-STAT
           MOVE "duration" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:duration, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-effort-INITSTART.
           IF DataSet1-tmp-exe-effort-KEY-Asc
              MOVE Low-Value TO tee-key
           ELSE
              MOVE High-Value TO tee-key
           END-IF
           .

       DataSet1-tmp-exe-effort-INITEND.
           IF DataSet1-tmp-exe-effort-KEY-Asc
              MOVE High-Value TO tee-key
           ELSE
              MOVE Low-Value TO tee-key
           END-IF
           .

      * tmp-exe-effort
       DataSet1-tmp-exe-effort-START.
           IF DataSet1-tmp-exe-effort-KEY-Asc
              START tmp-exe-effort KEY >= tee-key
           ELSE
              START tmp-exe-effort KEY <= tee-key
           END-IF
           .

       DataSet1-tmp-exe-effort-START-NOTGREATER.
           IF DataSet1-tmp-exe-effort-KEY-Asc
              START tmp-exe-effort KEY <= tee-key
           ELSE
              START tmp-exe-effort KEY >= tee-key
           END-IF
           .

       DataSet1-tmp-exe-effort-START-GREATER.
           IF DataSet1-tmp-exe-effort-KEY-Asc
              START tmp-exe-effort KEY > tee-key
           ELSE
              START tmp-exe-effort KEY < tee-key
           END-IF
           .

       DataSet1-tmp-exe-effort-START-LESS.
           IF DataSet1-tmp-exe-effort-KEY-Asc
              START tmp-exe-effort KEY < tee-key
           ELSE
              START tmp-exe-effort KEY > tee-key
           END-IF
           .

       DataSet1-tmp-exe-effort-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-effort-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-effort-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-effort-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeWrite>
      * <TOTEM:END>
           WRITE tee-rec OF tmp-exe-effort.
           MOVE STATUS-tmp-exe-effort TO TOTEM-ERR-STAT
           MOVE "tmp-exe-effort" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-effort-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-exe-effort TO TOTEM-ERR-STAT
           MOVE "tmp-exe-effort" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-effort-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-exe-effort TO TOTEM-ERR-STAT
           MOVE "tmp-exe-effort" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-effort, AfterDelete>
      * <TOTEM:END>
           .

       wodmap-wom-k-desc-MERGE-SPLITBUF.
           INITIALIZE wodmap-wom-k-desc-SPLITBUF
           MOVE wom-desc(1:100) TO wodmap-wom-k-desc-SPLITBUF(1:100)
           .

       DataSet1-wodmap-INITSTART.
           IF DataSet1-wodmap-KEY-Asc
              MOVE Low-Value TO wom-key
           ELSE
              MOVE High-Value TO wom-key
           END-IF
           .

       DataSet1-wodmap-INITEND.
           IF DataSet1-wodmap-KEY-Asc
              MOVE High-Value TO wom-key
           ELSE
              MOVE Low-Value TO wom-key
           END-IF
           .

      * wodmap
       DataSet1-wodmap-START.
           IF DataSet1-wodmap-KEY-Asc
              START wodmap KEY >= wom-key
           ELSE
              START wodmap KEY <= wom-key
           END-IF
           .

       DataSet1-wodmap-START-NOTGREATER.
           IF DataSet1-wodmap-KEY-Asc
              START wodmap KEY <= wom-key
           ELSE
              START wodmap KEY >= wom-key
           END-IF
           .

       DataSet1-wodmap-START-GREATER.
           IF DataSet1-wodmap-KEY-Asc
              START wodmap KEY > wom-key
           ELSE
              START wodmap KEY < wom-key
           END-IF
           .

       DataSet1-wodmap-START-LESS.
           IF DataSet1-wodmap-KEY-Asc
              START wodmap KEY < wom-key
           ELSE
              START wodmap KEY > wom-key
           END-IF
           .

       DataSet1-wodmap-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-wodmap-LOCK
              READ wodmap WITH LOCK 
              KEY wom-key
           ELSE
              READ wodmap WITH NO LOCK 
              KEY wom-key
           END-IF
           PERFORM wodmap-wom-k-desc-MERGE-SPLITBUF
           MOVE STATUS-wodmap TO TOTEM-ERR-STAT 
           MOVE "wodmap" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-wodmap-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-wodmap-KEY-Asc
              IF DataSet1-wodmap-LOCK
                 READ wodmap NEXT WITH LOCK
              ELSE
                 READ wodmap NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-wodmap-LOCK
                 READ wodmap PREVIOUS WITH LOCK
              ELSE
                 READ wodmap PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM wodmap-wom-k-desc-MERGE-SPLITBUF
           MOVE STATUS-wodmap TO TOTEM-ERR-STAT
           MOVE "wodmap" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-wodmap-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-wodmap-KEY-Asc
              IF DataSet1-wodmap-LOCK
                 READ wodmap PREVIOUS WITH LOCK
              ELSE
                 READ wodmap PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-wodmap-LOCK
                 READ wodmap NEXT WITH LOCK
              ELSE
                 READ wodmap NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM wodmap-wom-k-desc-MERGE-SPLITBUF
           MOVE STATUS-wodmap TO TOTEM-ERR-STAT
           MOVE "wodmap" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-wodmap-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-wodmap TO TOTEM-ERR-STAT
           MOVE "wodmap" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-wodmap-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-wodmap TO TOTEM-ERR-STAT
           MOVE "wodmap" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-wodmap-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-wodmap TO TOTEM-ERR-STAT
           MOVE "wodmap" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:wodmap, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmp-wod-exe-INITSTART.
           IF DataSet1-tmp-wod-exe-KEY-Asc
              MOVE Low-Value TO twe-key
           ELSE
              MOVE High-Value TO twe-key
           END-IF
           .

       DataSet1-tmp-wod-exe-INITEND.
           IF DataSet1-tmp-wod-exe-KEY-Asc
              MOVE High-Value TO twe-key
           ELSE
              MOVE Low-Value TO twe-key
           END-IF
           .

      * tmp-wod-exe
       DataSet1-tmp-wod-exe-START.
           IF DataSet1-tmp-wod-exe-KEY-Asc
              START tmp-wod-exe KEY >= twe-key
           ELSE
              START tmp-wod-exe KEY <= twe-key
           END-IF
           .

       DataSet1-tmp-wod-exe-START-NOTGREATER.
           IF DataSet1-tmp-wod-exe-KEY-Asc
              START tmp-wod-exe KEY <= twe-key
           ELSE
              START tmp-wod-exe KEY >= twe-key
           END-IF
           .

       DataSet1-tmp-wod-exe-START-GREATER.
           IF DataSet1-tmp-wod-exe-KEY-Asc
              START tmp-wod-exe KEY > twe-key
           ELSE
              START tmp-wod-exe KEY < twe-key
           END-IF
           .

       DataSet1-tmp-wod-exe-START-LESS.
           IF DataSet1-tmp-wod-exe-KEY-Asc
              START tmp-wod-exe KEY < twe-key
           ELSE
              START tmp-wod-exe KEY > twe-key
           END-IF
           .

       DataSet1-tmp-wod-exe-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-wod-exe-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-wod-exe-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-wod-exe-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeWrite>
      * <TOTEM:END>
           WRITE twe-rec OF tmp-wod-exe.
           MOVE STATUS-tmp-wod-exe TO TOTEM-ERR-STAT
           MOVE "tmp-wod-exe" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-wod-exe-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-wod-exe TO TOTEM-ERR-STAT
           MOVE "tmp-wod-exe" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-wod-exe-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-wod-exe TO TOTEM-ERR-STAT
           MOVE "tmp-wod-exe" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-wod-exe, AfterDelete>
      * <TOTEM:END>
           .

       tmp-exe-tex-k-dupl-MERGE-SPLITBUF.
           INITIALIZE tmp-exe-tex-k-dupl-SPLITBUF
           MOVE tex-day(1:1) TO tmp-exe-tex-k-dupl-SPLITBUF(1:1)
           MOVE tex-nome-dupl(1:100) TO 
           tmp-exe-tex-k-dupl-SPLITBUF(2:100)
           .

       tmp-exe-tex-k-mcg-MERGE-SPLITBUF.
           INITIALIZE tmp-exe-tex-k-mcg-SPLITBUF
           MOVE tex-mcg-code(1:5) TO tmp-exe-tex-k-mcg-SPLITBUF(1:5)
           MOVE tex-key(1:4) TO tmp-exe-tex-k-mcg-SPLITBUF(6:4)
           .

       tmp-exe-tex-k-day-exe-MERGE-SPLITBUF.
           INITIALIZE tmp-exe-tex-k-day-exe-SPLITBUF
           MOVE tex-day(1:1) TO tmp-exe-tex-k-day-exe-SPLITBUF(1:1)
           MOVE tex-desc-univoca(1:100) TO 
           tmp-exe-tex-k-day-exe-SPLITBUF(2:100)
           .

       tmp-exe-tex-k-exe-MERGE-SPLITBUF.
           INITIALIZE tmp-exe-tex-k-exe-SPLITBUF
           MOVE tex-desc-univoca(1:100) TO 
           tmp-exe-tex-k-exe-SPLITBUF(1:100)
           .

       DataSet1-tmp-exe-INITSTART.
           IF DataSet1-tmp-exe-KEY-Asc
              MOVE Low-Value TO tex-key
           ELSE
              MOVE High-Value TO tex-key
           END-IF
           .

       DataSet1-tmp-exe-INITEND.
           IF DataSet1-tmp-exe-KEY-Asc
              MOVE High-Value TO tex-key
           ELSE
              MOVE Low-Value TO tex-key
           END-IF
           .

      * tmp-exe
       DataSet1-tmp-exe-START.
           IF DataSet1-tmp-exe-KEY-Asc
              START tmp-exe KEY >= tex-key
           ELSE
              START tmp-exe KEY <= tex-key
           END-IF
           .

       DataSet1-tmp-exe-START-NOTGREATER.
           IF DataSet1-tmp-exe-KEY-Asc
              START tmp-exe KEY <= tex-key
           ELSE
              START tmp-exe KEY >= tex-key
           END-IF
           .

       DataSet1-tmp-exe-START-GREATER.
           IF DataSet1-tmp-exe-KEY-Asc
              START tmp-exe KEY > tex-key
           ELSE
              START tmp-exe KEY < tex-key
           END-IF
           .

       DataSet1-tmp-exe-START-LESS.
           IF DataSet1-tmp-exe-KEY-Asc
              START tmp-exe KEY < tex-key
           ELSE
              START tmp-exe KEY > tex-key
           END-IF
           .

       DataSet1-tmp-exe-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeWrite>
      * <TOTEM:END>
           WRITE tex-rec OF tmp-exe.
           MOVE STATUS-tmp-exe TO TOTEM-ERR-STAT
           MOVE "tmp-exe" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-exe TO TOTEM-ERR-STAT
           MOVE "tmp-exe" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-exe TO TOTEM-ERR-STAT
           MOVE "tmp-exe" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe, AfterDelete>
      * <TOTEM:END>
           .

       intexe-int-k-desc-MERGE-SPLITBUF.
           INITIALIZE intexe-int-k-desc-SPLITBUF
           MOVE int-desc(1:100) TO intexe-int-k-desc-SPLITBUF(1:100)
           .

       intexe-int-k-effort-MERGE-SPLITBUF.
           INITIALIZE intexe-int-k-effort-SPLITBUF
           MOVE int-effort(1:2) TO intexe-int-k-effort-SPLITBUF(1:2)
           .

       DataSet1-intexe-INITSTART.
           IF DataSet1-intexe-KEY-Asc
              MOVE Low-Value TO int-key
           ELSE
              MOVE High-Value TO int-key
           END-IF
           .

       DataSet1-intexe-INITEND.
           IF DataSet1-intexe-KEY-Asc
              MOVE High-Value TO int-key
           ELSE
              MOVE Low-Value TO int-key
           END-IF
           .

      * intexe
       DataSet1-intexe-START.
           IF DataSet1-intexe-KEY-Asc
              START intexe KEY >= int-key
           ELSE
              START intexe KEY <= int-key
           END-IF
           .

       DataSet1-intexe-START-NOTGREATER.
           IF DataSet1-intexe-KEY-Asc
              START intexe KEY <= int-key
           ELSE
              START intexe KEY >= int-key
           END-IF
           .

       DataSet1-intexe-START-GREATER.
           IF DataSet1-intexe-KEY-Asc
              START intexe KEY > int-key
           ELSE
              START intexe KEY < int-key
           END-IF
           .

       DataSet1-intexe-START-LESS.
           IF DataSet1-intexe-KEY-Asc
              START intexe KEY < int-key
           ELSE
              START intexe KEY > int-key
           END-IF
           .

       DataSet1-intexe-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-intexe-LOCK
              READ intexe WITH LOCK 
              KEY int-key
           ELSE
              READ intexe WITH NO LOCK 
              KEY int-key
           END-IF
           PERFORM intexe-int-k-desc-MERGE-SPLITBUF
           PERFORM intexe-int-k-effort-MERGE-SPLITBUF
           MOVE STATUS-intexe TO TOTEM-ERR-STAT 
           MOVE "intexe" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-intexe-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-intexe-KEY-Asc
              IF DataSet1-intexe-LOCK
                 READ intexe NEXT WITH LOCK
              ELSE
                 READ intexe NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-intexe-LOCK
                 READ intexe PREVIOUS WITH LOCK
              ELSE
                 READ intexe PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM intexe-int-k-desc-MERGE-SPLITBUF
           PERFORM intexe-int-k-effort-MERGE-SPLITBUF
           MOVE STATUS-intexe TO TOTEM-ERR-STAT
           MOVE "intexe" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-intexe-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-intexe-KEY-Asc
              IF DataSet1-intexe-LOCK
                 READ intexe PREVIOUS WITH LOCK
              ELSE
                 READ intexe PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-intexe-LOCK
                 READ intexe NEXT WITH LOCK
              ELSE
                 READ intexe NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM intexe-int-k-desc-MERGE-SPLITBUF
           PERFORM intexe-int-k-effort-MERGE-SPLITBUF
           MOVE STATUS-intexe TO TOTEM-ERR-STAT
           MOVE "intexe" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-intexe-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeWrite>
      * <TOTEM:END>
           MOVE STATUS-intexe TO TOTEM-ERR-STAT
           MOVE "intexe" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-intexe-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-intexe TO TOTEM-ERR-STAT
           MOVE "intexe" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-intexe-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-intexe TO TOTEM-ERR-STAT
           MOVE "intexe" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:intexe, AfterDelete>
      * <TOTEM:END>
           .

       tmp-exe-dupl-ted-k-num-MERGE-SPLITBUF.
           INITIALIZE tmp-exe-dupl-ted-k-num-SPLITBUF
           MOVE ted-num(1:3) TO tmp-exe-dupl-ted-k-num-SPLITBUF(1:3)
           MOVE ted-key(1:107) TO tmp-exe-dupl-ted-k-num-SPLITBUF(4:107)
           .

       DataSet1-tmp-exe-dupl-INITSTART.
           IF DataSet1-tmp-exe-dupl-KEY-Asc
              MOVE Low-Value TO ted-key
           ELSE
              MOVE High-Value TO ted-key
           END-IF
           .

       DataSet1-tmp-exe-dupl-INITEND.
           IF DataSet1-tmp-exe-dupl-KEY-Asc
              MOVE High-Value TO ted-key
           ELSE
              MOVE Low-Value TO ted-key
           END-IF
           .

      * tmp-exe-dupl
       DataSet1-tmp-exe-dupl-START.
           IF DataSet1-tmp-exe-dupl-KEY-Asc
              START tmp-exe-dupl KEY >= ted-key
           ELSE
              START tmp-exe-dupl KEY <= ted-key
           END-IF
           .

       DataSet1-tmp-exe-dupl-START-NOTGREATER.
           IF DataSet1-tmp-exe-dupl-KEY-Asc
              START tmp-exe-dupl KEY <= ted-key
           ELSE
              START tmp-exe-dupl KEY >= ted-key
           END-IF
           .

       DataSet1-tmp-exe-dupl-START-GREATER.
           IF DataSet1-tmp-exe-dupl-KEY-Asc
              START tmp-exe-dupl KEY > ted-key
           ELSE
              START tmp-exe-dupl KEY < ted-key
           END-IF
           .

       DataSet1-tmp-exe-dupl-START-LESS.
           IF DataSet1-tmp-exe-dupl-KEY-Asc
              START tmp-exe-dupl KEY < ted-key
           ELSE
              START tmp-exe-dupl KEY > ted-key
           END-IF
           .

       DataSet1-tmp-exe-dupl-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-dupl-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-dupl-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-dupl-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeWrite>
      * <TOTEM:END>
           WRITE ted-rec OF tmp-exe-dupl.
           MOVE STATUS-tmp-exe-dupl TO TOTEM-ERR-STAT
           MOVE "tmp-exe-dupl" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-dupl-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-exe-dupl TO TOTEM-ERR-STAT
           MOVE "tmp-exe-dupl" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-exe-dupl-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-exe-dupl TO TOTEM-ERR-STAT
           MOVE "tmp-exe-dupl" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-exe-dupl, AfterDelete>
      * <TOTEM:END>
           .

       zoom-exe-mcg-zem-k-int-MERGE-SPLITBUF.
           INITIALIZE zoom-exe-mcg-zem-k-int-SPLITBUF
           MOVE zem-grp-desc(1:100) TO 
           zoom-exe-mcg-zem-k-int-SPLITBUF(1:100)
           MOVE zem-int-effort(1:2) TO 
           zoom-exe-mcg-zem-k-int-SPLITBUF(101:2)
           MOVE zem-exe-desc(1:100) TO 
           zoom-exe-mcg-zem-k-int-SPLITBUF(103:100)
           .

       DataSet1-zoom-exe-mcg-INITSTART.
           IF DataSet1-zoom-exe-mcg-KEY-Asc
              MOVE Low-Value TO zem-key
           ELSE
              MOVE High-Value TO zem-key
           END-IF
           .

       DataSet1-zoom-exe-mcg-INITEND.
           IF DataSet1-zoom-exe-mcg-KEY-Asc
              MOVE High-Value TO zem-key
           ELSE
              MOVE Low-Value TO zem-key
           END-IF
           .

      * zoom-exe-mcg
       DataSet1-zoom-exe-mcg-START.
           IF DataSet1-zoom-exe-mcg-KEY-Asc
              START zoom-exe-mcg KEY >= zem-key
           ELSE
              START zoom-exe-mcg KEY <= zem-key
           END-IF
           .

       DataSet1-zoom-exe-mcg-START-NOTGREATER.
           IF DataSet1-zoom-exe-mcg-KEY-Asc
              START zoom-exe-mcg KEY <= zem-key
           ELSE
              START zoom-exe-mcg KEY >= zem-key
           END-IF
           .

       DataSet1-zoom-exe-mcg-START-GREATER.
           IF DataSet1-zoom-exe-mcg-KEY-Asc
              START zoom-exe-mcg KEY > zem-key
           ELSE
              START zoom-exe-mcg KEY < zem-key
           END-IF
           .

       DataSet1-zoom-exe-mcg-START-LESS.
           IF DataSet1-zoom-exe-mcg-KEY-Asc
              START zoom-exe-mcg KEY < zem-key
           ELSE
              START zoom-exe-mcg KEY > zem-key
           END-IF
           .

       DataSet1-zoom-exe-mcg-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-zoom-exe-mcg-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-zoom-exe-mcg-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-zoom-exe-mcg-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeWrite>
      * <TOTEM:END>
           WRITE zem-rec OF zoom-exe-mcg.
           MOVE STATUS-zoom-exe-mcg TO TOTEM-ERR-STAT
           MOVE "zoom-exe-mcg" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-exe-mcg-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-zoom-exe-mcg TO TOTEM-ERR-STAT
           MOVE "zoom-exe-mcg" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-exe-mcg-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-zoom-exe-mcg TO TOTEM-ERR-STAT
           MOVE "zoom-exe-mcg" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-exe-mcg, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmp-hit-INITSTART.
           IF DataSet1-tmp-hit-KEY-Asc
              MOVE Low-Value TO th-key
           ELSE
              MOVE High-Value TO th-key
           END-IF
           .

       DataSet1-tmp-hit-INITEND.
           IF DataSet1-tmp-hit-KEY-Asc
              MOVE High-Value TO th-key
           ELSE
              MOVE Low-Value TO th-key
           END-IF
           .

      * tmp-hit
       DataSet1-tmp-hit-START.
           IF DataSet1-tmp-hit-KEY-Asc
              START tmp-hit KEY >= th-key
           ELSE
              START tmp-hit KEY <= th-key
           END-IF
           .

       DataSet1-tmp-hit-START-NOTGREATER.
           IF DataSet1-tmp-hit-KEY-Asc
              START tmp-hit KEY <= th-key
           ELSE
              START tmp-hit KEY >= th-key
           END-IF
           .

       DataSet1-tmp-hit-START-GREATER.
           IF DataSet1-tmp-hit-KEY-Asc
              START tmp-hit KEY > th-key
           ELSE
              START tmp-hit KEY < th-key
           END-IF
           .

       DataSet1-tmp-hit-START-LESS.
           IF DataSet1-tmp-hit-KEY-Asc
              START tmp-hit KEY < th-key
           ELSE
              START tmp-hit KEY > th-key
           END-IF
           .

       DataSet1-tmp-hit-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-hit-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-hit-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-hit-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeWrite>
      * <TOTEM:END>
           WRITE th-rec OF tmp-hit.
           MOVE STATUS-tmp-hit TO TOTEM-ERR-STAT
           MOVE "tmp-hit" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-hit-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-hit TO TOTEM-ERR-STAT
           MOVE "tmp-hit" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-hit-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-hit TO TOTEM-ERR-STAT
           MOVE "tmp-hit" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-hit, AfterDelete>
      * <TOTEM:END>
           .

       tmp-grp-exe-tge-k-prg-MERGE-SPLITBUF.
           INITIALIZE tmp-grp-exe-tge-k-prg-SPLITBUF
           MOVE tge-prg OF tge-data OF tge-rec(1:3) TO 
           tmp-grp-exe-tge-k-prg-SPLITBUF(1:3)
           .

       DataSet1-tmp-grp-exe-INITSTART.
           IF DataSet1-tmp-grp-exe-KEY-Asc
              MOVE Low-Value TO tge-key
           ELSE
              MOVE High-Value TO tge-key
           END-IF
           .

       DataSet1-tmp-grp-exe-INITEND.
           IF DataSet1-tmp-grp-exe-KEY-Asc
              MOVE High-Value TO tge-key
           ELSE
              MOVE Low-Value TO tge-key
           END-IF
           .

      * tmp-grp-exe
       DataSet1-tmp-grp-exe-START.
           IF DataSet1-tmp-grp-exe-KEY-Asc
              START tmp-grp-exe KEY >= tge-key
           ELSE
              START tmp-grp-exe KEY <= tge-key
           END-IF
           .

       DataSet1-tmp-grp-exe-START-NOTGREATER.
           IF DataSet1-tmp-grp-exe-KEY-Asc
              START tmp-grp-exe KEY <= tge-key
           ELSE
              START tmp-grp-exe KEY >= tge-key
           END-IF
           .

       DataSet1-tmp-grp-exe-START-GREATER.
           IF DataSet1-tmp-grp-exe-KEY-Asc
              START tmp-grp-exe KEY > tge-key
           ELSE
              START tmp-grp-exe KEY < tge-key
           END-IF
           .

       DataSet1-tmp-grp-exe-START-LESS.
           IF DataSet1-tmp-grp-exe-KEY-Asc
              START tmp-grp-exe KEY < tge-key
           ELSE
              START tmp-grp-exe KEY > tge-key
           END-IF
           .

       DataSet1-tmp-grp-exe-START-EQUAL.
           START tmp-grp-exe KEY = tge-key
           .

       DataSet1-tmp-grp-exe-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-grp-exe-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-grp-exe-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-grp-exe-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeWrite>
      * <TOTEM:END>
           WRITE tge-rec OF tmp-grp-exe.
           MOVE STATUS-tmp-grp-exe TO TOTEM-ERR-STAT
           MOVE "tmp-grp-exe" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-grp-exe-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-grp-exe TO TOTEM-ERR-STAT
           MOVE "tmp-grp-exe" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-grp-exe-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-grp-exe TO TOTEM-ERR-STAT
           MOVE "tmp-grp-exe" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-grp-exe, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-tmp-superset-INITSTART.
           IF DataSet1-tmp-superset-KEY-Asc
              MOVE Low-Value TO tss-key
           ELSE
              MOVE High-Value TO tss-key
           END-IF
           .

       DataSet1-tmp-superset-INITEND.
           IF DataSet1-tmp-superset-KEY-Asc
              MOVE High-Value TO tss-key
           ELSE
              MOVE Low-Value TO tss-key
           END-IF
           .

      * tmp-superset
       DataSet1-tmp-superset-START.
           IF DataSet1-tmp-superset-KEY-Asc
              START tmp-superset KEY >= tss-key
           ELSE
              START tmp-superset KEY <= tss-key
           END-IF
           .

       DataSet1-tmp-superset-START-NOTGREATER.
           IF DataSet1-tmp-superset-KEY-Asc
              START tmp-superset KEY <= tss-key
           ELSE
              START tmp-superset KEY >= tss-key
           END-IF
           .

       DataSet1-tmp-superset-START-GREATER.
           IF DataSet1-tmp-superset-KEY-Asc
              START tmp-superset KEY > tss-key
           ELSE
              START tmp-superset KEY < tss-key
           END-IF
           .

       DataSet1-tmp-superset-START-LESS.
           IF DataSet1-tmp-superset-KEY-Asc
              START tmp-superset KEY < tss-key
           ELSE
              START tmp-superset KEY > tss-key
           END-IF
           .

       DataSet1-tmp-superset-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-tmp-superset-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-tmp-superset-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-tmp-superset-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeWrite>
      * <TOTEM:END>
           WRITE tss-rec OF tmp-superset.
           MOVE STATUS-tmp-superset TO TOTEM-ERR-STAT
           MOVE "tmp-superset" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-superset-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-tmp-superset TO TOTEM-ERR-STAT
           MOVE "tmp-superset" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-tmp-superset-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-tmp-superset TO TOTEM-ERR-STAT
           MOVE "tmp-superset" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:tmp-superset, AfterDelete>
      * <TOTEM:END>
           .

       zoom-wodbook-key01-MERGE-SPLITBUF.
           INITIALIZE zoom-wodbook-key01-SPLITBUF
           MOVE zwod-desc(1:100) TO zoom-wodbook-key01-SPLITBUF(1:100)
           MOVE zwod-code(1:18) TO zoom-wodbook-key01-SPLITBUF(101:18)
           .

       zoom-wodbook-key02-MERGE-SPLITBUF.
           INITIALIZE zoom-wodbook-key02-SPLITBUF
           MOVE zwod-creation(1:8) TO zoom-wodbook-key02-SPLITBUF(1:8)
           MOVE zwod-desc(1:100) TO zoom-wodbook-key02-SPLITBUF(9:100)
           .

       zoom-wodbook-key03-MERGE-SPLITBUF.
           INITIALIZE zoom-wodbook-key03-SPLITBUF
           MOVE zwod-ini(1:8) TO zoom-wodbook-key03-SPLITBUF(1:8)
           MOVE zwod-desc(1:100) TO zoom-wodbook-key03-SPLITBUF(9:100)
           .

       DataSet1-zoom-wodbook-INITSTART.
           IF DataSet1-zoom-wodbook-KEY-Asc
              MOVE Low-Value TO zwod-key
           ELSE
              MOVE High-Value TO zwod-key
           END-IF
           .

       DataSet1-zoom-wodbook-INITEND.
           IF DataSet1-zoom-wodbook-KEY-Asc
              MOVE High-Value TO zwod-key
           ELSE
              MOVE Low-Value TO zwod-key
           END-IF
           .

      * zoom-wodbook
       DataSet1-zoom-wodbook-START.
           IF DataSet1-zoom-wodbook-KEY-Asc
              START zoom-wodbook KEY >= zwod-key
           ELSE
              START zoom-wodbook KEY <= zwod-key
           END-IF
           .

       DataSet1-zoom-wodbook-START-NOTGREATER.
           IF DataSet1-zoom-wodbook-KEY-Asc
              START zoom-wodbook KEY <= zwod-key
           ELSE
              START zoom-wodbook KEY >= zwod-key
           END-IF
           .

       DataSet1-zoom-wodbook-START-GREATER.
           IF DataSet1-zoom-wodbook-KEY-Asc
              START zoom-wodbook KEY > zwod-key
           ELSE
              START zoom-wodbook KEY < zwod-key
           END-IF
           .

       DataSet1-zoom-wodbook-START-LESS.
           IF DataSet1-zoom-wodbook-KEY-Asc
              START zoom-wodbook KEY < zwod-key
           ELSE
              START zoom-wodbook KEY > zwod-key
           END-IF
           .

       DataSet1-zoom-wodbook-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeReadRecord>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-zoom-wodbook-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeReadNext>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-zoom-wodbook-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeReadPrev>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-zoom-wodbook-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeWrite>
      * <TOTEM:END>
           WRITE zwod-rec OF zoom-wodbook.
           MOVE STATUS-zoom-wodbook TO TOTEM-ERR-STAT
           MOVE "zoom-wodbook" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-wodbook-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeRewrite>
      * <TOTEM:END>
           MOVE STATUS-zoom-wodbook TO TOTEM-ERR-STAT
           MOVE "zoom-wodbook" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-zoom-wodbook-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, BeforeDelete>
      * <TOTEM:END>
           MOVE STATUS-zoom-wodbook TO TOTEM-ERR-STAT
           MOVE "zoom-wodbook" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:zoom-wodbook, AfterDelete>
      * <TOTEM:END>
           .

       rwodbook-rod-k-day-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-day-SPLITBUF
           MOVE rod-day(1:8) TO rwodbook-rod-k-day-SPLITBUF(1:8)
           MOVE rod-split(1:2) TO rwodbook-rod-k-day-SPLITBUF(9:2)
           MOVE rod-code(1:18) TO rwodbook-rod-k-day-SPLITBUF(11:18)
           .

       rwodbook-rod-k-prg-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-prg-SPLITBUF
           MOVE rod-key(1:28) TO rwodbook-rod-k-prg-SPLITBUF(1:28)
           MOVE rod-prg-day(1:1) TO rwodbook-rod-k-prg-SPLITBUF(29:1)
           .

       rwodbook-rod-k-mcg-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-mcg-SPLITBUF
           MOVE rod-mcg-code(1:5) TO rwodbook-rod-k-mcg-SPLITBUF(1:5)
           MOVE rod-key(1:28) TO rwodbook-rod-k-mcg-SPLITBUF(6:28)
           .

       rwodbook-rod-k-exe-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-exe-SPLITBUF
           MOVE rod-exe-code(1:5) TO rwodbook-rod-k-exe-SPLITBUF(1:5)
           MOVE rod-key(1:28) TO rwodbook-rod-k-exe-SPLITBUF(6:28)
           .

       rwodbook-rod-k-multi-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-multi-SPLITBUF
           MOVE rod-exe-isMulti(1:1) TO 
           rwodbook-rod-k-multi-SPLITBUF(1:1)
           MOVE rod-mcg-code(1:5) TO rwodbook-rod-k-multi-SPLITBUF(2:5)
           MOVE rod-key(1:28) TO rwodbook-rod-k-multi-SPLITBUF(7:28)
           .

       rwodbook-rod-k-rp-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-rp-SPLITBUF
           MOVE rod-int-restpause(1:1) TO 
           rwodbook-rod-k-rp-SPLITBUF(1:1)
           MOVE rod-mcg-code(1:5) TO rwodbook-rod-k-rp-SPLITBUF(2:5)
           MOVE rod-key(1:28) TO rwodbook-rod-k-rp-SPLITBUF(7:28)
           .

       rwodbook-rod-k-ss-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-ss-SPLITBUF
           MOVE rod-ss(1:1) TO rwodbook-rod-k-ss-SPLITBUF(1:1)
           MOVE rod-mcg-code(1:5) TO rwodbook-rod-k-ss-SPLITBUF(2:5)
           MOVE rod-key(1:28) TO rwodbook-rod-k-ss-SPLITBUF(7:28)
           .

       rwodbook-rod-k-confronto-MERGE-SPLITBUF.
           INITIALIZE rwodbook-rod-k-confronto-SPLITBUF
           MOVE rod-exe-code(1:5) TO 
           rwodbook-rod-k-confronto-SPLITBUF(1:5)
           MOVE rod-int-code(1:2) TO 
           rwodbook-rod-k-confronto-SPLITBUF(6:2)
           MOVE rod-day(1:8) TO rwodbook-rod-k-confronto-SPLITBUF(8:8)
           .

       DataSet1-rwodbook-INITSTART.
           IF DataSet1-rwodbook-KEY-Asc
              MOVE Low-Value TO rod-key
           ELSE
              MOVE High-Value TO rod-key
           END-IF
           .

       DataSet1-rwodbook-INITEND.
           IF DataSet1-rwodbook-KEY-Asc
              MOVE High-Value TO rod-key
           ELSE
              MOVE Low-Value TO rod-key
           END-IF
           .

      * rwodbook
       DataSet1-rwodbook-START.
           IF DataSet1-rwodbook-KEY-Asc
              START rwodbook KEY >= rod-key
           ELSE
              START rwodbook KEY <= rod-key
           END-IF
           .

       DataSet1-rwodbook-START-NOTGREATER.
           IF DataSet1-rwodbook-KEY-Asc
              START rwodbook KEY <= rod-key
           ELSE
              START rwodbook KEY >= rod-key
           END-IF
           .

       DataSet1-rwodbook-START-GREATER.
           IF DataSet1-rwodbook-KEY-Asc
              START rwodbook KEY > rod-key
           ELSE
              START rwodbook KEY < rod-key
           END-IF
           .

       DataSet1-rwodbook-START-LESS.
           IF DataSet1-rwodbook-KEY-Asc
              START rwodbook KEY < rod-key
           ELSE
              START rwodbook KEY > rod-key
           END-IF
           .

       DataSet1-rwodbook-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeReadRecord>
      * <TOTEM:END>
           IF DataSet1-rwodbook-LOCK
              READ rwodbook WITH LOCK 
              KEY rod-key
           ELSE
              READ rwodbook WITH NO LOCK 
              KEY rod-key
           END-IF
           PERFORM rwodbook-rod-k-day-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-prg-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-mcg-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-exe-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-multi-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-rp-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-ss-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-confronto-MERGE-SPLITBUF
           MOVE STATUS-rwodbook TO TOTEM-ERR-STAT 
           MOVE "rwodbook" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-rwodbook-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeReadNext>
      * <TOTEM:END>
           IF DataSet1-rwodbook-KEY-Asc
              IF DataSet1-rwodbook-LOCK
                 READ rwodbook NEXT WITH LOCK
              ELSE
                 READ rwodbook NEXT WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rwodbook-LOCK
                 READ rwodbook PREVIOUS WITH LOCK
              ELSE
                 READ rwodbook PREVIOUS WITH NO LOCK
              END-IF
           END-IF
           PERFORM rwodbook-rod-k-day-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-prg-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-mcg-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-exe-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-multi-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-rp-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-ss-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-confronto-MERGE-SPLITBUF
           MOVE STATUS-rwodbook TO TOTEM-ERR-STAT
           MOVE "rwodbook" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-rwodbook-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeReadPrev>
      * <TOTEM:END>
           IF DataSet1-rwodbook-KEY-Asc
              IF DataSet1-rwodbook-LOCK
                 READ rwodbook PREVIOUS WITH LOCK
              ELSE
                 READ rwodbook PREVIOUS WITH NO LOCK
              END-IF
           ELSE
              IF DataSet1-rwodbook-LOCK
                 READ rwodbook NEXT WITH LOCK
              ELSE
                 READ rwodbook NEXT WITH NO LOCK
              END-IF
           END-IF
           PERFORM rwodbook-rod-k-day-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-prg-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-mcg-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-exe-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-multi-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-rp-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-ss-MERGE-SPLITBUF
           PERFORM rwodbook-rod-k-confronto-MERGE-SPLITBUF
           MOVE STATUS-rwodbook TO TOTEM-ERR-STAT
           MOVE "rwodbook" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-rwodbook-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeWrite>
      * <TOTEM:END>
           WRITE rod-rec OF rwodbook.
           MOVE STATUS-rwodbook TO TOTEM-ERR-STAT
           MOVE "rwodbook" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-rwodbook-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeRewrite>
      * <TOTEM:END>
           REWRITE rod-rec OF rwodbook.
           MOVE STATUS-rwodbook TO TOTEM-ERR-STAT
           MOVE "rwodbook" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-rwodbook-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, BeforeDelete>
      * <TOTEM:END>
           DELETE rwodbook.
           MOVE STATUS-rwodbook TO TOTEM-ERR-STAT
           MOVE "rwodbook" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:rwodbook, AfterDelete>
      * <TOTEM:END>
           .

       twodbook-tod-k-creazione-MERGE-SPLITBUF.
           INITIALIZE twodbook-tod-k-creazione-SPLITBUF
           MOVE tod-data-creazione(1:8) TO 
           twodbook-tod-k-creazione-SPLITBUF(1:8)
           MOVE tod-key(1:18) TO twodbook-tod-k-creazione-SPLITBUF(9:18)
           .

       twodbook-tod-k-wom-MERGE-SPLITBUF.
           INITIALIZE twodbook-tod-k-wom-SPLITBUF
           MOVE tod-wom-code(1:3) TO twodbook-tod-k-wom-SPLITBUF(1:3)
           MOVE tod-key(1:18) TO twodbook-tod-k-wom-SPLITBUF(4:18)
           .

       twodbook-tod-k-desc-MERGE-SPLITBUF.
           INITIALIZE twodbook-tod-k-desc-SPLITBUF
           MOVE tod-desc(1:100) TO twodbook-tod-k-desc-SPLITBUF(1:100)
           MOVE tod-key(1:18) TO twodbook-tod-k-desc-SPLITBUF(101:18)
           .

       twodbook-tod-k-ini-MERGE-SPLITBUF.
           INITIALIZE twodbook-tod-k-ini-SPLITBUF
           MOVE tod-day-ini(1:8) TO twodbook-tod-k-ini-SPLITBUF(1:8)
           MOVE tod-key(1:18) TO twodbook-tod-k-ini-SPLITBUF(9:18)
           .

       twodbook-tod-k-eff-MERGE-SPLITBUF.
           INITIALIZE twodbook-tod-k-eff-SPLITBUF
           MOVE tod-wom-effort(1:2) TO twodbook-tod-k-eff-SPLITBUF(1:2)
           MOVE tod-key(1:18) TO twodbook-tod-k-eff-SPLITBUF(3:18)
           .

       twodbook-tod-k-dur-MERGE-SPLITBUF.
           INITIALIZE twodbook-tod-k-dur-SPLITBUF
           MOVE tod-dur-code(1:2) TO twodbook-tod-k-dur-SPLITBUF(1:2)
           MOVE tod-key(1:18) TO twodbook-tod-k-dur-SPLITBUF(3:18)
           .

       DataSet1-twodbook-INITSTART.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 MOVE Low-Value TO tod-key
              ELSE
                 MOVE High-Value TO tod-key
              END-IF
           END-EVALUATE
           .

       DataSet1-twodbook-INITEND.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 MOVE High-Value TO tod-key
              ELSE
                 MOVE Low-Value TO tod-key
              END-IF
           END-EVALUATE
           .

       DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           .   

       DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-twodbook-KEY1-ORDER
           END-EVALUATE
           .

       DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-twodbook-KEY1-ORDER
           END-EVALUATE
           .

      * twodbook
       DataSet1-twodbook-START.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 START twodbook KEY >= tod-key
              ELSE
                 START twodbook KEY <= tod-key
              END-IF
           END-EVALUATE
           .

       DataSet1-twodbook-START-NOTGREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 START twodbook KEY <= tod-key
              ELSE
                 START twodbook KEY >= tod-key
              END-IF
           END-EVALUATE
           .

       DataSet1-twodbook-START-GREATER.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 START twodbook KEY > tod-key
              ELSE
                 START twodbook KEY < tod-key
              END-IF
           END-EVALUATE
           .

       DataSet1-twodbook-START-LESS.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 START twodbook KEY < tod-key
              ELSE
                 START twodbook KEY > tod-key
              END-IF
           END-EVALUATE
           .

       DataSet1-twodbook-Read.
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeReadRecord>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-LOCK
                 READ twodbook WITH LOCK 
                 KEY tod-key
              ELSE
                 READ twodbook WITH NO LOCK 
                 KEY tod-key
              END-IF
           END-EVALUATE
           PERFORM twodbook-tod-k-creazione-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-wom-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-desc-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-ini-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-eff-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-dur-MERGE-SPLITBUF
           MOVE STATUS-twodbook TO TOTEM-ERR-STAT 
           MOVE "twodbook" TO TOTEM-ERR-FILE
           MOVE "READ" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterReadRecord>
      * <TOTEM:END>
           .

       DataSet1-twodbook-Read-Next.
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeReadNext>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 IF DataSet1-twodbook-LOCK
                    READ twodbook NEXT WITH LOCK
                 ELSE
                    READ twodbook NEXT WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-twodbook-LOCK
                    READ twodbook PREVIOUS WITH LOCK
                 ELSE
                    READ twodbook PREVIOUS WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM twodbook-tod-k-creazione-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-wom-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-desc-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-ini-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-eff-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-dur-MERGE-SPLITBUF
           MOVE STATUS-twodbook TO TOTEM-ERR-STAT
           MOVE "twodbook" TO TOTEM-ERR-FILE
           MOVE "READ NEXT" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterReadNext>
      * <TOTEM:END>
           .

       DataSet1-twodbook-Read-Prev.
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeReadPrev>
      * <TOTEM:END>
           EVALUATE DataSet1-KEYIS
           WHEN 1
              IF DataSet1-twodbook-KEY1-Asc
                 IF DataSet1-twodbook-LOCK
                    READ twodbook PREVIOUS WITH LOCK
                 ELSE
                    READ twodbook PREVIOUS WITH NO LOCK
                 END-IF
              ELSE
                 IF DataSet1-twodbook-LOCK
                    READ twodbook NEXT WITH LOCK
                 ELSE
                    READ twodbook NEXT WITH NO LOCK
                 END-IF
              END-IF
           END-EVALUATE
           PERFORM twodbook-tod-k-creazione-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-wom-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-desc-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-ini-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-eff-MERGE-SPLITBUF
           PERFORM twodbook-tod-k-dur-MERGE-SPLITBUF
           MOVE STATUS-twodbook TO TOTEM-ERR-STAT
           MOVE "twodbook" TO TOTEM-ERR-FILE
           MOVE "READ PREVIOUS" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterRead>
      * <TOTEM:END>
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterReadPrev>
      * <TOTEM:END>
           .

       DataSet1-twodbook-Rec-Write.
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeWrite>
      * <TOTEM:END>
           WRITE tod-rec OF twodbook.
           MOVE STATUS-twodbook TO TOTEM-ERR-STAT
           MOVE "twodbook" TO TOTEM-ERR-FILE
           MOVE "WRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterWrite>
      * <TOTEM:END>
           .

       DataSet1-twodbook-Rec-Rewrite.
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeRewrite>
      * <TOTEM:END>
           REWRITE tod-rec OF twodbook.
           MOVE STATUS-twodbook TO TOTEM-ERR-STAT
           MOVE "twodbook" TO TOTEM-ERR-FILE
           MOVE "REWRITE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterRewrite>
      * <TOTEM:END>
           .

       DataSet1-twodbook-Rec-Delete.
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, BeforeDelete>
      * <TOTEM:END>
           DELETE twodbook.
           MOVE STATUS-twodbook TO TOTEM-ERR-STAT
           MOVE "twodbook" TO TOTEM-ERR-FILE
           MOVE "DELETE" TO TOTEM-ERR-MODE
      * <TOTEM:EPT. FD:DataSet1, FD:twodbook, AfterDelete>
      * <TOTEM:END>
           .

       DataSet1-INIT-RECORD.
           INITIALIZE exe-rec OF exercises
           INITIALIZE grp-rec OF groups
           INITIALIZE mcg-rec OF macrogroups
           INITIALIZE dur-rec OF duration
           INITIALIZE tee-rec OF tmp-exe-effort
           INITIALIZE wom-rec OF wodmap
           INITIALIZE twe-rec OF tmp-wod-exe
           INITIALIZE tex-rec OF tmp-exe
           INITIALIZE int-rec OF intexe
           INITIALIZE ted-rec OF tmp-exe-dupl
           INITIALIZE zem-rec OF zoom-exe-mcg
           INITIALIZE th-rec OF tmp-hit
           INITIALIZE tge-rec OF tmp-grp-exe
           INITIALIZE tss-rec OF tmp-superset
           INITIALIZE zwod-rec OF zoom-wodbook
           INITIALIZE rod-rec OF rwodbook
           INITIALIZE tod-rec OF twodbook
           .


      * COMBO-BOX
       cb-mg1-Content.
           .

      * COMBO-BOX
       cb-mg2-Content.
           .

      * COMBO-BOX
       cb-mg3-Content.
           .

      * COMBO-BOX
       cb-mg4-Content.
           .

      * COMBO-BOX
       cb-mg5-Content.
           .

      * COMBO-BOX
       cb-mg6-Content.
           .

      * COMBO-BOX
       cb-mg7-Content.
           .

      * COMBO-BOX
       cb-mul-Content.
           .

      * COMBO-BOX
       cb-int-Content.
           .

      * COMBO-BOX
       cb-dur-Content.
           .

      * COMBO-BOX
       cb-gio-Content.
           .

      * COMBO-BOX
       cb-wod-Content.
           .

      * GRID
       gd1-Content.
      * CELLS' SETTING
              MODIFY gd1, X = 1, Y = 1,
                CELL-DATA = "D",
      * CELLS' SETTING
              MODIFY gd1, X = 2, Y = 1,
                CELL-DATA = "#",
      * CELLS' SETTING
              MODIFY gd1, X = 3, Y = 1,
                CELL-DATA = "Gruppo",
      * CELLS' SETTING
              MODIFY gd1, X = 4, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd1, X = 5, Y = 1,
                CELL-DATA = "Ex",
      * CELLS' SETTING
              MODIFY gd1, X = 6, Y = 1,
                CELL-DATA = "Descrizione",
      * CELLS' SETTING
              MODIFY gd1, X = 7, Y = 1,
                CELL-DATA = "Series",
      * CELLS' SETTING
              MODIFY gd1, X = 8, Y = 1,
                CELL-DATA = "Reps",
      * CELLS' SETTING
              MODIFY gd1, X = 9, Y = 1,
                CELL-DATA = "Superset",
           .

      * GRID
       gd-schema-Content.
      * CELLS' SETTING
              MODIFY gd-schema, X = 1, Y = 1,
                CELL-DATA = "Day",
      * CELLS' SETTING
              MODIFY gd-schema, X = 2, Y = 1,
                CELL-DATA = "#1",
      * CELLS' SETTING
              MODIFY gd-schema, X = 3, Y = 1,
                CELL-DATA = "#2",
      * CELLS' SETTING
              MODIFY gd-schema, X = 4, Y = 1,
                CELL-DATA = "#3",
      * CELLS' SETTING
              MODIFY gd-schema, X = 5, Y = 1,
                CELL-DATA = "#4",
      * CELLS' SETTING
              MODIFY gd-schema, X = 6, Y = 1,
                CELL-DATA = "#5",
      * CELLS' SETTING
              MODIFY gd-schema, X = 7, Y = 1,
                CELL-DATA = "#6",
      * CELLS' SETTING
              MODIFY gd-schema, X = 8, Y = 1,
                CELL-DATA = "#7",
      * CELLS' SETTING
              MODIFY gd-schema, X = 9, Y = 1,
                CELL-DATA = "#8",
      * CELLS' SETTING
              MODIFY gd-schema, X = 10, Y = 1,
                CELL-DATA = "#9",
      * CELLS' SETTING
              MODIFY gd-schema, X = 11, Y = 1,
                CELL-DATA = "#10",
      * CELLS' SETTING
              MODIFY gd-schema, X = 12, Y = 1,
                CELL-DATA = "Durata stimata",
           .

      * COMBO-BOX
       cb-eff-Content.
           .

      * FD's Initialize Paragraph
       DataSet1-exercises-INITREC.
           INITIALIZE exe-rec OF exercises
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-groups-INITREC.
           INITIALIZE grp-rec OF groups
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-macrogroups-INITREC.
           INITIALIZE mcg-rec OF macrogroups
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-duration-INITREC.
           INITIALIZE dur-rec OF duration
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-exe-effort-INITREC.
           INITIALIZE tee-rec OF tmp-exe-effort
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-wodmap-INITREC.
           INITIALIZE wom-rec OF wodmap
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-wod-exe-INITREC.
           INITIALIZE twe-rec OF tmp-wod-exe
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-exe-INITREC.
           INITIALIZE tex-rec OF tmp-exe
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-intexe-INITREC.
           INITIALIZE int-rec OF intexe
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-exe-dupl-INITREC.
           INITIALIZE ted-rec OF tmp-exe-dupl
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-zoom-exe-mcg-INITREC.
           INITIALIZE zem-rec OF zoom-exe-mcg
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-hit-INITREC.
           INITIALIZE th-rec OF tmp-hit
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-grp-exe-INITREC.
           INITIALIZE tge-rec OF tmp-grp-exe
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-tmp-superset-INITREC.
           INITIALIZE tss-rec OF tmp-superset
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-zoom-wodbook-INITREC.
           INITIALIZE zwod-rec OF zoom-wodbook
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-rwodbook-INITREC.
           INITIALIZE rod-rec OF rwodbook
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      * FD's Initialize Paragraph
       DataSet1-twodbook-INITREC.
           INITIALIZE tod-rec OF twodbook
               REPLACING NUMERIC       DATA BY ZEROS
                         ALPHANUMERIC  DATA BY SPACES
                         ALPHABETIC    DATA BY SPACES
           .

      *
       DataSet1-DISPATCH-BUFTOFLD.
           EVALUATE TOTEM-Form-Index ALSO TOTEM-Frame-Index
              WHEN 1 ALSO 0
                  PERFORM Form1-Buf-To-Fld
           END-EVALUATE
           .

       Form1-DISPLAY-STATUS-MSG.
            MODIFY Form1-St-1-Handle PANEL-INDEX = 1
                PANEL-TEXT = TOTEM-HINT-TEXT
           .

       Form1-CLEAR-STATUS-MSG.
           MOVE SPACES TO TOTEM-MSG-1, TOTEM-MSG-2, TOTEM-MSG-3, 
           TOTEM-MSG-TEXT
           PERFORM Form1-DISPLAY-STATUS-MSG
           .

       Form1-Open-Routine.
           PERFORM Form1-Scrn
           PERFORM Form1-Proc
           .

       Form1-Scrn.
           PERFORM Form1-Create-Win
           PERFORM Form1-Init-Value
           PERFORM Form1-Init-Data
      * Tab keystrok settings
      * Tool Bar
           DISPLAY Form1-Tb-1
           PERFORM Form1-DISPLAY
           .

       Form1-Create-Win.
           Display Independent GRAPHICAL WINDOW
              SCREEN LINE 2,
              SCREEN COLUMN 2,
              LINES 38,39,
              SIZE 156,80,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 131329,
              CONTROL FONT Calibri14-Occidentale,
              LABEL-OFFSET 23,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              TITLE-BAR,
              TITLE titolo,
              AUTO-MINIMIZE,
              WITH SYSTEM MENU,
              USER-GRAY,
           VISIBLE v-form1,
              USER-WHITE,
              No WRAP,
              EVENT PROCEDURE Screen1-Event-Proc,
              HANDLE IS form1-Handle,
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
           DISPLAY TOOL-BAR 
              LINES 3,30,   
              CONTROL FONT IS Calibri14-Occidentale
              HANDLE IN Form1-Tb-1-Handle
           DISPLAY Form1-Tb-1 UPON Form1-Tb-1-Handle

      * Status-bar
           DISPLAY STATUS-BAR
              FONT IS Calibri14-Occidentale,
              GRIP,
              PANEL-WIDTHS (130, 28),
              PANEL-STYLE  (1, 1),
              PANEL-TEXT   (SPACE, SPACE),
              HANDLE IS Form1-St-1-Handle
           DISPLAY Form1 UPON form1-Handle
      * DISPLAY-COLUMNS settings
              MODIFY gd1, DISPLAY-COLUMNS (1, 6, 9, 16, 36, 43, 73, 78, 
           91)
              MODIFY gd-schema, DISPLAY-COLUMNS (1, 6, 13, 20, 27, 34, 
           41, 48, 55, 62, 69, 76)
           .

       Form1-PROC.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAccept>
           if chiamata-lookup
              perform SELEZIONA
              move tod-code to lnk-code
              move 27 to key-status
           end-if.
           perform INIT.
           perform ABILITA-TOOLBAR.
           perform ABILITAZIONI.
           perform STATUS-BAR-MSG.
           display form1.
                                                  
           modify cb-mg1, item-to-add = "Nessuno".
           modify cb-mg2, item-to-add = "Nessuno".
           modify cb-mg3, item-to-add = "Nessuno".
           modify cb-mg4, item-to-add = "Nessuno". 
           modify cb-mg5, item-to-add = "Nessuno".
           modify cb-mg6, item-to-add = "Nessuno".
           modify cb-mg7, item-to-add = "Nessuno".

           modify cb-mul, item-to-add = "No".
           modify cb-mul, item-to-add = "Si".     
                                                   
           modify cb-int, item-to-add = "Tutto".
           modify cb-dur, item-to-add = "Tutto".
           modify cb-wod, item-to-add = "Nessuno".
                                           
           modify cb-gio, item-to-add = "Tutto".
           modify cb-gio, item-to-add = "1".
           modify cb-gio, item-to-add = "2".
           modify cb-gio, item-to-add = "3".
           modify cb-gio, item-to-add = "4".
           modify cb-gio, item-to-add = "5".

           move low-value to mcg-desc.
           start macrogroups key >= mcg-k-desc
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read macrogroups next at end exit perform end-read
                                                   
                    modify cb-mg1, item-to-add = mcg-desc
                    modify cb-mg2, item-to-add = mcg-desc
                    modify cb-mg3, item-to-add = mcg-desc
                    modify cb-mg4, item-to-add = mcg-desc
                    modify cb-mg5, item-to-add = mcg-desc
                    modify cb-mg6, item-to-add = mcg-desc
                    modify cb-mg7, item-to-add = mcg-desc
                                      
                    if mcg-isPrimary = 1             
                       add 1         to tot-mcg-p
                       move mcg-desc to el-mcg-desc-p(tot-mcg-p)
                    else                           
                       add 1         to tot-mcg
                       move mcg-desc to el-mcg-desc(tot-mcg)
                    end-if
                 end-perform
           end-start. 
           move low-value to dur-rec.
           start duration key >= dur-k-desc
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read duration next at end exit perform end-read
                    modify cb-dur, item-to-add = dur-desc
                 end-perform
           end-start.               

           modify cb-int, item-to-add "Light wod effort".
           modify cb-int, item-to-add "Medium wod effort".
           modify cb-int, item-to-add "Heavy wod effort".

           perform DATI-DEFAULT.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT Form1
                 ON EXCEPTION
                    PERFORM Form1-Evaluate-Func
                 MOVE 1 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterEndAccept>
           evaluate true
           when ApriLookup
                set ApriLookup to false            
                perform X-Y
                inquire gd1(riga, 78-col-exe-code), 
                        cell-data in exe-code
                inquire gd1(riga, 78-col-grp-code), 
                        cell-data in grp-code
                perform LOOKUP-EXE
           end-evaluate

      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY form1-Handle
           INITIALIZE Key-Status
           .

       Form1-Evaluate-Func.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM Form1-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM Form1-Exit
                 END-IF
              WHEN Key-Status = 1005
                 PERFORM pb-mcg1-LinkTo
              WHEN Key-Status = 1006
                 PERFORM pb-mcg2-LinkTo
              WHEN Key-Status = 1011
                 PERFORM pb-mcg3-LinkTo
              WHEN Key-Status = 1010
                 PERFORM pb-mcg4-LinkTo
              WHEN Key-Status = 1009
                 PERFORM pb-mcg5-LinkTo
              WHEN Key-Status = 1008
                 PERFORM pb-mcg6-LinkTo
              WHEN Key-Status = 1007
                 PERFORM pb-mcg7-LinkTo
              WHEN Key-Status = 1000
                 PERFORM pb-genera-LinkTo
              WHEN Key-Status = 1002
                 PERFORM pb-random-LinkTo
              WHEN Key-Status = 1012
                 PERFORM pb-aggiungi-LinkTo
              WHEN Key-Status = 1004
                 PERFORM pb-elimina-LinkTo
              WHEN Key-Status = 1001
                 PERFORM pb-su-LinkTo
              WHEN Key-Status = 1003
                 PERFORM pb-giu-LinkTo
              WHEN Key-Status = 1013
                 PERFORM pb-int-LinkTo
              WHEN Key-Status = 1015
                 PERFORM pb-mod-LinkTo
              WHEN Key-Status = 1014
                 PERFORM pb-ripristino-LinkTo
              WHEN Key-Status = 2
                 PERFORM NUOVO-LinkTo
              WHEN Key-Status = 3
                 PERFORM TOOL-SALVA-LinkTo
              WHEN Key-Status = 6
                 PERFORM ANTEPRIMA-LinkTo
              WHEN Key-Status = 7
                 PERFORM STAMPA-LinkTo
              WHEN Key-Status = 8
                 PERFORM TOOL-CERCA-LinkTo
              WHEN Key-Status = 9
                 PERFORM TOOL-SELEZIONA-LinkTo
              WHEN Key-Status = 4
                 PERFORM CANCELLA-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       Form1-CLEAR.
           PERFORM Form1-INIT-VALUE
           PERFORM Form1-DISPLAY
           .

       Form1-DISPLAY.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY Form1-Tb-1
           DISPLAY Form1 UPON form1-Handle
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       Form1-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       Form1-Init-Data.
           MOVE 1 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * COMBO-BOX
           PERFORM cb-mg1-Content
      * COMBO-BOX
           PERFORM cb-mg2-Content
      * COMBO-BOX
           PERFORM cb-mg3-Content
      * COMBO-BOX
           PERFORM cb-mg4-Content
      * COMBO-BOX
           PERFORM cb-mg5-Content
      * COMBO-BOX
           PERFORM cb-mg6-Content
      * COMBO-BOX
           PERFORM cb-mg7-Content
      * COMBO-BOX
           PERFORM cb-mul-Content
      * COMBO-BOX
           PERFORM cb-int-Content
      * COMBO-BOX
           PERFORM cb-dur-Content
      * COMBO-BOX
           PERFORM cb-gio-Content
      * COMBO-BOX
           PERFORM cb-wod-Content
      * GRID
           PERFORM gd1-Content
      * GRID
           PERFORM gd-schema-Content
           .

       Form1-DataSet1-CHANGETO-KEY1.
           MOVE 1 TO DataSet1-KEYIS
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Asc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "A" TO DataSet1-twodbook-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Change-CurrentKey-Desc.
           EVALUATE DataSet1-KEYIS
           WHEN 1
              MOVE "D" TO DataSet1-twodbook-KEY1-ORDER
           END-EVALUATE
           PERFORM Form1-DataSet1-Update-Key
           .

       Form1-DataSet1-Update-Key.
           MOVE tod-rec OF twodbook TO
                     Form1-MULKEY-TMPBUF
           PERFORM Form1-CLEAR
           PERFORM Form1-INIT-DATA
           MOVE Form1-MULKEY-TMPBUF TO
                     tod-rec OF twodbook
           PERFORM DataSet1-twodbook-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
           .

       Form1-DUPLICATE-MOVEKEY.
           .

       Form1-First.
           PERFORM Form1-DUMMY-FIRST
           PERFORM DataSet1-twodbook-INITSTART
           PERFORM DataSet1-twodbook-START
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFirst>
      * <TOTEM:END>
           PERFORM DataSet1-twodbook-Read-Next
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFirst>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Previous.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-twodbook-START-LESS
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforePrevious>
      * <TOTEM:END>
           PERFORM DataSet1-twodbook-Read-Prev
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterPrevious>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-PREVIOUS
           PERFORM Form1-IUD-Display
           .

       Form1-Next.
              PERFORM Form1-Buf-To-Fld
              PERFORM DataSet1-twodbook-START-GREATER
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeNext>
      * <TOTEM:END>
           PERFORM DataSet1-twodbook-Read-Next
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterNext>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-NEXT
           PERFORM Form1-IUD-Display
           .
      
       Form1-Last.
           PERFORM Form1-DUMMY-LAST
           PERFORM DataSet1-twodbook-INITEND
           PERFORM DataSet1-twodbook-START-NOTGREATER
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeLast>
      * <TOTEM:END>
           PERFORM DataSet1-twodbook-Read-Prev
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterLast>
      * <TOTEM:END>
           PERFORM Form1-DUPLICATE-MOVEKEY.
           PERFORM Form1-IUD-Display
           .

       Form1-Curr.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeCurrent>
      * <TOTEM:END>
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-twodbook-Read
           PERFORM Form1-DUPLICATE-MOVEKEY
           PERFORM Form1-DUMMY-CURR
           PERFORM Form1-IUD-Display
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterCurrent>
      * <TOTEM:END>
           .

       Form1-IUD-Display.
           IF Valid-STATUS-twodbook
              PERFORM Form1-ALLGRID-RESET
              PERFORM Form1-Fld-To-Buf
              PERFORM Form1-NAVI-FOR-MASTERGRID
              PERFORM Form1-DISPLAY
           ELSE
              IF Form1-FLAG-REFRESH
                 CONTINUE
              ELSE
                 PERFORM Form1-Extended-File-Status
              END-IF
           END-IF
           .

       Form1-Add.
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-ADD
           PERFORM DataSet1-twodbook-INITREC
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeAdd>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-twodbook-Rec-Write
           IF Valid-STATUS-twodbook
              PERFORM Form1-RESUMMARY-INS
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "301" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterAdd>
      * <TOTEM:END>
           .
     
       Form1-Update.
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-twodbook-START              
           IF NOT Valid-STATUS-twodbook
              PERFORM Form1-Extended-File-Status
              EXIT PARAGRAPH
           END-IF
           PERFORM DataSet1-twodbook-Read
           PERFORM Form1-Buf-To-Fld
           PERFORM Form1-VALIDATION-ROUTINE
           IF NOT TOTEM-CHECK-OK
               EXIT PARAGRAPH
           END-IF
           PERFORM Form1-DUMMY-UPDATE
           PERFORM Form1-Buf-To-Fld
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeUpdate>
      * <TOTEM:END>
      * write
           PERFORM DataSet1-twodbook-Rec-Rewrite
           IF Valid-STATUS-twodbook
              PERFORM Form1-RESUMMARY-DEL
              PERFORM Form1-DUMMY-UPDATE-INIT
              MOVE "302" TO TOTEM-MSG-ID
              PERFORM Form1-IUD-Display
           END-IF
           PERFORM Form1-ERR-CHECKING
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterUpdate>
      * <TOTEM:END>
           .

       Form1-Delete.
           MOVE "203" TO TOTEM-MSG-ID
           PERFORM MESSAGE-BOX-DISPLAY
           IF TOTEM-MSG-RETURN-VALUE NOT = 1
              INITIALIZE TOTEM-MSG-TEXT
              EXIT PARAGRAPH 
           END-IF
           MOVE SPACES TO TOTEM-TRANSACTION-FLAG
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeDelete>
      * <TOTEM:END>
           PERFORM Form1-DUMMY-DELETE
      * delete
           PERFORM Form1-Buf-To-Fld
           PERFORM DataSet1-twodbook-Rec-Delete
           IF Valid-STATUS-twodbook
              PERFORM Form1-CLEAR
              PERFORM Form1-DUMMY-DELETE-INIT
              MOVE "303" TO TOTEM-MSG-ID
              MOVE "00" to STATUS-twodbook
           END-IF
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterDelete>
      * <TOTEM:END>
           PERFORM Form1-ERR-CHECKING
           .

       Form1-NAVI-FOR-MASTERGRID.
           .

       Form1-ERR-CHECKING.
           IF Valid-STATUS-twodbook
              PERFORM Form1-SHOW-MSG-ROUTINE
           ELSE
              PERFORM Form1-Extended-File-Status
           END-IF
           .

       Form1-RESUMMARY-INS.
           .

       Form1-RESUMMARY-DEL.
           .


       Form1-DUMMY-FIRST.
           .

       Form1-DUMMY-PREVIOUS.
           .

       Form1-DUMMY-NEXT.
           .

       Form1-DUMMY-LAST.
           .

       Form1-DUMMY-CURR.
           .

       Form1-DUMMY-ADD.
           .

       Form1-DUMMY-UPDATE.
           .

       Form1-DUMMY-UPDATE-INIT.
           .

       Form1-DUMMY-DELETE.
           .

       Form1-DUMMY-DELETE-INIT.
           .

       Form1-Init-Value.
           MOVE titolo TO TOTEM-MSG-TITLE
      * FORM : Form1
           PERFORM DataSet1-INIT-RECORD
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, SetDefault>
      * <TOTEM:END>
           PERFORM Form1-FLD-TO-BUF
           .


       Form1-ALLGRID-RESET.
           .

      * for Form's Validation
       Form1-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       Form1-Buf-To-Fld.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterBufToFld>
      * <TOTEM:END>
           .

       Form1-Fld-To-Buf.
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:Form1, FORM:Form1, AfterFldToBuf>
           perform ABILITAZIONI. 
           perform VALORIZZA-OLD.

           .
      * <TOTEM:END>
           .

       Form1-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform Form1-BUF-TO-FLD.
           move 0 to scelta.
           .
       Form1-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM Form1-SHOW-MSG-ROUTINE
           .

       Form1-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM Form1-DISPLAY-MESSAGE
           .

       Form1-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       Form1-Save-Status.
           MOVE DataSet1-twodbook-KEY1-ORDER TO TMP-Form1-KEY1-ORDER
           MOVE DataSet1-KEYIS TO TMP-Form1-KEYIS
           MOVE tod-rec OF twodbook TO 
              TMP-Form1-twodbook-RESTOREBUF
           .             

       Form1-Restore-Status.
           MOVE TMP-Form1-KEY1-ORDER TO DataSet1-twodbook-KEY1-ORDER
           MOVE TMP-Form1-KEYIS TO DataSet1-KEYIS
           MOVE TMP-Form1-twodbook-RESTOREBUF TO
              tod-rec OF twodbook
           PERFORM DataSet1-twodbook-START
           IF Valid-STATUS-twodbook
              PERFORM DataSet1-twodbook-Read-Next
           ELSE
              PERFORM DataSet1-twodbook-INITREC
           END-IF
           PERFORM UNTIL NOT Valid-STATUS-twodbook OR
              (Valid-STATUS-twodbook AND
                 tod-rec OF twodbook = 
                   TMP-Form1-twodbook-RESTOREBUF)
              PERFORM DataSet1-twodbook-Read-Next
           END-PERFORM
           .

       scr-attesa-Open-Routine.
           PERFORM scr-attesa-Scrn
           PERFORM scr-attesa-Proc
           .

       scr-attesa-Scrn.
           PERFORM scr-attesa-Create-Win
           PERFORM scr-attesa-Init-Value
           PERFORM scr-attesa-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-attesa-DISPLAY
           .

       scr-attesa-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 3,85,
              SIZE 44,27,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 131329,
              CONTROL FONT Calibri16B-Occidentale,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              No WRAP,
              EVENT PROCEDURE scr-attesa-Event-Proc,
              HANDLE IS scr-attesa-Handle,
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-attesa UPON scr-attesa-Handle
      * DISPLAY-COLUMNS settings
           .

       scr-attesa-PROC.
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, BeforeAccept>
           move 0 to tentativo.
           modify gd1, mass-update 1.
           perform 15 times |Se non riesco significa che non ho esercizi a sufficienza
              perform GENERA-WOD 
              move 0 to tot-subst
              move low-value to tex-rec
              start tmp-exe key >= tex-k-day-exe
                    invalid continue
                not invalid
                    perform until 1 = 2
                       read tmp-exe next at end exit perform end-read
                       if como-giorno = 0
                          move tex-day to como-giorno
                          move tex-desc-univoca to exe-desc 
                          exit perform cycle
                       end-if
                       if tex-day = como-giorno and
                          tex-desc-univoca = exe-desc
                          add 1 to tot-subst
                          exit perform
                       else
                          move tex-day to como-giorno
                          move tex-desc-univoca to exe-desc 
                       end-if
                    end-perform
              end-start          
              if tot-subst = 0
                 exit perform
              end-if
           end-perform.
           move 27 to key-status.
           modify gd1, mass-update 0.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT OMITTED LINE 1 COL 1
                 ON EXCEPTION
                    PERFORM scr-attesa-Evaluate-Func
                 MOVE 2 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-attesa-Handle
           INITIALIZE Key-Status
           .

       scr-attesa-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-attesa-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-attesa-Exit
                 END-IF
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-attesa-CLEAR.
           PERFORM scr-attesa-INIT-VALUE
           PERFORM scr-attesa-DISPLAY
           .

       scr-attesa-DISPLAY.
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-attesa UPON scr-attesa-Handle
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-attesa-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-attesa-Init-Data.
           MOVE 2 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-attesa-Init-Value.
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, SetDefault>
      * <TOTEM:END>
           PERFORM scr-attesa-FLD-TO-BUF
           .


       scr-attesa-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-attesa-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-attesa-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-attesa-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-attesa, FORM:scr-attesa, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-attesa-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-attesa-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-attesa-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-attesa-SHOW-MSG-ROUTINE
           .

       scr-attesa-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-attesa-DISPLAY-MESSAGE
           .

       scr-attesa-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-attesa-Save-Status.
           .             

       scr-attesa-Restore-Status.
           .

       scr-date-Open-Routine.
           PERFORM scr-date-Scrn
           PERFORM scr-date-Proc
           .

       scr-date-Scrn.
           PERFORM scr-date-Create-Win
           PERFORM scr-date-Init-Value
           PERFORM scr-date-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-date-DISPLAY
           .

       scr-date-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 18,65,
              SIZE 52,82,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 131329,
              CONTROL FONT Calibri16-Occidentale,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              No WRAP,
              EVENT PROCEDURE scr-attesa-Event-Proc,
              HANDLE IS scr-date-handle,
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-date UPON scr-date-handle
      * DISPLAY-COLUMNS settings
           .

       scr-date-PROC.
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, BeforeAccept>
           move 0 to ef-gg1-buf e-gg1.
           move 0 to ef-gg2-buf e-gg2.
           move 0 to ef-gg3-buf e-gg3.
           move 0 to ef-gg4-buf e-gg4.
           move 0 to ef-gg5-buf e-gg5.
           move 0 to ef-gg6-buf e-gg6.
           move 0 to ef-gg7-buf e-gg7.

           move low-value to tex-key.
           start tmp-exe key >= tex-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-exe next at end exit perform end-read
                    evaluate tex-day       
                    when 1 move 1 to e-gg1
                    when 2 move 1 to e-gg2
                    when 3 move 1 to e-gg3
                    when 4 move 1 to e-gg4
                    when 5 move 1 to e-gg5
                    when 6 move 1 to e-gg6
                    when 7 move 1 to e-gg7
                    end-evaluate
                 end-perform
           end-start.

           display scr-date.
                                          
           move lab-desc-buf to ef-desc-buf.
           display ef-desc.               
           initialize lab-ins-mod-buf.    
           move lab-code-buf to tod-code.
           if tod-code > 0
              move lab-code-buf to como-tod-code
              inspect como-tod-code replacing leading x"30" by x"20"
              call "C$JUSTIFY" using como-tod-code, "L"
              string "Stai modificando il wod # "
                     como-tod-code
                into lab-ins-mod-buf
              end-string
              move low-value to rod-key  
              move tod-code  to rod-code
              start rwodbook key >= rod-key
                    invalid continue
                not invalid
                    perform until 1 = 2
                       read rwodbook next at end exit perform end-read
                       if rod-code not = tod-code
                          exit perform
                       end-if
                       evaluate rod-prg-day
                       when 1 
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg1-buf
                       when 2
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg2-buf
                       when 3
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg3-buf
                       when 4
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg4-buf
                       when 5
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg5-buf
                       when 6
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg6-buf
                       when 7
                            move rod-day to como-data
                            perform DATE-TO-SCREEN
                            move como-data to ef-gg7-buf
                       end-evaluate
                    end-perform
              end-start
           else
              move "Stai inserendo un nuovo wod" to lab-ins-mod-buf
              move 0 to ef-gg1-buf ef-gg2-buf ef-gg3-buf ef-gg4-buf
                        ef-gg5-buf ef-gg6-buf ef-gg7-buf
           end-if.
           display lab-ins-mod
           display ef-gg1 ef-gg2 ef-gg3 ef-gg4 ef-gg5 ef-gg6 ef-gg7.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-date
                 ON EXCEPTION
                    PERFORM scr-date-Evaluate-Func
                 MOVE 3 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-date-handle
           INITIALIZE Key-Status
           .

       scr-date-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-date-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-date-Exit
                 END-IF
              WHEN Key-Status = 333
                 PERFORM pb-ok-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-date-CLEAR.
           PERFORM scr-date-INIT-VALUE
           PERFORM scr-date-DISPLAY
           .

       scr-date-DISPLAY.
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-date UPON scr-date-handle
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-date-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-date-Init-Data.
           MOVE 3 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
           .

       scr-date-Init-Value.
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, SetDefault>
      * <TOTEM:END>
           PERFORM scr-date-FLD-TO-BUF
           .


       scr-date-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-date-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-date-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-date-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-date, FORM:scr-date, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-date-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-date-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-date-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-date-SHOW-MSG-ROUTINE
           .

       scr-date-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-date-DISPLAY-MESSAGE
           .

       scr-date-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-date-Save-Status.
           .             

       scr-date-Restore-Status.
           .

       scr-filtro-Open-Routine.
           PERFORM scr-filtro-Scrn
           PERFORM scr-filtro-Proc
           .

       scr-filtro-Scrn.
           PERFORM scr-filtro-Create-Win
           PERFORM scr-filtro-Init-Value
           PERFORM scr-filtro-Init-Data
      * Tab keystrok settings
      * Tool Bar
           PERFORM scr-filtro-DISPLAY
           .

       scr-filtro-Create-Win.
           Display Floating GRAPHICAL WINDOW
              LINES 22,88,
              SIZE 78,91,
              HEIGHT-IN-CELLS,
              WIDTH-IN-CELLS,
              COLOR 131329,
              CONTROL FONT Calibri16-Occidentale,
              LINK TO THREAD,
              MODELESS,
              NO SCROLL,
              No WRAP,
              EVENT PROCEDURE scr-attesa-Event-Proc,
              HANDLE IS scr-filtro-handle,
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, AfterCreateWin>
      * <TOTEM:END>


      * Tool Bar    
      * Status-bar
           DISPLAY scr-filtro UPON scr-filtro-handle
      * DISPLAY-COLUMNS settings
           .

       scr-filtro-PROC.
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, BeforeAccept>
           move 0 to e-des e-dta e-dtc e-map e-exe e-mul e-rep e-gss 
           e-mcg e-eff e-dur.
           move 0 to ef-dta-from-buf ef-dta-to-buf.
           move 0 to ef-dtc-from-buf ef-dtc-to-buf ef-map-buf 
           ef-dur-buf.
           move spaces to ef-des-buf ef-exe-buf ef-mul-buf ef-rep-buf 
           ef-gss-buf ef-mcg-buf.
           move 78-lab-tutti to lab-map-buf
                                lab-exe-buf
                                lab-mul-buf
                                lab-rep-buf
                                lab-gss-buf
                                lab-mcg-buf
                                lab-dur-buf.
           move 1 to tipo-filtro.
           modify cb-eff, reset-list = 1.                
           modify cb-eff, item-to-add "Light wod effort" 
           modify cb-eff, item-to-add "Medium wod effort" 
           modify cb-eff, item-to-add "Heavy wod effort"  
           modify cb-eff, item-to-add "Tutti" 
           
           move "Tutti" to cb-eff-buf.

           display scr-filtro.

           move 1 to nessuna-scelta.

           .
      * <TOTEM:END>
           PERFORM UNTIL Exit-Pushed
              ACCEPT scr-filtro
                 ON EXCEPTION
                    PERFORM scr-filtro-Evaluate-Func
                 MOVE 4 TO TOTEM-Form-Index
              END-ACCEPT
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, AfterEndAccept>
      * <TOTEM:END>
           END-PERFORM
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, BeforeDestroyWindow>
      * <TOTEM:END>
           DESTROY scr-filtro-handle
           INITIALIZE Key-Status
           .

       scr-filtro-Evaluate-Func.
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, AfterAccept>
      * <TOTEM:END>
           EVALUATE TRUE
              WHEN Exit-Pushed
                 PERFORM scr-filtro-Exit
              WHEN Event-Occurred
                 IF Event-Type = Cmd-Close
                    PERFORM scr-filtro-Exit
                 END-IF
              WHEN Key-Status = 1000
                 PERFORM rb-tut-LinkTo
              WHEN Key-Status = 1001
                 PERFORM rb-des-LinkTo
              WHEN Key-Status = 1002
                 PERFORM rb-dta-LinkTo
              WHEN Key-Status = 1003
                 PERFORM rb-dtc-LinkTo
              WHEN Key-Status = 1004
                 PERFORM rb-map-LinkTo
              WHEN Key-Status = 1016
                 PERFORM rb-eff-LinkTo
              WHEN Key-Status = 1009
                 PERFORM pb-map-LinkTo
              WHEN Key-Status = 1005
                 PERFORM rb-exe-LinkTo
              WHEN Key-Status = 1010
                 PERFORM pb-exe-LinkTo
              WHEN Key-Status = 1006
                 PERFORM rb-mul-LinkTo
              WHEN Key-Status = 1011
                 PERFORM pb-mul-LinkTo
              WHEN Key-Status = 1007
                 PERFORM rb-rep-LinkTo
              WHEN Key-Status = 1012
                 PERFORM pb-rep-LinkTo
              WHEN Key-Status = 1008
                 PERFORM rb-gss-LinkTo
              WHEN Key-Status = 1013
                 PERFORM pb-gss-LinkTo
              WHEN Key-Status = 1008
                 PERFORM rb-gss-LinkTo
              WHEN Key-Status = 1014
                 PERFORM pb-mcg-LinkTo
              WHEN Key-Status = 1017
                 PERFORM rb-dur-LinkTo
              WHEN Key-Status = 1018
                 PERFORM pb-dur-LinkTo
              WHEN Key-Status = 1015
                 PERFORM pb-ok-f-LinkTo
           END-EVALUATE
      * avoid changing focus
           MOVE 4 TO Accept-Control
           .

       scr-filtro-CLEAR.
           PERFORM scr-filtro-INIT-VALUE
           PERFORM scr-filtro-DISPLAY
           .

       scr-filtro-DISPLAY.
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, BeforeDisplay>
      * <TOTEM:END>
           DISPLAY scr-filtro UPON scr-filtro-handle
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, AfterDisplay>
           SET LK-BL-SCRITTURA     TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           MOVE FORM1-HANDLE       TO LK-HND-WIN.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
           CANCEL "BLOCKPGM".

           .
      * <TOTEM:END>
           .

       scr-filtro-Exit.
      * for main screen
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, BeforeExit>
      * <TOTEM:END>
           MOVE 27 TO Key-Status
           .

       scr-filtro-Init-Data.
           MOVE 4 TO TOTEM-Form-Index
           MOVE 0 TO TOTEM-Frame-Index
      * COMBO-BOX
           PERFORM cb-eff-Content
           .

       scr-filtro-Init-Value.
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, SetDefault>
      * <TOTEM:END>
           PERFORM scr-filtro-FLD-TO-BUF
           .


       scr-filtro-ALLGRID-RESET.
           .

      * for Form's Validation
       scr-filtro-VALIDATION-ROUTINE.
           SET TOTEM-CHECK-OK TO TRUE
           .


       scr-filtro-Buf-To-Fld.
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, BeforeBufToFld>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, AfterBufToFld>
      * <TOTEM:END>
           .

       scr-filtro-Fld-To-Buf.
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, BeforeFldToBuf>
      * <TOTEM:END>
      * <TOTEM:EPT. FORM:scr-filtro, FORM:scr-filtro, AfterFldToBuf>
      * <TOTEM:END>
           .

       scr-filtro-CONTROLLO-OLD.
           set SiSalvato to true.
           if mod = 0 exit paragraph end-if.
           perform scr-filtro-BUF-TO-FLD.
           move 0 to scelta.
           .
       scr-filtro-EXTENDED-FILE-STATUS.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
           MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           PERFORM scr-filtro-SHOW-MSG-ROUTINE
           .

       scr-filtro-SHOW-MSG-ROUTINE.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM scr-filtro-DISPLAY-MESSAGE
           .

       scr-filtro-DISPLAY-MESSAGE.
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

       scr-filtro-Save-Status.
           .             

       scr-filtro-Restore-Status.
           .



       Screen1-Event-Proc.
           .

       cb-wod-Exception-Proc.
           IF Event-Occurred
              EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
              WHEN Ntf-Selchange ALSO 34 ALSO
                    form1-Handle
                 PERFORM cb-wod-Ex-Ntf-Selchange
              END-EVALUATE
           END-IF
           .

       Screen1-Gd-1-Event-Proc.
           EVALUATE Event-Type ALSO Event-Control-Id ALSO
                                    Event-Window-Handle
           WHEN Msg-Begin-Drag ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-Begin-Drag
           WHEN Msg-Begin-Entry ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-Begin-Entry
           WHEN Msg-End-Drag ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-End-Drag
           WHEN Msg-Finish-Entry ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-Finish-Entry
           WHEN Msg-Goto-Cell ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-Goto-Cell
           WHEN Msg-Goto-Cell-Drag ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-Goto-Cell-Drag
           WHEN Msg-Goto-Cell-Mouse ALSO 5008 ALSO
                    form1-Handle 
              PERFORM gd1-Ev-Msg-Goto-Cell-Mouse
           WHEN Msg-Begin-Entry ALSO 37 ALSO
                    form1-Handle 
              PERFORM gd-schema-Ev-Msg-Begin-Entry
           END-EVALUATE
           .

       scr-attesa-Event-Proc.
           .

      * USER DEFINE PARAGRAPH
       PARAGRAFO-COPY.
      * <TOTEM:PARA. PARAGRAFO-COPY>
           copy "abilita-toolbar.cpy".
           copy "color-custom.cpy".
           copy "status.cpy".
           copy "utydata.cpy" 
           .
      * <TOTEM:END>

       ABILITA-MACROGRUPPI.
      * <TOTEM:PARA. ABILITA-MACROGRUPPI>
           inquire cb-mg1, value cb-mg1-buf.
           inquire cb-mg2, value cb-mg2-buf.
           inquire cb-mg3, value cb-mg3-buf.
           inquire cb-mg4, value cb-mg4-buf.
           inquire cb-mg5, value cb-mg5-buf.
           inquire cb-mg6, value cb-mg6-buf.
           inquire cb-mg7, value cb-mg7-buf.
           inquire cb-mul, value cb-mul-buf.
           inquire cb-int, value cb-int-buf.
           inquire cb-dur, value cb-dur-buf.
           inquire cb-gio, value cb-gio-buf.
           inquire cb-wod, value cb-wod-buf.

           if cb-mg1-buf = s-cb-mg1-buf and
              cb-mg2-buf = s-cb-mg2-buf and
              cb-mg3-buf = s-cb-mg3-buf and
              cb-mg4-buf = s-cb-mg4-buf and
              cb-mg5-buf = s-cb-mg5-buf and
              cb-mg6-buf = s-cb-mg6-buf and
              cb-mg7-buf = s-cb-mg7-buf and
              cb-mul-buf = s-cb-mul-buf and
              cb-int-buf = s-cb-int-buf and
              cb-dur-buf = s-cb-dur-buf and
              cb-gio-buf = s-cb-gio-buf and
              cb-wod-buf = s-cb-wod-buf
              exit paragraph 
           end-if.                           
                                       
      *     move spaces to lab-desc-buf.
      *     display lab-desc.
      *     move 0 to lab-code-buf s-wod-code.
      *     display lab-code.

           move 0 to e-cancella
           modify tool-cancella, enabled e-cancella
           
           inquire cb-wod, value in wom-desc.     

           read wodmap key wom-k-desc
                invalid                           
                initialize wom-data replacing numeric data by zeroes
                                         alphanumeric data by spaces
                modify cb-mg1, value "Nessuno"
                modify cb-mg2, value "Nessuno"  
                modify cb-mg3, value "Nessuno"  
                modify cb-mg4, value "Nessuno"  
                modify cb-mg5, value "Nessuno"  
                modify cb-mg6, value "Nessuno"  
                modify cb-mg7, value "Nessuno"  

            not invalid                     
                if cb-wod-buf not = s-cb-wod-buf            
                                   
                   initialize mcg-sigle-tab replacing numeric data by 
           zeroes
                                                 alphanumeric data by 
           spaces

                   modify cb-mg1, value "Nessuno", 
                   modify cb-mg2, value "Nessuno"  
                   modify cb-mg3, value "Nessuno"  
                   modify cb-mg4, value "Nessuno"  
                   modify cb-mg5, value "Nessuno"  
                   modify cb-mg6, value "Nessuno"  
                   modify cb-mg7, value "Nessuno"  

                   move wom-sigla-default(1) to el-mcg-sigla(1)
                   move wom-sigla-default(2) to el-mcg-sigla(2)
                   move wom-sigla-default(3) to el-mcg-sigla(3)
                   move wom-sigla-default(4) to el-mcg-sigla(4)
                   move wom-sigla-default(5) to el-mcg-sigla(5)
                   move wom-sigla-default(6) to el-mcg-sigla(6)
                   move wom-sigla-default(7) to el-mcg-sigla(7)
                
                   if reloadGrid
                      move tod-el-mcg-code(1)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(1) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg1, value mcg-desc
                   end-read

                   if reloadGrid
                      move tod-el-mcg-code(2)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(2) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg2, value mcg-desc
                   end-read

                   if reloadGrid
                      move tod-el-mcg-code(3)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(3) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg3, value mcg-desc
                   end-read

                   if reloadGrid
                      move tod-el-mcg-code(4)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(4) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg4, value mcg-desc
                   end-read

                   if reloadGrid
                      move tod-el-mcg-code(5)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(5) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg5, value mcg-desc
                   end-read

                   if reloadGrid
                      move tod-el-mcg-code(6)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(6) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg6, value mcg-desc
                   end-read

                   if reloadGrid
                      move tod-el-mcg-code(7)      to mcg-code
                   else                                       
                      move wom-mcg-code-default(7) to mcg-code
                   end-if
                   read macrogroups 
                        invalid continue
                    not invalid modify cb-mg7, value mcg-desc
                   end-read  
                end-if
           end-read.                          

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(1) delimited size
             into como-tit-macro
           end-string
           modify lab-a, title como-tit-macro.
           if el-mcg-sigla(1) = space     
              modify cb-mg1, enabled false
           else
              modify cb-mg1, enabled true
           end-if.

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(2) delimited size
             into como-tit-macro
           end-string
           modify lab-b, title como-tit-macro.
           if el-mcg-sigla(2) = space     
              modify cb-mg2, enabled false
           else
              modify cb-mg2, enabled true
           end-if.

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(3) delimited size
             into como-tit-macro
           end-string
           modify lab-c, title como-tit-macro.
           if el-mcg-sigla(3) = space     
              modify cb-mg3, enabled false
           else
              modify cb-mg3, enabled true
           end-if.

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(4) delimited size
             into como-tit-macro
           end-string
           modify lab-d, title como-tit-macro.
           if el-mcg-sigla(4) = space     
              modify cb-mg4, enabled false
           else
              modify cb-mg4, enabled true
           end-if.

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(5) delimited size
             into como-tit-macro
           end-string
           modify lab-e, title como-tit-macro.
           if el-mcg-sigla(5) = space     
              modify cb-mg5, enabled false
           else
              modify cb-mg5, enabled true
           end-if.

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(6) delimited size
             into como-tit-macro
           end-string
           modify lab-f, title como-tit-macro.
           if el-mcg-sigla(6) = space     
              modify cb-mg6, enabled false
           else
              modify cb-mg6, enabled true
           end-if.

           initialize como-tit-macro.
           string "Macrogruppo "  delimited size
                  el-mcg-sigla(7) delimited size
             into como-tit-macro
           end-string
           modify lab-g, title como-tit-macro.
           if el-mcg-sigla(7) = space     
              modify cb-mg7, enabled false
           else
              modify cb-mg7, enabled true
           end-if.

           move 0 to como-prim(1).
           move 0 to como-prim(2).
           move 0 to como-prim(3).
           move 0 to como-prim(4).
           move 0 to como-prim(5).
           move 0 to como-prim(6).
           move 0 to como-prim(7).
           move 0 to como-prim(8).
           move 0 to como-prim(9).
           move 0 to como-prim(10).

           modify lab-a, font Calibri14-Occidentale.
           modify lab-b, font Calibri14-Occidentale.
           modify lab-c, font Calibri14-Occidentale.
           modify lab-d, font Calibri14-Occidentale.
           modify lab-e, font Calibri14-Occidentale.
           modify lab-f, font Calibri14-Occidentale.
           modify lab-g, font Calibri14-Occidentale.      
                                                      
           modify pb-mcg1, enabled false, title "Mai".
           modify pb-mcg2, enabled false, title "Mai".
           modify pb-mcg3, enabled false, title "Mai".
           modify pb-mcg4, enabled false, title "Mai".
           modify pb-mcg5, enabled false, title "Mai".
           modify pb-mcg6, enabled false, title "Mai".
           modify pb-mcg7, enabled false, title "Mai".
                                          
           modify lab-a, color = 513.
           modify lab-b, color = 513.
           modify lab-c, color = 513.
           modify lab-d, color = 513.
           modify lab-e, color = 513.
           modify lab-f, color = 513.
           modify lab-g, color = 513.

           modify gd1, reset-grid = 1.
           perform GD1-CONTENT.
           move 0 to mod.
           perform ABILITAZIONI.

           modify gd-schema, reset-grid = 1.
           perform GD-SCHEMA-CONTENT.
           move 1 to riga.
           move 304 to colore. 
                                            
           modify pb-genera, enabled false.

           perform varying idx-days from 1 by 1
                     until idx-days > wom-days
              initialize rec-schema
                         replacing numeric data by zeroes
                              alphanumeric data by spaces
              perform varying idx-split from 1 by 1
                        until idx-split > 20
                 if wom-split-el-split-sigla(idx-days, idx-split) = 
           space
                    exit perform
                 end-if                                
                 evaluate wom-split-el-split-sigla(idx-days, idx-split)
                 when el-mcg-sigla(1) 
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-a, font Calibri14BU-Occidentale
                         move 1 to como-prim(1)
                      end-if
                      inquire cb-mg1, value = mcg-desc
                 when el-mcg-sigla(2) 
                      inquire cb-mg2, value = mcg-desc
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-b, font Calibri14BU-Occidentale
                         move 1 to como-prim(2)
                      end-if
                 when el-mcg-sigla(3) 
                      inquire cb-mg3, value = mcg-desc
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-c, font Calibri14BU-Occidentale
                         move 1 to como-prim(3)
                      end-if
                 when el-mcg-sigla(4)  
                      inquire cb-mg4, value = mcg-desc
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-d, font Calibri14BU-Occidentale
                         move 1 to como-prim(4)
                      end-if
                 when el-mcg-sigla(5)  
                      inquire cb-mg5, value = mcg-desc
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-e, font Calibri14BU-Occidentale
                         move 1 to como-prim(5)
                      end-if
                 when el-mcg-sigla(6) 
                      inquire cb-mg6, value = mcg-desc
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-f, font Calibri14BU-Occidentale
                         move 1 to como-prim(6)
                      end-if
                 when el-mcg-sigla(7) 
                      inquire cb-mg7, value = mcg-desc
                      if wom-split-el-split-primary(idx-days, 
           idx-split) = 1
                         modify lab-g, font Calibri14BU-Occidentale
                         move 1 to como-prim(7)
                      end-if
                 end-evaluate
                 read macrogroups key mcg-k-desc
                      invalid move spaces to mcg-desc mcg-code
                 end-read

                 move wom-split-el-split-int-code(idx-days, idx-split)
                   to int-code
                 read intexe no lock
                 
                 initialize como-day
                 inspect como-day replacing trailing spaces by low-value
                 string  wom-split-el-split-sigla(idx-days, idx-split)
                         " - "          
                         int-desc(1:4)
                    into como-day
                 end-string
                 evaluate idx-split
                 when 1  move como-day to sigle-effort-1
                         move mcg-code to mcg-1
                 when 2  move como-day to sigle-effort-2
                         move mcg-code to mcg-2
                 when 3  move como-day to sigle-effort-3
                         move mcg-code to mcg-3
                 when 4  move como-day to sigle-effort-4
                         move mcg-code to mcg-4
                 when 5  move como-day to sigle-effort-5
                         move mcg-code to mcg-5
                 when 6  move como-day to sigle-effort-6
                         move mcg-code to mcg-6
                 when 7  move como-day to sigle-effort-7
                         move mcg-code to mcg-7
                 when 8  move como-day to sigle-effort-8
                         move mcg-code to mcg-8
                 when 9  move como-day to sigle-effort-9
                         move mcg-code to mcg-9
                 when 10 move como-day to sigle-effort-10
                         move mcg-code to mcg-10
                 end-evaluate
              end-perform
              if colore = 304 
                 move 0 to colore
              else
                 move 304 to colore
              end-if
              add 1 to riga 
              modify gd-schema(riga,  1), cell-data = idx-days
              modify gd-schema(riga,  2), cell-data = sigle-effort-1
              modify gd-schema(riga,  3), cell-data = sigle-effort-2
              modify gd-schema(riga,  4), cell-data = sigle-effort-3
              modify gd-schema(riga,  5), cell-data = sigle-effort-4
              modify gd-schema(riga,  6), cell-data = sigle-effort-5
              modify gd-schema(riga,  7), cell-data = sigle-effort-6
              modify gd-schema(riga,  8), cell-data = sigle-effort-7
              modify gd-schema(riga,  9), cell-data = sigle-effort-8
              modify gd-schema(riga, 10), cell-data = sigle-effort-9
              modify gd-schema(riga, 11), cell-data = sigle-effort-10
              modify gd-schema(riga, 12), cell-data = spaces            
               

              modify gd-schema(riga), row-color = colore
              add 1 to riga      
              if mcg-1 not = spaces or
                 mcg-2 not = spaces or
                 mcg-3 not = spaces or
                 mcg-4 not = spaces or
                 mcg-5 not = spaces or
                 mcg-6 not = spaces or
                 mcg-7 not = spaces
                 inquire pb-genera, enabled in como-e
                 if como-e = 0
                    move 1 to como-e              
                    modify pb-genera, enabled true
                 end-if
              end-if
              modify gd-schema(riga,  1), cell-data = spaces
              modify gd-schema(riga,  2), cell-data = mcg-1
              modify gd-schema(riga,  3), cell-data = mcg-2
              modify gd-schema(riga,  4), cell-data = mcg-3
              modify gd-schema(riga,  5), cell-data = mcg-4
              modify gd-schema(riga,  6), cell-data = mcg-5
              modify gd-schema(riga,  7), cell-data = mcg-6
              modify gd-schema(riga,  8), cell-data = mcg-7
              modify gd-schema(riga,  9), cell-data = mcg-8
              modify gd-schema(riga, 10), cell-data = mcg-9 
              modify gd-schema(riga, 11), cell-data = mcg-10
              modify gd-schema(riga, 12), cell-data = spaces
              modify gd-schema(riga), row-color = colore    
           end-perform.        
        

           evaluate wom-macrogroups
           when 1                          
                modify cb-mg1, enabled true
           when 2                           
                modify cb-mg1, enabled true
                modify cb-mg2, enabled true
           when 3            
                modify cb-mg1, enabled true
                modify cb-mg2, enabled true
                modify cb-mg3, enabled true
           when 4            
                modify cb-mg1, enabled true
                modify cb-mg2, enabled true
                modify cb-mg3, enabled true
                modify cb-mg4, enabled true
           when 5                          
                modify cb-mg1, enabled true
                modify cb-mg2, enabled true
                modify cb-mg3, enabled true
                modify cb-mg4, enabled true
                modify cb-mg5, enabled true
           when 6                          
                modify cb-mg1, enabled true
                modify cb-mg2, enabled true
                modify cb-mg3, enabled true
                modify cb-mg4, enabled true
                modify cb-mg5, enabled true
                modify cb-mg6, enabled true
           when 7                          
                modify cb-mg1, enabled true
                modify cb-mg2, enabled true
                modify cb-mg3, enabled true
                modify cb-mg4, enabled true
                modify cb-mg5, enabled true
                modify cb-mg6, enabled true
                modify cb-mg7, enabled true
           end-evaluate.    
           
           move cb-mg1-buf to s-cb-mg1-buf.
           move cb-mg2-buf to s-cb-mg2-buf.
           move cb-mg3-buf to s-cb-mg3-buf.
           move cb-mg4-buf to s-cb-mg4-buf.
           move cb-mg5-buf to s-cb-mg5-buf.
           move cb-mg6-buf to s-cb-mg6-buf.
           move cb-mg7-buf to s-cb-mg7-buf.
           move cb-mul-buf to s-cb-mul-buf.
           move cb-int-buf to s-cb-int-buf.
           move cb-dur-buf to s-cb-dur-buf.
           move cb-gio-buf to s-cb-gio-buf.
           move cb-wod-buf to s-cb-wod-buf.
           
           inquire cb-mg1, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.             
           
           inquire cb-mg2, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.
           
           inquire cb-mg3, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.
           
           inquire cb-mg4, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.
           
           inquire cb-mg5, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.
           
           inquire cb-mg6, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.
           
           inquire cb-mg7, enabled in como-e, value in como-nome.
           if como-e = 1 and como-nome = "Nessuno"
              modify pb-genera, enabled false
           end-if.

           if cb-wod-buf = "Nessuno"         
              modify pb-random, enabled false
              modify pb-ripristino, enabled false
           else                              
              modify pb-random, enabled true
              modify pb-ripristino, enabled true
           end-if 
           .
      * <TOTEM:END>

       ABILITAZIONI.
      * <TOTEM:PARA. ABILITAZIONI>
           if mod = 1              
              move BitmapSaveEnabled    to BitmapNumSave
              move BitmapPrintEnabled   to BitmapNumPrint
              move BitmapPreviewEnabled to BitmapNumPreview
              move 1 to e-salva e-cancella e-stampa e-anteprima 
              modify pb-aggiungi, enabled true
              modify pb-elimina,  enabled true
              modify pb-su,       enabled true
              modify pb-giu,      enabled true 
              if tod-code = 0                     
                 modify pb-mod,      enabled false
              else
                 modify pb-mod,      enabled true
              end-if
           else           
              move BitmapSaveDisabled    to BitmapNumSave   
              move BitmapPrintDisabled   to BitmapNumPrint
              move BitmapPreviewDisabled to BitmapNumPreview
              move 0 to e-salva e-cancella e-stampa e-anteprima 
              modify pb-aggiungi, enabled false
              modify pb-elimina,  enabled false
              modify pb-su,       enabled false
              modify pb-giu,      enabled false   
              modify pb-int,      enabled false
              modify pb-mod,      enabled false
           end-if.      
                                               
           modify tool-salva,     enabled = e-salva.
           modify tool-stampa,    enabled = e-stampa.
           modify tool-anteprima, enabled = e-anteprima. 
       
      * ISACCO (SERVE SEMPRE PER LA MODIFICA PRCEDENTE E PER RIPRISTINARE
      * LE BITMAP DISABILITATE. - 10/11/2003
      *     perform FORM1-DISPLAY.
           display tool-nuovo, tool-salva, tool-modifica
                   tool-stampa tool-anteprima.
      * FINE 
           .
      * <TOTEM:END>

       ANTEPRIMA.
      * <TOTEM:PARA. ANTEPRIMA>
           set s-anteprima to true.
           perform STAMPA-ANTEPRIMA 
           .
      * <TOTEM:END>

       CALCOLA-HIT-BOTTONI.
      * <TOTEM:PARA. CALCOLA-HIT-BOTTONI>
           perform varying idx from 1 by 1 
                     until idx > tot-gruppi
              move el-mcg-code(idx) to th-mcg-code
              move 0 to tot-hit
              move low-value to th-day
              start tmp-hit key >= th-key
                    invalid continue
                not invalid
                    perform until 1 = 2
                       read tmp-hit next at end exit perform end-read
                       if th-mcg-code not = el-mcg-code(idx)
                          exit perform
                       end-if
                       add 1 to tot-hit
                    end-perform
              end-start
              move tot-hit to el-hit(idx)
                                      
              evaluate tot-hit
              when 0
                   evaluate idx                                       
                   when 1 modify pb-mcg1, enabled, false, title = "Mai" 
                                        
                   when 2 modify pb-mcg2, enabled, false, title = "Mai" 
                                        
                   when 3 modify pb-mcg3, enabled, false, title = "Mai" 
                                        
                   when 4 modify pb-mcg4, enabled, false, title = "Mai" 
                                        
                   when 5 modify pb-mcg5, enabled, false, title = "Mai" 
                                        
                   when 6 modify pb-mcg6, enabled, false, title = "Mai" 
                                        
                   when 7 modify pb-mcg7, enabled, false, title = "Mai"
                   end-evaluate
              when 1
                   evaluate idx         
                   when 1 modify pb-mcg1, enabled, true, title = "1 volt
      -    "a"
                   when 2 modify pb-mcg2, enabled, true, title = "1 volt
      -    "a"
                   when 3 modify pb-mcg3, enabled, true, title = "1 volt
      -    "a"
                   when 4 modify pb-mcg4, enabled, true, title = "1 volt
      -    "a"
                   when 5 modify pb-mcg5, enabled, true, title = "1 volt
      -    "a"
                   when 6 modify pb-mcg6, enabled, true, title = "1 volt
      -    "a"
                   when 7 modify pb-mcg7, enabled, true, title = "1 volt
      -    "a"
                   end-evaluate
              when other                                        
                   move tot-hit to como-hit
                   inspect como-hit replacing leading x"30" by x"20"
                   call "C$JUSTIFY" using como-hit, "L"
                   inspect como-hit replacing trailing spaces by 
           low-value
                   initialize como-day
                   string como-hit delimited low-value
                          " volte" delimited size
                     into como-day
                   end-string
                   evaluate idx
                   when 1 modify pb-mcg1, enabled, true, title como-day
                   when 2 modify pb-mcg2, enabled, true, title como-day
                   when 3 modify pb-mcg3, enabled, true, title como-day
                   when 4 modify pb-mcg4, enabled, true, title como-day
                   when 5 modify pb-mcg5, enabled, true, title como-day
                   when 6 modify pb-mcg6, enabled, true, title como-day
                   when 7 modify pb-mcg7, enabled, true, title como-day
                   end-evaluate
              end-evaluate
                 
              evaluate idx                            
              when 1 inquire cb-mg1, enabled in como-e
              when 2 inquire cb-mg2, enabled in como-e
              when 3 inquire cb-mg3, enabled in como-e
              when 4 inquire cb-mg4, enabled in como-e
              when 5 inquire cb-mg5, enabled in como-e
              when 6 inquire cb-mg6, enabled in como-e
              when 7 inquire cb-mg7, enabled in como-e
              end-evaluate

              if como-e = 1
                 evaluate tot-hit
                 when 0
                      evaluate idx
                      when 1 modify lab-a, color 176
                      when 2 modify lab-b, color 176
                      when 3 modify lab-c, color 176
                      when 4 modify lab-d, color 176
                      when 5 modify lab-e, color 176
                      when 6 modify lab-f, color 176
                      when 7 modify lab-g, color 176
                      end-evaluate
                      move 176 to el-mcg-color(idx)
                 when 1
                      evaluate idx
                      when 1 modify lab-a, color 481
                      when 2 modify lab-b, color 481
                      when 3 modify lab-c, color 481
                      when 4 modify lab-d, color 481
                      when 5 modify lab-e, color 481
                      when 6 modify lab-f, color 481
                      when 7 modify lab-g, color 481
                      end-evaluate
                      move 481 to el-mcg-color(idx)
                 when other
                      evaluate idx
                      when 1 modify lab-a, color 112
                      when 2 modify lab-b, color 112
                      when 3 modify lab-c, color 112
                      when 4 modify lab-d, color 112
                      when 5 modify lab-e, color 112
                      when 6 modify lab-f, color 112
                      when 7 modify lab-g, color 112
                      end-evaluate
                      move 112 to el-mcg-color(idx)
                 end-evaluate
              end-if

           end-perform  
           .
      * <TOTEM:END>

       CANCELLA.
      * <TOTEM:PARA. CANCELLA>
           display message "Cancellare il WOD?"
                     title titolo
                      type mb-yes-no
                    giving scelta       
       
           if scelta = mb-no
              exit paragraph
           end-if.

           move s-tod-code to tod-code.
           delete twodbook record.

           move low-value  to rod-key.
           move s-tod-code to rod-code.
           start rwodbook key >= rod-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read rwodbook next at end exit perform end-read
                    if rod-code not = tod-code
                       exit perform
                    end-if
                    delete rwodbook record
                 end-perform
           end-start.

           perform DATI-DEFAULT 
           .
      * <TOTEM:END>

       CERCA.
      * <TOTEM:PARA. CERCA>
           evaluate CONTROL-ID
      *
      *     when 78-ID-ef-cliente           
      *          set SceltoCliente to false
      *          inquire ef-cliente, value in cli-codice
      *          move "clienti-alfa" to como-file
      *          call "zoom-gt"   using como-file, cli-rec
      *                          giving stato-zoom
      *          cancel "zoom-gt"
      *          if stato-zoom = 0
      *             set SceltoCliente to true
      *             move cli-codice   to tsc-cliente
      *             modify ef-cliente, value tsc-cliente
      *             move 4                to ACCEPT-CONTROL   
      *          end-if
      *
           when 78-ID-gd1
                perform X-Y
                evaluate colonna
                when 78-col-exe-code
                     perform X-Y
                     inquire gd1(riga, 78-col-exe-code), 
                             cell-data in exe-code
                     inquire gd1(riga, 78-col-grp-code), 
                             cell-data in grp-code
                     perform LOOKUP-EXE
      *
      *          when 78-col-prz
      *               perform VALORE-RIGA
      *               move riga to store-riga
      *               perform FORM-PREZZI-OPEN-ROUTINE
      *               move store-riga to riga
      *               if prezzo-scelto not = 0
      *                  move prezzo-scelto to col-prz
      *                  modify gd1(riga, 78-col-prz), cell-data col-prz
      *                  if como-col-sc1 = 0 |and como-col-sc2 = 0
      *                     move cli-sconto1 to como-col-sc1 col-sc1
      ******                     move cli-sconto2 to como-col-sc2 col-sc2
      *                     modify gd1(riga, 78-col-sc1), cell-data col-sc1
      ******                     modify gd1(riga, 78-col-sc2), cell-data col-sc2
      *                  end-if
      *                  perform VALORE-RIGA
      *                  perform CALCOLA-NETTO
      *                  if col-prz not = old-col-prz
      *                     move riga        to RigaCambiata
      *                     move 78-col-prz  to ColonnaCambiata
      *                  end-if
      *               end-if
      *               move 78-ID-gd1 to control-id
      *               move 4         to accept-control
      *               modify gd1, cursor-y riga, cursor-x 78-col-prz
      
      *          end-evaluate
           end-evaluate  
           .
      * <TOTEM:END>

       CLEAR-SCREEN.
      * <TOTEM:PARA. CLEAR-SCREEN>
      *     move tsc-chiave to old-tsc-chiave.
      *
      *     initialize tsc-dati of tschede 
      *               replacing numeric data by zeroes
      *                    alphanumeric data by spaces.
      *                   
      *     perform FORM1-FLD-TO-BUF. 
      *
      *     perform INIT-OLD-REC.
      *
      *     perform CLEAR-CLIENTE.
      *                                   
      *     display form1. 
      *
      *     perform RESETTA-GRID.
      *
      *     unlock tschede all records    
           .
      * <TOTEM:END>

       CHECK-INSERIMENTO.
      * <TOTEM:PARA. CHECK-INSERIMENTO>
      * MODIFICA LA STATUS-BAR
      * CONTROLLO SE DA INSERIMENTO SCORRO. ALLORA DEVO SEGNALARE CHE
      * SONO TORNATO IN MODIFICA.
           inquire tool-modifica, value in mod.

           evaluate mod
           when 1  
                set StatusModifica to true
           when 0
                set StatusVisua    to true   
           end-evaluate.
      
           perform STATUS-BAR-MSG 
           .
      * <TOTEM:END>

       CHECK-WOD.
      * <TOTEM:PARA. CHECK-WOD>
           accept  como-data from century-date.
           accept  como-ora  from time.
           accept  path-tmp-superset from environment "PATH_ST".
           inspect path-tmp-superset replacing trailing spaces by 
           low-value.
           string  path-tmp-superset delimited low-value
                   "tmp-superset_"   delimited size
                   como-data         delimited size
                   "_"               delimited size
                   como-ora          delimited size
              into path-tmp-superset
           end-string.                                                  
                 
           inspect path-tmp-superset replacing trailing low-value by 
           spaces.
           open output tmp-superset.    
           close       tmp-superset.
           open i-o    tmp-superset.
           
           set tutto-ok to true.
           move low-value to tex-key.
           start tmp-exe key >= tex-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-exe next at end exit perform end-read
                    if tex-ss = 0
                       exit perform cycle
                    end-if
                    move tex-day to tss-day
                    move tex-ss  to tss-ss
                    read tmp-superset 
                         invalid 
                         initialize tss-data replacing numeric data by 
           zeroes
                                                  alphanumeric data by 
           spaces
                    end-read
                    add 1 to tss-exe
                    move tex-split to tss-split-el(tss-exe)
                    write tss-rec invalid rewrite tss-rec end-write
                 end-perform
           end-start.

           move low-value to tss-key
           start tmp-superset key >= tss-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-superset next at end exit perform end-read
                    if tss-exe < 2
                       set errori to true
                       display message "Sistemare il superset del giorno
      -    " " tss-day"."
                                x"0d0a""La sequenza della serie " 
           tss-ss " ha 1 solo esercizio."
                                 title tit-err
                                  icon 2
                       exit perform
                    end-if
                 end-perform
           end-start.

           if tutto-ok
              move low-value to tss-key
              start tmp-superset key >= tss-key
                    invalid continue
                not invalid
                    perform until 1 = 2
                       read tmp-superset next at end exit perform 
           end-read
                       perform varying idx from 1 by 1 
                                 until idx = tss-exe
                          add 1 to tss-split-el(idx) giving como-split
                          if como-split not = tss-split-el(idx + 1)
                             set errori to true
                             display message "Sistemare il superset del 
      -    "giorno " tss-day
                                      x"0d0a""La serie " tss-ss " non è 
      -    "in sequenza."
                                       title tit-err
                                        icon 2
                             exit perform
                          end-if
                       end-perform
                       if errori exit perform end-if
                    end-perform
              end-start
           end-if.

           close       tmp-superset.
           delete file tmp-superset 
           .
      * <TOTEM:END>

       CONTROLLO.
      * <TOTEM:PARA. CONTROLLO>
      *     set tutto-ok to true. 
      *
      *     evaluate CONTROL-ID
      *     when 78-ID-ef-cliente
      *          perform RIEMPI-CHIAVE           
      *          if ef-cliente-buf not = spaces
      *             read tschede no lock key tsc-k-cliente
      *                  invalid
      *                  if vecchio
      *                     display message MSG-record-inesistente
      *                               title tit-err
      *                                icon 2
      *                     perform CLEAR-SCREEN
      *                     set errori to true
      *                  else
      *                     perform DISPLAY-CLIENTE
      *                     display form1
      *                  end-if
      *              not invalid      
      *                  if old-tsc-chiave not = tsc-chiave or mod = 0
      *                     perform CURRENT-RECORD 
      *                  end-if
      *             end-read
      *
      *          else
      *             set errori to true  
      *             move 78-ID-ef-cliente to control-id
      *             display message box MSG-record-inesistente
      *                     title = tit-err
      *                     icon mb-warning-icon
      *          end-if
      *          if errori
      *             move 78-ID-ef-cliente to control-id
      *             move 4               to accept-control
      *          end-if
      *
      *     end-evaluate.
      *
      *     if errori
      *        perform CANCELLA-COLORE
      *        move CONTROL-ID to store-id
      *        move 4          to ACCEPT-CONTROL
      *     end-if 
           .
      * <TOTEM:END>

       CONTROLLO-DATE.
      * <TOTEM:PARA. CONTROLLO-DATE>
           evaluate control-id
           when 78-ID-ef-gg1
                inquire ef-gg1, enabled e-gg1, value ef-gg1-buf
                if e-gg1 = 1
                   move ef-gg1-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg1-buf
                   display ef-gg1
                end-if        
           when 78-ID-ef-gg2
                inquire ef-gg2, enabled e-gg2, value ef-gg2-buf
                if e-gg2 = 1
                   move ef-gg2-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg2-buf
                   display ef-gg2
                end-if      
           when 78-ID-ef-gg3
                inquire ef-gg3, enabled e-gg3, value ef-gg3-buf
                if e-gg3 = 1
                   move ef-gg3-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg3-buf
                   display ef-gg3
                end-if      
           when 78-ID-ef-gg4
                inquire ef-gg4, enabled e-gg4, value ef-gg4-buf
                if e-gg4 = 1
                   move ef-gg4-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg4-buf
                   display ef-gg4
                end-if      
           when 78-ID-ef-gg5
                inquire ef-gg5, enabled e-gg5, value ef-gg5-buf
                if e-gg5 = 1
                   move ef-gg5-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg5-buf
                   display ef-gg5
                end-if      
           when 78-ID-ef-gg6
                inquire ef-gg6, enabled e-gg6, value ef-gg6-buf
                if e-gg6 = 1
                   move ef-gg6-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg6-buf
                   display ef-gg6
                end-if      
           when 78-ID-ef-gg7
                inquire ef-gg7, enabled e-gg7, value ef-gg7-buf
                if e-gg7 = 1
                   move ef-gg7-buf to como-data
                   perform DATE-FORMAT
                   move como-data to ef-gg7-buf
                   display ef-gg7
                end-if
           end-evaluate 
           .
      * <TOTEM:END>

       CONTROLLO-RIGA.
      * <TOTEM:PARA. CONTROLLO-RIGA>
           set tutto-ok to true.
           if mod = 0 
              exit paragraph 
           end-if.
      
           evaluate colonna
           when 78-col-day
                inquire gd1(riga, 78-col-day), hidden-data hiddenData
                                                 cell-data col-day
                if hid-tex-day not = 0
                   if col-day = 0                 
                      perform ELIMINA-RIGA  
                      perform RELOAD-GRID   
                   else
                      if col-day not = hid-tex-day
                         move hid-tex-day to col-day
                         modify gd1(riga, 78-col-day), cell-data col-day
                      end-if
                   end-if
                end-if
           when 78-col-series
                inquire gd1(riga, 78-col-series), cell-data in 
           col-series
                if col-series = 0
                   set event-action to event-action-fail
                else
                   inquire gd1(riga, 78-col-day), hidden-data hiddenData
                   move hid-tex-key to tex-key
                   read tmp-exe
                   move col-series to tex-series
                   rewrite tex-rec
                   perform RICALCOLA-HIT-DIV  
                   perform RELOAD-GRID       
                end-if
           when 78-col-reps
                inquire gd1(riga, 78-col-reps), cell-data in col-reps
                if col-reps = spaces
                   set event-action to event-action-fail
                else     
                   inquire gd1(riga, 78-col-day), hidden-data hiddenData
                   move hid-tex-key to tex-key
                   read tmp-exe
                   move col-reps to tex-reps
                   rewrite tex-rec          
                end-if 
           when 78-col-ss
                inquire gd1(riga, 78-col-ss), cell-data col-ss
                modify  gd1(riga, 78-col-ss), cell-data col-ss  
                inquire gd1(riga, 78-col-day), hidden-data hiddenData
                move hid-tex-key to tex-key
                read tmp-exe
                move col-ss to tex-ss
                rewrite tex-rec
                perform RELOAD-GRID
           end-evaluate 
           .
      * <TOTEM:END>

       CONTROLLO-FILTRO.
      * <TOTEM:PARA. CONTROLLO-FILTRO>
           set tutto-ok to true.
           evaluate control-id
           when 78-ID-ef-des continue

           when 78-ID-ef-dta-from
                inquire ef-dta-from value in como-data
                if como-data > 0
                   perform DATE-FORMAT
                   move como-data to ef-dta-from-buf
                   display ef-dta-from
                end-if

           when 78-ID-ef-dta-to  
                inquire ef-dta-to value in como-data
                if como-data > 0
                   if como-data not = 99999999
                      perform DATE-FORMAT
                      move como-data to ef-dta-to-buf
                      display ef-dta-to  
                   end-if
                else
                   move 99999999 to  ef-dta-to-buf
                   display ef-dta-to
                end-if                              
                inquire ef-dta-from value in como-data
                perform DATE-TO-FILE
                move como-data to como-data-from    
                inquire ef-dta-to value in como-data
                perform DATE-TO-FILE
                move como-data to como-data-to
                if como-data-to < como-data-from
                   display message "Range date errato"
                             title tit-err
                              icon 2
                   move 78-ID-ef-dta-from to control-id
                   set errori to true
                end-if

           when 78-ID-ef-dtc-from   
                inquire ef-dtc-from value in como-data
                if como-data > 0
                   perform DATE-FORMAT
                   move como-data to ef-dtc-from-buf
                   display ef-dtc-from
                end-if
           when 78-ID-ef-dtc-to  
                inquire ef-dtc-to value in como-data
                if como-data > 0
                   if como-data not = 99999999
                      perform DATE-FORMAT
                      move como-data to ef-dtc-to-buf
                      display ef-dtc-to
                   end-if
                else
                   move 99999999 to  ef-dtc-to-buf
                   display ef-dtc-to
                end-if                              
                inquire ef-dtc-from value in como-data
                perform DATE-TO-FILE
                move como-data to como-data-from    
                inquire ef-dtc-to value in como-data
                perform DATE-TO-FILE
                move como-data to como-data-to
                if como-data-to < como-data-from
                   display message "Range date errato"
                             title tit-err
                              icon 2
                   move 78-ID-ef-dtc-from to control-id 
                   set errori to true
                end-if

           when 78-ID-ef-map
                inquire ef-map, value in wom-code
                if wom-code = 0
                   move "Tutte le mappature" to wom-desc
                else
                   read wodmap no lock
                        invalid                 
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to wom-desc
                        set errori to true
                   end-read
                end-if
                move wom-desc to lab-map-buf
                display lab-map

           when 78-ID-ef-exe   
                inquire ef-exe, value in exe-code
                if exe-code = spaces
                   move "Tutti gli esercizi" to exe-desc
                else
                   read exercises no lock
                        invalid              
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to exe-desc  
                        set errori to true
                   end-read
                end-if
                move exe-desc to lab-exe-buf
                display lab-exe

           when 78-ID-ef-mul
                inquire ef-mul, value in mcg-code
                if mcg-code = spaces
                   move "Tutti i gruppi" to mcg-desc
                else
                   read macrogroups no lock
                        invalid               
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to mcg-desc   
                        set errori to true
                   end-read
                end-if
                move mcg-desc to lab-mul-buf
                display lab-mul
                                
           when 78-ID-ef-rep    
                inquire ef-rep, value in mcg-code
                if mcg-code = spaces
                   move "Tutti i gruppi" to mcg-desc
                else
                   read macrogroups no lock
                        invalid           
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to mcg-desc   
                        set errori to true
                   end-read
                end-if
                move mcg-desc to lab-rep-buf
                display lab-rep

           when 78-ID-ef-gss   
                inquire ef-gss, value in mcg-code
                if mcg-code = spaces
                   move "Tutti i gruppi" to mcg-desc
                else
                   read macrogroups no lock
                        invalid       
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to mcg-desc  
                        set errori to true
                   end-read
                end-if
                move mcg-desc to lab-gss-buf
                display lab-gss       

           when 78-ID-ef-mcg
                inquire ef-mul, value in mcg-code
                if mcg-code = spaces
                   move "Tutti i gruppi" to mcg-desc
                else
                   read macrogroups no lock
                        invalid     
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to mcg-desc    
                        set errori to true
                   end-read
                end-if
                move mcg-desc to lab-mcg-buf
                display lab-mcg

           when 78-ID-cb-eff
                inquire cb-eff, value in cb-eff-buf
                move 0 to como-effort
                evaluate cb-eff-buf                          
                when "Light wod effort"  move 1 to como-effort
                when "Medium wod effort" move 2 to como-effort
                when "Heavy wod effort"  move 3 to como-effort
                end-evaluate

           when 78-ID-ef-dur
                inquire ef-dur, value in dur-code
                if dur-code = 0
                   move "Tutte le durate" to dur-desc
                else
                   read duration no lock
                        invalid     
                        display message "Valore errato"
                                  title tit-err
                                   icon 2
                        move spaces to dur-desc    
                        set errori to true
                   end-read
                end-if
                move dur-desc to lab-dur-buf
                display lab-dur

           end-evaluate.

           if errori
              move 4 to accept-control
           end-if 
           .
      * <TOTEM:END>

       CREA-OCCURS-GRUPPI.
      * <TOTEM:PARA. CREA-OCCURS-GRUPPI>
           initialize tab-mgroups replacing numeric data by zeroes
                                       alphanumeric data by spaces.

           move 0 to idx-gruppi.
                        
           inquire cb-gio, value in cb-gio-buf.
           inquire cb-dur, value in dur-desc.
           read duration key dur-k-desc.
                                             
           inquire cb-mg1, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.                                  
           inquire cb-mg2, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.                                  
           inquire cb-mg3, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.                                  
           inquire cb-mg4, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.                                  
           inquire cb-mg5, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.
           inquire cb-mg6, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.
           inquire cb-mg7, value in mcg-desc.
           perform ADD-ELEM-GRUPPO.       
                                     
           modify lab-a, color = 513.
           modify lab-b, color = 513.
           modify lab-c, color = 513.
           modify lab-d, color = 513.
           modify lab-e, color = 513.
           modify lab-f, color = 513.
           modify lab-g, color = 513.


      ***---
       ADD-ELEM-GRUPPO.
           read macrogroups key  mcg-k-desc 
                invalid continue
            not invalid 
                add 1 to idx-gruppi                   
                move mcg-desc    to el-mgroup(idx-gruppi)  
                move mcg-code    to el-mcg-code(idx-gruppi)
           end-read.
           move idx-gruppi to tot-gruppi 
           .
      * <TOTEM:END>

       CREA-TMP-GRP-EXE.
      * <TOTEM:PARA. CREA-TMP-GRP-EXE>
           accept  path-tmp-grp-exe from environment "PATH_ST".
           accept como-data from century-date.
           accept como-ora  from time.
           inspect path-tmp-grp-exe replacing trailing spaces by 
           low-value.
           string  path-tmp-grp-exe delimited low-value
                   "tmp-grp-exe_"   delimited size
                   como-data        delimited size
                   "_"              delimited size
                   como-ora         delimited size
              into path-tmp-grp-exe
           end-string.                                                  
                 
           inspect path-tmp-grp-exe replacing trailing low-value by 
           spaces.
           open output tmp-grp-exe.    
           close       tmp-grp-exe.
           open i-o    tmp-grp-exe.

           move el-mcg-code(idx) to mcg-code.
                       
           move low-value to tex-rec.
           move mcg-code  to tex-mcg-code.
           start tmp-exe key >= tex-k-mcg
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-exe next at end exit perform end-read   
                    
                    if tex-mcg-code not = mcg-code
                       exit perform
                    end-if

                    move tex-exe-code to exe-code
                    read exercises
                    move exe-grp-code to grp-code
                    read groups                                   

                    move tex-day    to tge-day
                    move grp-desc   to tge-grp-desc 
                    move exe-desc   to tge-exe-desc
                    move tex-series to tge-series
                    inspect tge-series replacing leading x"30" by x"20"
                    call "C$JUSTIFY" using tge-series, "L"
                    move tex-reps   to tge-reps  
                    move 0 to tge-prg
                    write tge-rec 
                 end-perform
           end-start.         
                    
           move spaces to como-nome.
           move 0      to tot-series store-riga.  
           move low-value to tge-key.
           start tmp-grp-exe key >= tge-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-grp-exe next 
                      at end perform RIGA-TOT
                             exit perform
                    end-read                 
                    if como-nome = spaces
                       move tge-grp-desc to como-nome
                    end-if
                    if como-nome not = tge-grp-desc     
                       move tge-grp-desc to grp-desc  
                       move tge-exe-desc to exe-desc
                       move tge-day      to save-day
                       perform RIGA-TOT                  
                       move grp-desc to tge-grp-desc  
                       move exe-desc to tge-exe-desc
                       move save-day to tge-day  
                       start tmp-grp-exe key >= tge-key
                             invalid exit perform
                       end-start
                       read tmp-grp-exe next
                       move 0 to tot-series
                       move tge-grp-desc to como-nome
                    end-if                      
                    add 1 to store-riga
                    move store-riga to tge-prg
                    rewrite tge-rec           
                    call "C$JUSTIFY" using tge-series; "R"
                    inspect tge-series replacing leading x"20" by x"30"
                    move tge-series  to como-series
                    add como-series  to tot-series
                 end-perform
           end-start.        
                                            
           close  tmp-grp-exe.    

           move path-tmp-grp-exe to ext-file
           move "tmp-grp-exe"    to Como-File
           call   "zoom-gt"   using como-file, tge-rec
                             giving stato-zoom
           cancel "zoom-gt".
                              
           delete file tmp-grp-exe.

      ***---
       RIGA-TOT.                 
           add 1 to store-riga.      
           initialize tge-rec replacing numeric data by zeroes
                                   alphanumeric data by spaces.
           move store-riga to tge-prg.
      *     move "TOTALE"   to tge-grp-desc.
           move spaces     to tge-day.
           initialize tge-exe-desc.
           string "TOT "    delimited size
                  como-nome delimited size
             into tge-exe-desc
           end-string.
           call "C$TOUPPER" using tge-exe-desc, value 100
           move tot-series to tge-series.                          
           inspect tge-series replacing leading x"30" by x"20".
           call "C$JUSTIFY" using tge-series, "L".
           write tge-rec 
           .
      * <TOTEM:END>

       CURRENT-RECORD.
      * <TOTEM:PARA. CURRENT-RECORD>
           move 0 to tot-gruppi.
           read twodbook
                invalid continue
            not invalid       
                modify pb-mod, enabled true
                perform OPEN-TMP  
                move tod-wom-code to wom-code
                read wodmap no lock
                modify cb-wod, value wom-desc
                
                perform varying idx from 1 by 1 
                          until idx > 7
                   if tod-el-mcg-code(idx) = spaces
                      exit perform
                   end-if
                   move tod-el-mcg-code(idx) to mcg-code
                                             el-mcg-code(idx)
                   read macrogroups
                   evaluate idx                                     
                   when 1 modify cb-mg1, value mcg-desc
                   when 2 modify cb-mg2, value mcg-desc
                   when 3 modify cb-mg3, value mcg-desc
                   when 4 modify cb-mg4, value mcg-desc
                   when 5 modify cb-mg5, value mcg-desc
                   when 6 modify cb-mg6, value mcg-desc
                   when 7 modify cb-mg7, value mcg-desc
                   end-evaluate
                   add 1 to tot-gruppi            
                end-perform  
                modify cb-mul, value "Si"
                modify cb-int, value "Tutto"
                modify cb-dur, value "Tutto"
                modify cb-gio, value "Tutto"
                move spaces to s-cb-mg1-buf
                perform VALORIZZA-WOD  
                move tod-wom-code to wom-code
                read wodmap no lock
                modify cb-wod, value wom-desc
                set reloadGrid to true
                perform ABILITA-MACROGRUPPI  
                set reloadGrid to false
                move tod-desc to lab-desc-buf
                display lab-desc
                move tod-code to lab-code-buf s-tod-code
                display lab-code

                move low-value to rod-key
                move tod-code  to rod-code
                start rwodbook key >= rod-key
                      invalid continue
                  not invalid
                      perform until 1 = 2
                         read rwodbook next no lock at end exit perform 
           end-read
                         if rod-code not = tod-code
                            exit perform
                         end-if             
                         move rod-day to como-data
                         perform DATE-TO-SCREEN
                         move como-data to como-data-x10
                         compute riga = rod-prg-day * 2 + 1
                         modify gd-schema(riga, 12), cell-data 
           como-data-x10
                
                         move rod-prg-day          to tex-day
                         move rod-split            to tex-split
                         move rod-mcg-code         to tex-mcg-code      
             
                         move rod-exe-code         to tex-exe-code 
           exe-code
                         read exercises no lock
                              invalid move "NON TROVATA" to exe-desc
                         end-read                              
                         move rod-desc-univoca     to tex-desc-univoca
                         move exe-desc             to tex-exe-desc      
             
                         move rod-int-code         to tex-int-code      
             
                         move rod-exe-isMulti      to tex-exe-isMulti   
             
                         move rod-reps             to tex-reps          
             
                         move rod-series           to tex-series        
             
                         move rod-int-restpause    to tex-int-restpause 
             
                         move rod-ss               to tex-ss
                         move rod-dati-modwod      to 
           tex-rod-dati-modwod
                         move rod-note             to tex-rod-note
                         write tex-rec
                      end-perform             
                      perform RELOAD-GRID
                end-start
           end-read.
           perform RICALCOLA-HIT-DIV.
           perform CALCOLA-HIT-BOTTONI.
           move cb-mg1-buf to s-cb-mg1-buf.
           move cb-mg2-buf to s-cb-mg2-buf.
           move cb-mg3-buf to s-cb-mg3-buf.
           move cb-mg4-buf to s-cb-mg4-buf.
           move cb-mg5-buf to s-cb-mg5-buf.
           move cb-mg6-buf to s-cb-mg6-buf.
           move cb-mg7-buf to s-cb-mg7-buf.
           move cb-mul-buf to s-cb-mul-buf.
           move cb-int-buf to s-cb-int-buf.
           move cb-dur-buf to s-cb-dur-buf.
           move cb-gio-buf to s-cb-gio-buf.
           move cb-wod-buf to s-cb-wod-buf.

           move 1 to e-cancella.
           modify tool-cancella, enabled e-cancella 
           .
      * <TOTEM:END>

       DATI-DEFAULT.
      * <TOTEM:PARA. DATI-DEFAULT>
           modify cb-mg1, value "Nessuno".
           modify lab-a, color  513, font Calibri14-Occidentale.
           modify cb-mg2, value "Nessuno".
           modify lab-b, color  513, font Calibri14-Occidentale.
           modify cb-mg3, value "Nessuno".
           modify lab-c, color  513, font Calibri14-Occidentale.
           modify cb-mg4, value "Nessuno".
           modify lab-d, color  513, font Calibri14-Occidentale.
           modify cb-mg5, value "Nessuno".
           modify lab-e, color  513, font Calibri14-Occidentale.
           modify cb-mg6, value "Nessuno".
           modify lab-f, color  513, font Calibri14-Occidentale.
           modify cb-mg7, value "Nessuno".
           modify lab-g, color  513, font Calibri14-Occidentale.

           modify cb-mul,  value "Si".

           modify pb-mod, enabled false.
           move 0 to tod-code.
                                          
           modify cb-int, value "Tutto".
           modify cb-dur, value "Tutto".
           modify cb-wod, value "Nessuno".

           modify cb-gio, value "Tutto".
                                        
           modify cb-mg1, enabled false.
           modify cb-mg2, enabled false.
           modify cb-mg3, enabled false.
           modify cb-mg4, enabled false.
           modify cb-mg5, enabled false.
           modify cb-mg6, enabled false.
           modify cb-mg7, enabled false.
           
           perform VALORIZZA-WOD.
                                         
           modify pb-mcg1, enabled false, title "Mai".
           modify pb-mcg2, enabled false, title "Mai".
           modify pb-mcg3, enabled false, title "Mai".
           modify pb-mcg4, enabled false, title "Mai".
           modify pb-mcg5, enabled false, title "Mai".
           modify pb-mcg6, enabled false, title "Mai".
           modify pb-mcg7, enabled false, title "Mai". 
                                     
           modify lab-a, color = 513.
           modify lab-b, color = 513.
           modify lab-c, color = 513.
           modify lab-d, color = 513.
           modify lab-e, color = 513.
           modify lab-f, color = 513.
           modify lab-g, color = 513.

           move "Tutti" to s-cb-wod-buf.

           modify gd1, reset-grid = 1.
           perform GD1-CONTENT.
           move 0 to mod.
           perform ABILITAZIONI.

           modify gd-schema, reset-grid = 1.
           perform GD-SCHEMA-CONTENT.    

           modify pb-genera, enabled false.  
                                  
           move spaces to lab-desc-buf.
           display lab-desc.
           move 0 to lab-code-buf.
           display lab-code.
                                           
           modify pb-random,     enabled false.
           modify pb-ripristino, enabled false.
           modify tool-cancella, enabled false 
           .
      * <TOTEM:END>

       ELIMINA-RIGA.
      * <TOTEM:PARA. ELIMINA-RIGA>
           inquire gd1(riga, 78-col-day), hidden-data hiddenData.
           inquire gd1(riga, 78-col-day), cell-data col-day.
           move hid-tex-key to tex-key.
           delete tmp-exe record.
           modify gd1, record-to-delete = riga.
                        
           move 0 to idx1.
           initialize como-tex-data-tab.
           move tex-day to como-giorno.
           move low-value to tex-split.
           start tmp-exe key >= tex-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-exe next at end exit perform end-read
                    if tex-day not = como-giorno
                       exit perform
                    end-if
                    add 1 to idx1
                    move tex-data to como-tex-data-el(idx1)
                    delete tmp-exe record
                end-perform
           end-start.
     
           if idx > 0
              perform varying idx from 1 by 1 
                        until idx > idx1
                 move como-giorno to tex-day
                 move idx         to tex-split
                 move como-tex-data-el(idx) to tex-data
                 write tex-rec
              end-perform
           end-if.

           perform RICALCOLA-HIT-DIV.
           perform CALCOLA-HIT-BOTTONI         
           .
      * <TOTEM:END>

       EVIDENZIA-GRUPPI.
      * <TOTEM:PARA. EVIDENZIA-GRUPPI>
           inquire gd1, last-row in tot-righe, 
           modify gd1, mass-update = 1.
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd1(riga, 1), hidden-data in hiddenData
              if hid-mcg-code = el-mcg-code(idx)
                 modify gd1(riga), row-font = Calibri12B-Occidentale,
                                   row-color = el-mcg-color(idx)
              end-if
           end-perform.
           modify gd1, mass-update = 0 
           .
      * <TOTEM:END>

       GENERA-WOD.
      * <TOTEM:PARA. GENERA-WOD>
           perform OPEN-TMP.
           move "Creo i gruppi" to lab-attesa-buf.
           display lab-attesa
           perform CREA-OCCURS-GRUPPI.
                                         
           move 0 to int-effort.
           inquire cb-int, value in cb-int-buf.
           evaluate cb-int-buf
           when "Light wod effort" move 1  to effort-wod
           when "Light wod effort" move 2  to effort-wod
           when "Light wod effort" move 3  to effort-wod
           when other              move 99 to effort-wod
           end-evaluate.
            
           inquire cb-wod, value in wom-desc.
           read wodmap key wom-k-desc.
                                         
           modify pb-mcg1, enabled false, title "Mai".
           modify pb-mcg2, enabled false, title "Mai".
           modify pb-mcg3, enabled false, title "Mai".
           modify pb-mcg4, enabled false, title "Mai".
           modify pb-mcg5, enabled false, title "Mai".
           modify pb-mcg6, enabled false, title "Mai".
           modify pb-mcg7, enabled false, title "Mai".  
                                     
           modify lab-a, color = 513.
           modify lab-b, color = 513.
           modify lab-c, color = 513.
           modify lab-d, color = 513.
           modify lab-e, color = 513.
           modify lab-f, color = 513.
           modify lab-g, color = 513.
                                  
           modify gd1, reset-grid = 1.
           perform GD1-CONTENT.
                                     
           initialize tex-rec replacing numeric data by zeroes 
                                   alphanumeric data by spaces.         
                                 
           perform LOAD-EXERCISES-ALLOWED-BY-EFFORT. 
           perform LOAD-EXERCISES-MULTIJOINT.
           perform LOAD-EXERCISES.                   
           perform REMOVE-DUPLICATES.
           move "Carico la griglia" to lab-attesa-buf.
           display lab-attesa.
           perform LOAD-GRID.          
           move "Calcolo coperture" to lab-attesa-buf.
           display lab-attesa
           perform CALCOLA-HIT-BOTTONI.
                                  
           move cb-mg1-buf to s-cb-mg1-buf.
           move cb-mg2-buf to s-cb-mg2-buf.
           move cb-mg3-buf to s-cb-mg3-buf.
           move cb-mg4-buf to s-cb-mg4-buf.
           move cb-mg5-buf to s-cb-mg5-buf.
           move cb-mg6-buf to s-cb-mg6-buf.
           move cb-mg7-buf to s-cb-mg7-buf.
           move cb-mul-buf to s-cb-mul-buf.
           move cb-int-buf to s-cb-int-buf.
           move cb-dur-buf to s-cb-dur-buf.
           move cb-gio-buf to s-cb-gio-buf.
           move cb-wod-buf to s-cb-wod-buf.
            
      ***---
       OPEN-TMP. 
           close       tmp-exe.
           open output tmp-exe.
           close       tmp-exe.
           open i-o    tmp-exe.

           close       tmp-hit.
           open output tmp-hit.
           close       tmp-hit.
           open i-o    tmp-hit.

           close       tmp-exe-effort.    
           open output tmp-exe-effort.    
           close       tmp-exe-effort.
           open i-o    tmp-exe-effort.

           close       tmp-wod-exe.
           open output tmp-wod-exe.
           close       tmp-wod-exe.
           open i-o    tmp-wod-exe.

           close       tmp-exe-dupl.    
           open output tmp-exe-dupl.    
           close       tmp-exe-dupl.
           open i-o    tmp-exe-dupl.                               
      
      ***---
       LOAD-GRID.
           move low-value to tex-rec.
           move 0 to save-day col-exe-prg.
           start tmp-exe key >= tex-key
                 invalid continue 
             not invalid
                 move 1 to riga
                 perform until 1 = 2
                    read tmp-exe next 
                      at end 
                         perform RIGA-DIV
                         perform DISPLAY-DURATA
                         exit perform 
                    end-read    
                    if save-day = 0                    
                       move 0 to tot-durata tot-exe tot-series
                       move tex-day to save-day
                    end-if
                    if tex-day not = save-day  
                       perform RIGA-DIV
                       move 0 to tot-exe tot-series
                       perform DISPLAY-DURATA
                       move 0 to col-exe-prg tot-durata
                       move tex-day to save-day
                    end-if   
                    move tex-split to col-exe-prg
                    add 1 to tot-exe
                    move tex-day to col-day
                    move tex-exe-code to exe-code
                    read exercises
                    move exe-grp-code to col-grp-code grp-code
                    read groups
                    move grp-desc to col-grp-desc
                    move tex-exe-code to col-exe-code
                    move tex-exe-desc to col-exe-desc
                                         
                    move wom-split-el-split-int-code(tex-day, tex-split)
                      to int-code
                    read intexe

                    if reloadGrid
                       move tex-ss       to col-ss
                       move tex-int-code to int-code
                       read intexe
                       move tex-series to col-series
                       move tex-reps   to col-reps
                    else                      
                       move wom-split-el-split-ss(tex-day, tex-split)
                         to tex-ss col-ss
                       perform IMPOSTA-SERIES-REPS
                    end-if
                    add 1 to riga                                
                    modify gd1(riga, 78-col-day),      cell-data = 
           col-day
                    modify gd1(riga, 78-col-prg),      cell-data = 
           col-exe-prg
                    modify gd1(riga, 78-col-grp-code), cell-data = 
           col-grp-code
                    modify gd1(riga, 78-col-grp-desc), cell-data = 
           col-grp-desc
                    modify gd1(riga, 78-col-exe-code), cell-data = 
           col-exe-code
                    modify gd1(riga, 78-col-exe-desc), cell-data = 
           col-exe-desc
                    modify gd1(riga, 78-col-ss),       cell-data = 
           col-ss
                    if col-series = 0
                       modify gd1(riga, 78-col-series),   cell-data = 
           spaces
                    else
                       modify gd1(riga, 78-col-series),   cell-data = 
           col-series
                    end-if
                    modify gd1(riga, 78-col-reps),     cell-data = 
           col-reps

                    add col-series to tot-series

                    move col-reps   to tex-reps
                    move col-series to tex-series
                    rewrite tex-rec

                    move int-restpause to hid-restpause
                    move col-day       to hid-tex-day
                    move tex-split     to hid-tex-split
                    move grp-mcg-code  to hid-mcg-code
                    modify gd1(riga, 78-col-day), hidden-data hiddenData

                    if int-isSqueeze = 1
                       move 10 to sec-squeeze
                    else
                       move 0  to sec-squeeze
                    end-if
                                               
                    if tex-ss = 0
                       compute tot-durata  = tot-durata +
                             ( exe-setting ) +
                             ( exe-setting * 0,5 ) +
                             ( col-series  * int-time  ) +
                             ( int-rest    * ( col-series - 1 ) ) +
                             ( sec-squeeze * col-series ) + 
                             30 |Ipotetico rest tra una e l'altra
                    else
                       compute tot-durata  = tot-durata +
                             ( exe-setting * 2 ) +
                             ( col-series  * int-time  ) +
                             ( sec-squeeze * col-series ) + 
                             ( int-rest / 2) 
                    end-if

                    move tex-day      to th-day
                    move tex-mcg-code to th-mcg-code
                    write th-rec invalid rewrite th-rec end-write

                 end-perform
           end-start.    
                                  
           inquire gd1, last-row in tot-righe.
           if tot-righe > 1
              move 1 to mod
           else
              move 0 to mod
           end-if.         
           perform ABILITAZIONI.

      ***---
       RIGA-DIV.                 
           move 0 to schema-exe.
           perform varying idx from 1 by 1 
                     until idx > 20
              if wom-split-el-split-sigla(save-day, idx) = spaces
                 exit perform
              end-if
              add 1 to schema-exe
           end-perform.   
           add 1 to riga.           
           move riga to riga-div.
           perform VALORI-RIGA-DIV.
           move schema-exe to hid-tot-exe.
           modify gd1(riga-div, 78-col-day), hidden-data hid-tot-exe.

      ***---
       DISPLAY-DURATA.
           initialize como-durata.
           if tot-durata > 3600
              divide tot-durata by 3600 giving hh remainder resto
              if resto > 0
                 if resto >= 60
                    compute mm = resto / 60
                 else
                    move 0 to mm
                 end-if
              else
                 move 0 to mm 
              end-if
              move mm to como-mm
              inspect como-mm replacing leading x"30" by x"20"
              call "C$JUSTIFY" using como-mm, "L"                   
              inspect como-mm replacing trailing spaces by low-value

              move hh to como-hh
              inspect como-hh replacing leading x"30" by x"20"
              call "C$JUSTIFY" using como-hh, "L"
              inspect como-hh replacing trailing spaces by low-value
                    
              if hh = 1             
                 move "ora" to como-ora-e
              else
                 move "ore" to como-ora-e
              end-if

              if mm = 1             
                 move "minuto" to como-minuto-i
              else
                 move "minuti" to como-minuto-i
              end-if

              string  como-hh       delimited low-value
                      " "           delimited size
                      como-ora-e    delimited size
                      " "           delimited size
                      como-mm       delimited low-value
                      " "           delimited size
                      como-minuto-i delimited size
                 into como-durata
              end-string
           else
              compute mm = tot-durata / 60
              move mm to como-mm
              inspect como-mm replacing leading x"30" by x"20"
              call "C$JUSTIFY" using como-mm, "L"
              inspect como-mm replacing trailing spaces by low-value

              if mm = 1             
                 move "minuto" to como-minuto-i
              else
                 move "minuti" to como-minuto-i
              end-if

              string  como-mm       delimited low-value
                      " "           delimited size
                      como-minuto-i delimited size
                 into como-durata
              end-string
           end-if.

           evaluate save-day
           when 1 modify gd-schema( 2, 12), cell-data como-durata
           when 2 modify gd-schema( 4, 12), cell-data como-durata
           when 3 modify gd-schema( 6, 12), cell-data como-durata
           when 4 modify gd-schema( 8, 12), cell-data como-durata
           when 5 modify gd-schema(10, 12), cell-data como-durata
           when 6 modify gd-schema(12, 12), cell-data como-durata
           when 7 modify gd-schema(14, 12), cell-data como-durata
           end-evaluate.
                                                    
      ***---     
       LOAD-EXERCISES-ALLOWED-BY-EFFORT.
           move "Carico gli esercizi" to lab-attesa-buf.
           display lab-attesa
           
           move low-value to exe-key.
           start exercises key >= exe-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read exercises next at end exit perform end-read

                    if exe-isDisable = 1 exit perform cycle end-if
                    move exe-int-code to int-code
                    read intexe no lock
                    move exe-grp-code to grp-code
                    read groups no lock

                    if exe-isMulti = 1 and cb-mul-buf = "No"
                       exit perform cycle
                    end-if
                    if int-effort <= effort-wod or 
                       exe-isMulti = 1 and cb-mul-buf = "Si"
                       perform varying idx-gruppi from 1 by 1 
                                 until idx-gruppi > tot-gruppi

                          if el-mcg-code(idx-gruppi) = grp-mcg-code
                             move exe-code      to twe-exe-code
                             move exe-desc      to twe-exe-desc
                             move grp-mcg-code  to twe-mcg-code
                             move int-effort    to twe-effort
                             move exe-isMulti   to twe-exe-isMulti
                             move exe-int-code  to twe-int-code
                             move exe-isRestpause to twe-exe-isRestpause
                             write twe-rec 
                          end-if
                       end-perform
                    end-if
                 end-perform
           end-start.           
       
      ***---
       LOAD-EXERCISES-MULTIJOINT.                  
           if cb-mul-buf = "No" exit paragraph end-if.
           
           move "Carico i multiarticolari" to lab-attesa-buf.
           display lab-attesa
           
                                    
           perform varying idx-gruppi from 1 by 1 
                     until idx-gruppi > tot-gruppi
              move low-value to twe-rec
              move el-mcg-code(idx-gruppi) to twe-mcg-code
              set twe-exe-isMulti-yes to true
              move 0 to tot-exe 

              start tmp-wod-exe key >= twe-key
                    invalid continue
                not invalid
                    perform until 1 = 2        
                       read tmp-wod-exe next
                         at end exit perform 
                       end-read           
                                                 
                       if twe-mcg-code not = el-mcg-code(idx-gruppi) or
                          twe-exe-isMulti = 0
                          exit perform
                       end-if
                       add 1 to tot-exe    
                       move twe-exe-code      to el-exe-code(tot-exe)
                       move twe-exe-desc      to el-exe-desc(tot-exe)
                       move 0                 to el-exe-used(tot-exe)
                    end-perform
              end-start

             |Phase 2
              if tot-exe > 0
                 move tot-exe to ex-remain  
                 perform varying idx-days from 1 by 1 
                           until idx-days > wom-days

                    perform varying idx-split from 1 by 1 
                              until idx-split > 20
                       
                       if wom-split-el-split-sigla(idx-days, idx-split) 
            = space
                          exit perform
                       end-if

                       evaluate wom-split-el-split-sigla(idx-days, 
           idx-split)
                       when el-mcg-sigla(1) move el-mcg-code(1) to 
           mcg-code
                       when el-mcg-sigla(2) move el-mcg-code(2) to 
           mcg-code
                       when el-mcg-sigla(3) move el-mcg-code(3) to 
           mcg-code
                       when el-mcg-sigla(4) move el-mcg-code(4) to 
           mcg-code
                       when el-mcg-sigla(5) move el-mcg-code(5) to 
           mcg-code
                       when el-mcg-sigla(6) move el-mcg-code(6) to 
           mcg-code
                       when el-mcg-sigla(7) move el-mcg-code(7) to 
           mcg-code
                       when other exit perform
                       end-evaluate

                       if wom-split-el-split-isMulti(idx-days, 
           idx-split) = 0
                          exit perform cycle
                       end-if

                       if el-mcg-code(idx-gruppi) = mcg-code
                          perform until 1 = 2
                             compute idx = function random * (tot-exe)
                             add 1 to idx              
                             if el-exe-used(idx) = 0 or
                                ex-remain = 0     
                                move idx-days         to tex-day
                                move idx-split        to tex-split
                                move mcg-code         to tex-mcg-code
                                move el-exe-code(idx) to tex-exe-code
                                move el-exe-desc(idx) to tex-exe-desc
                                perform DES-UNIVOCA
                                move int-code         to tex-int-code
                                move 1                to tex-exe-isMulti
                                move 0                to 
           tex-int-restpause
                                write tex-rec                           
                
                                move 1                to 
           el-exe-used(idx)                                
                                if ex-remain > 0
                                   subtract 1 from ex-remain
                                end-if
                                exit perform
                             end-if
                          end-perform       
                       end-if
                    end-perform
                 end-perform          
              end-if
           end-perform.

      ***---
       LOAD-EXERCISES.      
           move "Dispongo gli esercizi" to lab-attesa-buf.
           display lab-attesa
           move spaces to s-mcg-code.
           
           perform varying idx-days from 1 by 1 
                     until idx-days > wom-days    
              perform varying idx-split from 1 by 1 
                        until idx-split > 20 
                                           
                 move idx-days  to tex-day
                 move idx-split to tex-split
                 read tmp-exe
                      invalid continue
                  not invalid exit perform cycle |Salto i multi se già messi
                 end-read                           

                 move low-value to twe-rec
                 evaluate wom-split-el-split-sigla(idx-days, idx-split)
                 when el-mcg-sigla(1) move el-mcg-code(1) to mcg-code 
           twe-mcg-code
                 when el-mcg-sigla(2) move el-mcg-code(2) to mcg-code 
           twe-mcg-code
                 when el-mcg-sigla(3) move el-mcg-code(3) to mcg-code 
           twe-mcg-code
                 when el-mcg-sigla(4) move el-mcg-code(4) to mcg-code 
           twe-mcg-code
                 when el-mcg-sigla(5) move el-mcg-code(5) to mcg-code 
           twe-mcg-code
                 when el-mcg-sigla(6) move el-mcg-code(6) to mcg-code 
           twe-mcg-code
                 when el-mcg-sigla(7) move el-mcg-code(7) to mcg-code 
           twe-mcg-code
                 when other exit perform
                 end-evaluate       

                 move wom-split-el-split-int-code(idx-days, idx-split)
                   to int-code           
                 perform ADD-RANDOM-EXERCISE
                           
              end-perform
           end-perform.

      ***---
       ADD-RANDOM-EXERCISE.
           set twe-exe-isMulti-no to true.
           read intexe no lock.
           move int-effort to twe-effort .
           move 0 to tot-exe.
           start tmp-wod-exe key >= twe-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-wod-exe next at end exit perform end-read
                                              
                    if twe-mcg-code  not = mcg-code or
                       twe-exe-isMulti-yes          or
                       twe-effort    not = int-effort
                       exit perform
                    end-if
           
                    if twe-exe-isRestpause = 0 and
                       int-restpause > 0         
                       exit perform cycle
                    end-if             
                       
                    add 1 to tot-exe    
                    move twe-exe-code      to el-exe-code(tot-exe)
                    move twe-exe-desc      to el-exe-desc(tot-exe)
                    move twe-effort        to el-exe-effort(tot-exe)
                    move 0                 to el-exe-used(tot-exe)
                    move twe-exe-isRestpause to 
           el-exe-isRestpause(tot-exe)
                 end-perform
           end-start.    

           if tot-exe > 0
              move tot-exe to ex-remain
              perform until 1 = 2
                                        
                 compute idx = function random * (tot-exe)
                 add 1 to idx
                 if el-exe-used(idx) = 0 or
                    ex-remain = 0
                    move idx-days         to tex-day
                    move idx-split        to tex-split     
                    move mcg-code         to tex-mcg-code
                    move el-exe-code(idx) to tex-exe-code exe-code
                    read exercises
                    move el-exe-desc(idx) to tex-exe-desc
                    perform DES-UNIVOCA
                    move int-code         to tex-int-code
                    move 0                to tex-exe-isMulti
                    move int-restpause    to tex-int-restpause
                    write tex-rec invalid rewrite tex-rec end-write
                    
                    move 1                to el-exe-used(idx)
                    if ex-remain > 0
                       subtract 1 from ex-remain
                    end-if   
                    exit perform
                 end-if
              end-perform
           end-if.

      ***---
       REMOVE-DUPLICATES.
           move "Rimuovo i duplicati" to lab-attesa-buf.
           display lab-attesa.
           perform varying como-giorno from 1 by 1 
                     until como-giorno > wom-days  

              |1. Creo una lista dei soli esercizi per giorno/gruppo
              move low-value to tex-rec
              move como-giorno  to tex-day
              move 0 to tot-subst
              move spaces to mcg-code
              start tmp-exe key >= tex-key
                    invalid continue 
                not invalid
                    move 1 to riga
                    perform until 1 = 2
                       read tmp-exe next 
                         at end 
                            perform TROVA-SOSTITUZIONI   
                            exit perform
                       end-read 
                       if mcg-code = spaces
                          move tex-mcg-code to mcg-code
                       end-if
                       if tex-day      not = como-giorno 
                          perform TROVA-SOSTITUZIONI   
                          exit perform
                       end-if
                       if tex-mcg-code not = mcg-code
                          move tex-mcg-code to mcg-code
                          move tex-key to s-tex-key
                          perform TROVA-SOSTITUZIONI   
                          move s-tex-key to tex-key
                          start tmp-exe key >= tex-key
                                invalid continue
                          end-start
                          exit perform cycle
                       end-if                    
                       if tex-exe-isMulti = 1 exit perform cycle end-if
                       move tex-desc-univoca to como-nome
                       inspect tex-exe-desc replacing trailing 
           low-value by spaces
                       move tex-day   to ted-day
                       move como-nome to ted-nome-dupl
                       move tex-mcg-code to ted-mcg-code
                       read tmp-exe-dupl no lock
                            invalid move 1 to ted-num
                                    write ted-rec end-write
                        not invalid add  1 to ted-num
                                    rewrite ted-rec end-rewrite
                                    add 1 to tot-subst
                       end-read
                       move tex-key to ted-tex-key(ted-num)
                       rewrite ted-rec
                    end-perform
              end-start
           end-perform.

      ***---
       TROVA-SOSTITUZIONI.
           if tot-subst not = 0
              move low-value to ted-rec
              start tmp-exe-dupl key >= ted-key
                    invalid continue
                not invalid
                    perform until 1 = 2     
                       read tmp-exe-dupl next 
                         at end exit perform
                       end-read
                       if ted-num = 1
                          exit perform cycle
                       end-if 
                       move ted-num to tot-subst
                       perform varying idx from 1 by 1 
                                 until idx > 20
                          if ted-tex-day(idx)   = 0 or
                             ted-tex-split(idx) = 0 or
                             ted-num = 1
                             exit perform
                          end-if
                          move ted-tex-key(idx) to tex-key
                          read tmp-exe 
                               invalid continue
                           not invalid 
                               move tex-mcg-code to twe-mcg-code
                               move 0 to twe-exe-isMulti
                               move tex-int-code to int-code
                               read intexe
                               move int-effort to twe-effort
                               move low-value  to twe-exe-code
                               start tmp-wod-exe key >= twe-key
                                     invalid continue
                                 not invalid            
                                     initialize exe-probabili-tab
                                     move 0 to exe-probabili
                                     perform until 1 = 2
                                        read tmp-wod-exe next at end 
           exit perform end-read
                                        if twe-mcg-code    not = 
           tex-mcg-code or
                                           twe-exe-isMulti not = 0 or
                                           twe-effort      not = 
           int-effort
                                           exit perform
                                        end-if      
                                        move twe-exe-code to exe-code
                                        read exercises
                                        if int-restpause > 0 and
                                           exe-isRestpause = 0
                                           exit perform cycle
                                        end-if
                                        |Lo cerco nello stesso giorno
                                        move como-giorno  to tex-day
                                        move twe-exe-desc to 
           tex-exe-desc
                                        perform DES-UNIVOCA
                                        read tmp-exe key tex-k-day-exe
                                             invalid
                                            |Se non c'è lo cerco in tutta la scheda
                                             read tmp-exe key tex-k-exe
                                                  invalid
                                                  move ted-tex-key(idx) 
           to tex-key
                                                  read tmp-exe
                                                  move exe-code to 
           tex-exe-code
                                                  move exe-desc to 
           tex-exe-desc
                                                  perform DES-UNIVOCA
                                                  rewrite tex-rec
                                                  subtract 1 from 
           ted-num 
                                                  initialize 
           exe-probabili-tab
                                                  move 0  to 
           exe-probabili
                                                  exit perform
                                              not invalid
                                                  add 1 to exe-probabili
                                                  move exe-code to 
           exe-code-probabile-el(exe-probabili)
                                             end-read
                                        end-read
                                     end-perform
                               end-start
                          end-read
                          if exe-probabili > 0  
                             move ted-tex-key(idx) to tex-key
                             compute idx2 = function random * 
           (exe-probabili)
                             add 1 to idx2
                             read tmp-exe
                             move exe-code-probabile-el(idx2)
                               to tex-exe-code exe-code
                             read exercises
                             move exe-desc to tex-exe-desc 
                             perform DES-UNIVOCA
                             rewrite tex-rec 
                             subtract 1 from ted-num 
                             initialize exe-probabili-tab
                             move 0  to exe-probabili
                          end-if
                       end-perform
                    end-perform
              end-start
           end-if.
           move 0 to tot-subst.

      ***---
       DES-UNIVOCA.
           move tex-exe-desc to como-nome.
           initialize como-nome counter tex-desc-univoca.
           inspect tex-exe-desc replacing trailing spaces by low-value.
           inspect tex-exe-desc tallying counter for characters before 
           low-value.
           if tex-exe-desc(counter - 3 : 4) = "HARD"
              move tex-exe-desc(1:counter - 4)to tex-desc-univoca
           end-if .
           if tex-exe-desc(counter - 5 : 6) = "MEDIUM"
              move tex-exe-desc(1:counter - 6)to tex-desc-univoca
           end-if.
           if tex-exe-desc(counter - 4 : 5) = "LIGHT"
              move tex-exe-desc(1:counter - 5)to tex-desc-univoca
           end-if.
           inspect tex-exe-desc replacing trailing low-value by spaces.
           if tex-desc-univoca = spaces
              move tex-exe-desc to tex-desc-univoca
           end-if 
           .
      * <TOTEM:END>

       IMPOSTA-SERIES-REPS.
      * <TOTEM:PARA. IMPOSTA-SERIES-REPS>
      *****     if exe-isMulti = 1
      *****        evaluate wom-effort
      *****        when 1 move  5 to col-series
      *****               move  5 to col-reps
      *****        when 2 move  6 to col-series
      *****               move 10 to col-reps
      *****        when 3 move 10 to col-series
      *****               move  8 to col-reps
      *****        end-evaluate                               
      *****        inspect col-reps 
      *****                replacing leading x"30" by x"20"
      *****        call "C$JUSTIFY" using col-reps, "L"
      *****     else                  
              move int-series to col-series
                                    
              initialize col-reps
              if int-restpause > 0  
                 move int-restpause to como-range-from
                 inspect como-range-from 
                         replacing leading x"30" by x"20"
                 inspect int-desc replacing trailing spaces by low-value
                 call "C$JUSTIFY" using como-range-from, "L"
                 inspect como-range-from replacing trailing spaces by 
           low-value
                 string int-desc       delimited low-value
                        " ("           delimited size
                        int-restpause  delimited low-value
                        ")"            delimited size
                   into col-reps
                 end-string
              else
                 perform IMPOSTA-SERIES-RANGE
              end-if
      *****     end-if.
           .
                       
      ***---
       IMPOSTA-SERIES-RANGE.
           if int-range-from = 99 and int-range-to = 99
              move "Max" to col-reps
           else
              if int-isTime = 1
                 move int-time to como-hit
                 inspect como-hit 
                 replacing leading x"30" by x"20"
                 call "C$JUSTIFY" using como-hit, "L"
                 inspect como-hit 
                 replacing trailing spaces by low-value
                 initialize col-reps
                 string como-hit delimited low-value
                        "''"     delimited size
                   into col-reps
                 end-string
              else
                 if int-range-from = int-range-to      
                    move int-range-from to como-range-from
                    inspect como-range-from 
                    replacing leading x"30" by x"20"
                    call "C$JUSTIFY" using como-range-from, "L"
                    inspect como-range-from 
                    replacing trailing spaces by low-value  
                 
                    initialize col-reps
                    string como-range-from delimited low-value
                      into col-reps
                    end-string
                 else
                    move int-range-from to como-range-from
                    inspect como-range-from 
                    replacing leading x"30" by x"20"
                    call "C$JUSTIFY" using como-range-from, "L"
                    inspect como-range-from 
                    replacing trailing spaces by low-value
                 
                    move int-range-to to como-range-to                  
             
                    inspect como-range-to 
                    replacing leading x"30" by x"20"  
                    call "C$JUSTIFY" using como-range-to, "L"          
                    inspect como-range-to 
                    replacing trailing spaces by low-value
                 
                    initialize col-reps
                    string como-range-from delimited low-value
                           "-"             delimited size
                           como-range-to   delimited low-value
                      into col-reps
                    end-string
                 end-if
           end-if 
           .
      * <TOTEM:END>

       INIT.
      * <TOTEM:PARA. INIT>
           move 0 to StatusHelp.
           move 1 to mod-k.
           set StatusVisua    to true  
           .
      * <TOTEM:END>

       INIT-OLD-REC.
      * <TOTEM:PARA. INIT-OLD-REC>
      *     initialize old-tsc-rec replacing numeric data by zeroes
      *                                 alphanumeric data by spaces.
      *
      *     initialize old-rsc-rec replacing numeric data by zeroes
      *                                 alphanumeric data by spaces.
      *
      *     move tsc-cliente to old-tsc-cliente 
           .
      * <TOTEM:END>

       LOOKUP-EXE.
      * <TOTEM:PARA. LOOKUP-EXE>
           read exercises no lock
           move tex-int-code to int-code
           read intexe
           move int-effort to s-int-effort
           read groups no lock invalid move spaces to grp-mcg-code 
           end-read.
           move grp-mcg-code to s-mcg-code
           perform CREA-ZOOM-EXE-MCG.
           move low-value to zem-rec
           move s-int-effort to zem-int-effort
           move path-zoom-exe-mcg to ext-file
           move "zoom-exe-mcg"  to Como-File
           call   "zoom-gt"  using  como-file, zem-rec
                            giving stato-zoom
           cancel "zoom-gt".
           if stato-zoom = 0
              move zem-exe-code to col-exe-code exe-code
              read exercises
              move exe-int-code to int-code
              read intexe 
              move int-restpause to hid-restpause

              move zem-exe-desc to col-exe-desc
              move zem-grp-desc to col-grp-desc
              move zem-grp-code to col-grp-code
              modify gd1(riga, 78-col-exe-code), 
                     cell-data = col-exe-code
              modify gd1(riga, 78-col-exe-desc), 
                     cell-data = col-exe-desc
              modify gd1(riga, 78-col-grp-code), 
                     cell-data = col-grp-code
              modify gd1(riga, 78-col-grp-desc), 
                     cell-data = col-grp-desc
                                               
              move hid-tex-key to tex-key
              read tmp-exe 
                   invalid continue
               not invalid
                   move exe-code     to tex-exe-code
                   move exe-desc     to tex-exe-desc
                   move exe-isMulti  to tex-exe-isMulti
                   rewrite tex-rec
              end-read
           end-if.    

      ***---
       CREA-ZOOM-EXE-MCG.          
           accept  como-data from century-date.
           accept  como-ora  from time.
           accept  path-zoom-exe-mcg from environment "PATH_ST".
           inspect path-zoom-exe-mcg replacing trailing spaces by 
           low-value.
           string  path-zoom-exe-mcg delimited low-value
                   "path-zoom-exe-mcg_"   delimited size
                   como-data           delimited size
                   "_"                 delimited size
                   como-ora            delimited size
              into path-zoom-exe-mcg
           end-string.                                                  
                 
           inspect path-zoom-exe-mcg replacing trailing low-value by 
           spaces.
           open output zoom-exe-mcg.    
           close       zoom-exe-mcg
           open i-o    zoom-exe-mcg

           move low-value to exe-code.
           start exercises key >= exe-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read exercises next at end exit perform end-read
                    if exe-isDisable = 1 exit perform cycle end-if
                    move exe-grp-code to grp-code
                    read groups no lock
                         invalid move spaces to grp-mcg-code
                    end-read
                    if grp-mcg-code not = s-mcg-code and 
                       s-mcg-code   not = spaces
                       exit perform cycle
                    end-if
                    move exe-code to zem-exe-code
                    move exe-desc to zem-exe-desc
                    move exe-int-code to int-code
                    read intexe
                    move int-desc   to zem-int-desc
                    move grp-desc   to zem-grp-desc
                    move grp-code   to zem-grp-code
                    move int-effort to zem-int-effort
                    write zem-rec
                 end-perform
           end-start.
           
           close zoom-exe-mcg 
           .
      * <TOTEM:END>

       NUOVO.
      * <TOTEM:PARA. NUOVO>
           perform SALV-MOD.
      
           if tutto-ok  
              perform DATI-DEFAULT
           end-if 
           .
      * <TOTEM:END>

       RELOAD-GRID.
      * <TOTEM:PARA. RELOAD-GRID>
           set reloadGrid to true.
           close       tmp-hit.
           open output tmp-hit.
           close       tmp-hit
           open output tmp-hit.
           perform LOAD-GRID.
           set reloadGrid to false 
           .
      * <TOTEM:END>

       RESETTA-FONT.
      * <TOTEM:PARA. RESETTA-FONT>
           inquire gd1, last-row in tot-righe.
           perform varying riga from 2 by 1 
                     until riga > tot-righe
              inquire gd1(riga, 78-col-day), 
                     hidden-data = hiddenData
              if hid-tex-day > 0
                 modify gd1(riga), row-font = Calibri12-Occidentale,
                                   row-color 0
              end-if
           end-perform 
           .
      * <TOTEM:END>

       RICALCOLA-HIT-DIV.
      * <TOTEM:PARA. RICALCOLA-HIT-DIV>
           modify gd1, mass-update = 1.
           close       tmp-hit
           open output tmp-hit.        
           close       tmp-hit
           open i-o    tmp-hit.
           move 0 to save-day tot-series tot-exe.
           inquire gd1, last-row in tot-righe.
           perform varying store-riga from 2 by 1 
                     until store-riga > tot-righe                       
              
              inquire gd1(store-riga, 78-col-day), hidden-data 
           hiddenData
                                                     cell-data th-day
              if hid-mcg-code = spaces and tot-exe = 0
                 move 0 to col-series
                 modify gd1(store-riga, 78-col-series), cell-data 
           col-series
              end-if
              if hid-mcg-code = spaces 
                 if save-day not = 0 
                    inquire gd1(store-riga, 78-col-day), hidden-data 
           hid-tot-exe
                    move hid-tot-exe to schema-exe
                    move store-riga to riga-div
                    perform VALORI-RIGA-DIV
                    move 0 to tot-series tot-exe
                 end-if
                 exit perform cycle
              end-if
              if save-day = 0
                 move th-day to save-day
              end-if
              add 1 to tot-exe
              inquire gd1(store-riga, 78-col-series), cell-data 
           col-series
              add col-series to tot-series
              move hid-mcg-code to th-mcg-code
              write th-rec invalid rewrite th-rec end-write
           end-perform.

           perform varying store-riga from 2 by 1 
                     until store-riga > tot-righe                       
              
              inquire gd1(store-riga, 78-col-day), hidden-data 
           hiddenData
              if hid-mcg-code not = spaces
                 exit perform cycle
              end-if
              inquire gd1(store-riga, 78-col-day), hidden-data 
           hid-tot-exe
              if hid-tot-exe = 0
                 exit perform cycle
              end-if
              inquire gd1(store-riga, 78-col-series), cell-data in 
           col-series
              if col-series = 0
                 modify gd1, record-to-delete store-riga
              end-if
           end-perform.
           modify gd1, mass-update = 0 
           .
      * <TOTEM:END>

       RIEMPI-CHIAVE.
      * <TOTEM:PARA. RIEMPI-CHIAVE>
      *     inquire ef-cliente, value in ef-cliente-buf.
      *     move ef-cliente-buf to tsc-cliente 
           .
      * <TOTEM:END>

       RIEMPI-GRID.
      * <TOTEM:PARA. RIEMPI-GRID>
      *     move 0 to store-riga.
      *     modify gd1, mass-update = 1.
      *     perform RESETTA-GRID.
      *     move low-value  to rsc-rec.
      *     move tsc-codice to rsc-codice.
      *
      *     set tutto-ok   to true.
      *     start rschede key >= rsc-chiave
      *           invalid  set errori  to true
      *     end-start.
      *
      *     if tutto-ok
      *        move 2 to riga
      *        perform until 1 = 2
      *           read rschede next no lock 
      *              at end 
      *                 exit perform 
      *           end-read
      *           if rsc-codice not = tsc-codice
      *              exit perform
      *           end-if
      *           move rsc-data  to como-data
      *           perform DATE-TO-SCREEN
      *           move como-data to col-data
      *           move rsc-articolo to art-codice col-art
      *           if col-art = spaces 
      *              move rsc-descrizione to art-descrizione
      *           else
      *              read articoli no lock 
      *                invalid move "** NON TROVATO **" to art-descrizione
      *              end-read
      *           end-if
      *           move art-descrizione to col-des
      *           move rsc-qta         to col-qta
      *           move rsc-prz         to col-prz
      *           move rsc-sconto1     to col-sc1
      ******           move rsc-sconto2     to col-sc2
      *           move rsc-netto       to col-netto
      *           move rsc-note        to col-note
      *           move 0               to col-numdoc
      *           move 0               to col-datadoc
      *           move spaces          to hid-documento
      *           if rsc-numfat not = 0
      *              move rsc-numfat  to col-numdoc
      *              move rsc-datafat to como-data
      *              perform DATE-TO-SCREEN
      *              move como-data   to col-datadoc
      *              modify gd1(riga, 78-col-numdoc),  cell-color 481
      *              modify gd1(riga, 78-col-datadoc), cell-color 481
      *              set hid-fattura to true
      *           end-if
      *           if rsc-numcor not = 0
      *              move rsc-numcor  to col-numdoc
      *              move rsc-datacor to como-data
      *              perform DATE-TO-SCREEN
      *              move como-data   to col-datadoc
      *              modify gd1(riga, 78-col-numdoc),  cell-color 193
      *              modify gd1(riga, 78-col-datadoc), cell-color 193
      *              set hid-corrisp to true
      *           end-if
      *           if rsc-numcor      = 0 and 
      *              rsc-numfat      = 0 and 
      *              num-doc     not = 0 and
      *              store-riga      = 0
      *              move riga to store-riga
      *           end-if
      *           modify gd1(riga, 78-col-data),    cell-data col-data
      *           modify gd1(riga, 78-col-art),     cell-data col-art
      *           modify gd1(riga, 78-col-des),     cell-data col-des
      *           modify gd1(riga, 78-col-qta),     cell-data col-qta
      *           modify gd1(riga, 78-col-prz),     cell-data col-prz
      *           modify gd1(riga, 78-col-sc1),     cell-data col-sc1
      ******           modify gd1(riga, 78-col-sc2),     cell-data col-sc2
      *           modify gd1(riga, 78-col-netto),   cell-data col-netto
      *           modify gd1(riga, 78-col-note),    cell-data col-note
      *           modify gd1(riga, 78-col-numdoc),  cell-data col-numdoc
      *           modify gd1(riga, 78-col-datadoc), cell-data col-datadoc
      *           modify gd1(riga, 1), hidden-data gruppo-hidden
      *           add 1 to riga
      *        end-perform
      *        subtract 2 from riga giving RigheIniziali
      *     end-if.
      *     modify gd1, mass-update = 0.
      *     if store-riga = 0
      *        move 2 to store-riga
      *     end-if.
      *     move store-riga to riga.
      *     move 1          to colonna.
      *     perform PUNTA-CELLA.
      *     perform VALORE-RIGA.
      *     move rsc-rec      to old-rsc-rec.
      *     move rsc-data     to como-old-rsc-data.
      *     move rsc-articolo to como-old-rsc-articolo 
           .
      * <TOTEM:END>

       SALV-MOD.
      * <TOTEM:PARA. SALV-MOD>
           set tutto-ok to true.
           set SiSalvato to true.

           inquire gd1, last-row in tot-righe.
           if tot-righe > 1
              set NoSalvato to true
           end-if.

           if NoSalvato
              display message "Vuoi resettare il lavoro fatto?"
                        title titolo
                         type mb-yes-no
                       giving scelta       
       
              if scelta = mb-no
                 set errori to true
              end-if
           end-if 
           .
      * <TOTEM:END>

       SALVA.
      * <TOTEM:PARA. SALVA>
           perform CHECK-WOD.
           if tutto-ok
              perform SCR-DATE-OPEN-ROUTINE
           end-if.
      *     if mod = 0 
      *        exit paragraph 
      *     end-if.
      *
      *     set tutto-ok to true.
      *
      *     set controllo-finale to true.
      *     perform varying control-id from 78-ID-ef-cliente by 1
      *               until control-id > 78-ID-ef-cliente
      *        perform CONTROLLO
      *        if errori 
      *           exit perform
      *        end-if
      *     end-perform.
      *
      *     if tutto-ok
      *        perform X-Y
      *        if tot-righe = 1
      *           set errori to true
      *           display message "Nessun articolo inserito"
      *                     title tit-err
      *                      icon 2
      *           move 78-ID-gd1 to control-id
      *           move 1 to colonna
      *        else
      *           perform VALORE-RIGA
      *           if not RigaVuota
      *              perform varying colonna from 78-col-data by 1
      *                        until colonna > 78-max-colonne|78-col-tipo-imp
      *                 perform CONTROLLO-RIGA
      *                 if errori exit perform end-if
      *              end-perform
      *           end-if
      *        end-if
      *     end-if.
      *            
      *     set controllo-finale to false.
      *
      *     if errori
      *        perform ABILITAZIONI
      *        if store-id = 78-ID-gd1
      *           perform CANCELLA-COLORE
      *           perform PUNTA-CELLA
      *        else
      *           move store-id to control-id
      *           move 4        to accept-control
      *        end-if
      *     else
      *
      *        if nuovo
      *           move high-value to      tsc-codice
      *           start tschede key <=    tsc-codice
      *                 invalid move 1 to tsc-codice
      *             not invalid
      *                 read tschede previous with no lock
      *                      at end move 1 to tsc-codice
      *                  not at end add  1 to tsc-codice
      *                 end-read
      *           end-start
      *           accept tsc-data-creazione from century-date
      *        end-if
      *
      *        perform DELETE-RIGHE
      *        perform FORM1-BUF-TO-FLD
      *        perform varying riga from 2 by 1 
      *                  until riga > tot-righe
      *           perform VALORE-RIGA
      *           perform SCRIVI-RIGA
      *        end-perform
      *
      *        perform CANCELLA-COLORE
      *        write tsc-rec invalid rewrite tsc-rec end-write 
      *
      *        if nuovo
      *           set vecchio to true
      *           perform STAMPA
      *        end-if
      *
      *        set vecchio      to true
      *        set stampa       to true
      *
      *        perform TORNA-IN-VISUA
      *        perform VALORIZZA-OLD
      *
      *     end-if.
      *
      *     display form1 
           .
      * <TOTEM:END>

       SALVATAGGIO.
      * <TOTEM:PARA. SALVATAGGIO>
           inquire cb-wod, value in wom-desc.
           read wodmap no lock.

           perform varying idx1 from 1 by 1 
                     until idx1 = 999
              move spaces to el-dati-wod(idx1)
           end-perform.

           move 0 to idx1.
           
           move lab-code-buf to tod-code como-code.
           if tod-code > 0
              delete twodbook record        
              move low-value to rod-key
              move tod-code  to rod-code
              start rwodbook key >= rod-key
                    invalid continue
                not invalid 
                    perform until 1 = 2
                       read rwodbook next at end exit perform end-read
                       if rod-code not = tod-code
                          exit perform
                       end-if 
                       add 1 to idx1
                       move rod-dati-modwod to el-dati-wod(idx1)
                       delete rwodbook record
                    end-perform
              end-start
           else
              move high-value to tod-rec
              start twodbook key <= tod-key
                    invalid move 0 to como-code
                not invalid read twodbook previous
                            move tod-code to como-code
              end-start
              add 1 to como-code 
           end-if.

           move 0 to tot-exe primo-giorno.             
           move low-value to tex-key.
           start tmp-exe key >= tex-key
                 invalid continue
             not invalid
                 move 0 to como-giorno idx1
                 perform until 1 = 2
                    read tmp-exe next at end exit perform end-read
                    if tex-day not = como-giorno
                       move tex-day to como-giorno
                       move 0 to s-tex-split
                       evaluate tex-day
                       when 1 move ef-gg1-buf to como-data
                              perform DATE-TO-FILE
                              move como-data  to primo-giorno
                       when 2 move ef-gg2-buf to como-data
                              perform DATE-TO-FILE                  
                       when 3 move ef-gg3-buf to como-data
                              perform DATE-TO-FILE                  
                       when 4 move ef-gg4-buf to como-data
                              perform DATE-TO-FILE                  
                       when 5 move ef-gg5-buf to como-data
                              perform DATE-TO-FILE                  
                       when 6 move ef-gg6-buf to como-data
                              perform DATE-TO-FILE                  
                       when 7 move ef-gg7-buf to como-data
                              perform DATE-TO-FILE                  
                       end-evaluate  
                       move como-data to s-data
                    end-if                                             
                    initialize rod-rec replacing numeric data by zeroes
                                            alphanumeric data by spaces
                    move s-data               to rod-day
                    move tex-day              to rod-prg-day
                    move como-code            to rod-code
                    add 1 to s-tex-split
                    move s-tex-split          to rod-split
      *              move tex-split            to wod-split
                    move tex-mcg-code         to rod-mcg-code        
                    move tex-exe-code         to rod-exe-code        
                    move tex-int-code         to rod-int-code        
                    move tex-exe-isMulti      to rod-exe-isMulti     
                    move tex-reps             to rod-reps            
                    move tex-series           to rod-series          
                    move tex-int-restpause    to rod-int-restpause   
                    move tex-ss               to rod-ss    
                    add  1                    to tot-exe            
                    move tex-desc-univoca     to rod-desc-univoca 
                    add 1 to idx1
                    move el-dati-wod(idx1) to rod-dati-modwod
                    write rod-rec       

                    move rod-day to como-data
                    perform DATE-TO-SCREEN
                    move como-data to como-data-x10
                    compute riga = rod-prg-day * 2 + 1
                    modify gd-schema(riga, 12), cell-data como-data-x10

                 end-perform   

                 |Scrivo la testata
                 accept como-data from century-date
                 initialize tod-rec replacing numeric data by zeroes
                                         alphanumeric data by spaces
                 move como-code      to tod-code
                 inquire ef-desc, value in ef-desc-buf
                 move ef-desc-buf    to tod-desc
                 move como-data      to tod-data-creazione
                 move wom-code       to tod-wom-code wom-code
                 read wodmap                                     
                 move wom-effort     to tod-wom-effort      
                 move primo-giorno   to tod-day-ini
                 move tod-code to lab-code-buf
                 move tod-desc to lab-desc-buf
                 display lab-desc lab-code
                 move tot-exe        to tod-tot-exe
                 move tex-day        to tod-gg
                 move wom-dur-code   to dur-code tod-dur-code

                 perform varying idx from 1 by 1 
                           until idx > 20
                    if el-mcg-code(idx) = spaces
                       exit perform
                    end-if             
                    move el-mcg-code(idx) to tod-el-mcg-code(idx)
                    move el-hit(idx)      to tod-el-hit(idx)
                 end-perform

                 write tod-rec

                 perform CURRENT-RECORD     

                 display message "Salvato allenamento correttamente."
                          x"0d0a""Codice : " tod-code
                           title titolo
                 move 27 to key-status
           end-start 
           .
      * <TOTEM:END>

       SEL-FILTRO.
      * <TOTEM:PARA. SEL-FILTRO>
           move 0 to e-des e-dta e-dtc e-map e-exe e-mul e-rep e-gss 
           e-mcg e-eff e-dur.

           evaluate tipo-filtro
           when 2 
                move 1 to e-des
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-gss-buf
                                     lab-map-buf
                                     lab-mcg-buf    
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 3 
                move 1 to e-dta         
                move spaces to ef-des-buf                    
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-gss-buf
                                     lab-map-buf     
                                     lab-mcg-buf     
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 4 
                move 1 to e-dtc         
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf   
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-gss-buf
                                     lab-map-buf   
                                     lab-mcg-buf     
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 5 
                move 1 to e-map
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf   
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-gss-buf
                                     lab-mcg-buf     
                                     lab-dur-buf
                move 0       to ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 6 
                move 1 to e-exe
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-mul-buf
                                     lab-rep-buf
                                     lab-gss-buf
                                     lab-map-buf
                                     lab-mcg-buf  
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 7 
                move 1 to e-mul      
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-rep-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-rep-buf
                                     lab-gss-buf
                                     lab-map-buf
                                     lab-mcg-buf  
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 8 
                move 1 to e-rep
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-gss-buf
                                     lab-map-buf
                                     lab-mcg-buf  
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 9 
                move 1 to e-gss
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-map-buf
                                     lab-mcg-buf  
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
           when 10
                move 1 to e-mcg
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-map-buf
                                     lab-gss-buf  
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
                move "Tutti" to cb-eff-buf
                                                  
           when 11                       
                move 1 to e-eff
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-map-buf
                                     lab-gss-buf  
                                     lab-dur-buf
                move 0       to ef-map-buf ef-dur-buf
           when 12                       
                move 1 to e-dur
                move spaces to ef-des-buf                    
                               ef-dta-from-buf ef-dta-to-buf
                               ef-dtc-from-buf ef-dtc-to-buf
                               ef-exe-buf
                               ef-mul-buf
                               ef-rep-buf
                               ef-gss-buf
                               ef-mcg-buf
                move 78-lab-tutti to lab-exe-buf
                                     lab-mul-buf
                                     lab-rep-buf
                                     lab-map-buf
                                     lab-gss-buf  
                move 0       to ef-map-buf
           end-evaluate.

           display scr-filtro 
           .
      * <TOTEM:END>

       SELEZIONA.
      * <TOTEM:PARA. SELEZIONA>
           perform SCR-FILTRO-OPEN-ROUTINE.

           if nessuna-scelta = 0
              call "C$JUSTIFY" using zwod-code, "R"
              inspect zwod-code replacing leading x"20" by x"30"
              move zwod-code to tod-code
              if chiamata-normale
                 perform CURRENT-RECORD
              end-if
           end-if 
           .
      * <TOTEM:END>

       SPOSTAMENTO.
      * <TOTEM:PARA. SPOSTAMENTO>
           set tutto-ok to true.
           perform X-Y.

           |Se abbandono una riga nuova
           if riga not = event-data-2          
              inquire gd1(riga, 78-col-day), hidden-data hiddenData
                                               cell-data col-day
              if hid-tex-day not = 0 and col-day = 0
                 modify gd1, record-to-delete = riga
              end-if
           end-if.

           move 0 to StatusHelp
                             
           modify gd1, start-x = 1,
                             x = 78-col-ss,
                       start-y = event-data-2,
                             y = event-data-2,
                  region-color = 257,
                  cursor-color = colore-nu.
                                                    
           modify pb-int,      enabled false
           evaluate event-data-1
           when 78-col-exe-code move 1 to StatusHelp
           when 78-col-series
           when 78-col-reps     modify pb-int, enabled true
           end-evaluate.
           perform STATUS-HELP.
                       
           inquire gd1(event-data-2, 78-col-day), hidden-data 
           hiddenData.
           move hid-tex-key to tex-key.
           read tmp-exe 
           .
      * <TOTEM:END>

       STAMPA.
      * <TOTEM:PARA. STAMPA>
           set s-stampa to true.
           perform STAMPA-ANTEPRIMA 
           .
      * <TOTEM:END>

       STAMPA-ANTEPRIMA.
      * <TOTEM:PARA. STAMPA-ANTEPRIMA>
           perform CHECK-WOD.
           if tutto-ok
              if s-anteprima
                 accept link-stampante from environment "STAMPANTE_ANTEP
      -    "RIMA"
              else
                 move spaces to link-stampante
              end-if
              call   "st-wod" using path-tmp-exe, link-stampante
              cancel "st-wod"
           end-if 
           .
      * <TOTEM:END>

       VALORE-RIGA.
      * <TOTEM:PARA. VALORE-RIGA>
      *     inquire gd1(riga, 78-col-data),    cell-data col-data.
      *     inquire gd1(riga, 78-col-art),     cell-data col-art. 
      *     inquire gd1(riga, 78-col-des),     cell-data col-des.
      *     inquire gd1(riga, 78-col-qta),     cell-data col-qta.
      *     inquire gd1(riga, 78-col-prz),     cell-data col-prz.
      *     inquire gd1(riga, 78-col-sc1),     cell-data col-sc1.
      ******     inquire gd1(riga, 78-col-sc2),     cell-data col-sc2.
      *     inquire gd1(riga, 78-col-netto),   cell-data col-netto.
      *     inquire gd1(riga, 78-col-note),    cell-data col-note.
      *     inquire gd1(riga, 78-col-numdoc),  cell-data col-numdoc.
      *     inquire gd1(riga, 78-col-datadoc), cell-data col-datadoc.
      *     inquire gd1(riga, 1), hidden-data gruppo-hidden.
      *
      *     move col-data    to como-col-data.
      *     move col-qta     to como-col-qta.
      *     move col-prz     to como-col-prz.
      *     move col-sc1     to como-col-sc1.
      ******     move col-sc2     to como-col-sc2.
      *     move col-netto   to como-col-netto.
      *     move col-numdoc  to como-col-numdoc.
      *     move col-datadoc to como-col-datadoc.
      *
      *     if como-col-data    = 0 and
      *        col-art          = spaces and
      *        col-des          = spaces and
      *        como-col-qta     = 0 and
      *        como-col-prz     = 0 and
      *        como-col-sc1     = 0 and
      ******        como-col-sc2     = 0 and
      *        como-col-netto   = 0 and
      *        col-note         = spaces and
      *        como-col-numdoc  = 0 and
      *        como-col-datadoc = 0
      *        set RigaVuota to true
      *     else
      *        set RigaVuota to false
      *     end-if 
           .
      * <TOTEM:END>

       VALORIZZA-OLD.
      * <TOTEM:PARA. VALORIZZA-OLD>
      *     move tsc-rec to old-tsc-rec.
      *
      *     set vecchio to true.
      *
      *     move 0 to StatusHelp
      *     perform STATUS-HELP.
      *
      *     inquire gd1, last-row in tot-righe.
      *     move 0 to RigaCambiata ColonnaCambiata 
           .
      * <TOTEM:END>

       VALORIZZA-NUOVO.
      * <TOTEM:PARA. VALORIZZA-NUOVO>
      *     move "00"       to status-tschede.
      *     move cli-codice to tsc-cliente.
      *     perform FORM1-IUD-DISPLAY.
      *     display form1.
      *
      *     perform RESETTA-GRID.
      *
      *     move 0 to RigheIniziali.
      *     move 0 to RigaCambiata ColonnaCambiata 
           .
      * <TOTEM:END>

       VALORIZZA-WOD.
      * <TOTEM:PARA. VALORIZZA-WOD>
           inquire cb-int, value cb-int-buf.
           inquire cb-dur, value cb-dur-buf.
           inquire cb-gio, value cb-gio-buf.

           if cb-int-buf = s-cb-int-buf and
              cb-dur-buf = s-cb-dur-buf and
              cb-gio-buf = s-cb-gio-buf 
              exit paragraph 
           end-if.

           inquire cb-dur, value in dur-desc.
           read duration key dur-k-desc 
                invalid move 0 to dur-code
           end-read.

           if cb-int-buf = s-int-buf and
              dur-desc = s-dur-desc and
              cb-gio-buf = s-gio-buf
              exit paragraph
           end-if.              

           move cb-int-buf to s-int-buf.
           move dur-desc   to s-dur-desc.
           move cb-gio-buf to s-gio-buf.

           if cb-gio-buf = "Tutto"
              move 0 to como-giorni
           else
              move cb-gio-buf to como-giorni convert
           end-if.
                                        
           move 0 to effort-wod.

           evaluate cb-int-buf     
           when "Light wod effort"  move 1 to effort-wod
           when "Medium wod effort" move 2 to effort-wod
           when "Heavy wod effort"  move 3 to effort-wod
           end-evaluate.  
                                 
           modify cb-wod, reset-list = 1.
           modify cb-wod, item-to-add = "Nessuno".

           move low-value to wom-desc.
           start wodmap key >= wom-k-desc
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read wodmap next at end exit perform end-read
                    if effort-wod > 0
                       if wom-effort not = effort-wod
                          exit perform cycle
                       end-if
                    end-if
                    if dur-code > 0
                       if wom-dur-code not = dur-code
                          exit perform cycle
                       end-if
                    end-if
                    if como-giorni > 0
                       if wom-days not = cb-gio-buf
                          exit perform cycle
                       end-if
                    end-if
                    modify cb-wod, item-to-add = wom-desc
                 end-perform
           end-start.
                                               
           modify cb-wod, value = "Nessuno".
           modify cb-wod, enabled true.

           perform ABILITA-MACROGRUPPI.
           
           move cb-int-buf to s-cb-int-buf.
           move cb-dur-buf to s-cb-dur-buf.
           move cb-gio-buf to s-cb-gio-buf 
           

           .
      * <TOTEM:END>

       X-Y.
      * <TOTEM:PARA. X-Y>
           inquire gd1, cursor-y in riga,
                        cursor-x in colonna,
                        last-row in tot-righe 
           .
      * <TOTEM:END>

       VALORI-RIGA-DIV.
      * <TOTEM:PARA. VALORI-RIGA-DIV>
           move tot-exe to como-xx1.
           inspect como-xx1 replacing leading x"30" by x"20"
           call "C$JUSTIFY" using como-xx1, "L"
           inspect como-xx1 replacing trailing spaces by low-value
           move schema-exe to como-xx2.
           inspect como-xx2 replacing leading x"30" by x"20"
           call "C$JUSTIFY" using como-xx2, "L"
           inspect como-xx2 replacing trailing spaces by low-value

           initialize como-nome.
           string como-xx1 delimited low-value
                  "/"      delimited size
                  como-xx2 delimited low-value
             into como-nome
           end-string.
                                                                
           modify gd1(riga-div, 78-col-day),      cell-data = como-nome
           modify gd1(riga-div, 78-col-prg),      cell-data = spaces
           modify gd1(riga-div, 78-col-grp-code), cell-data = spaces
           modify gd1(riga-div, 78-col-grp-desc), cell-data = spaces
           modify gd1(riga-div, 78-col-exe-code), cell-data = spaces
           modify gd1(riga-div, 78-col-exe-desc), cell-data = spaces
           
           move tot-series to como-xx1                    
           inspect como-xx1 replacing leading x"30" by x"20"
           call "C$JUSTIFY" using como-xx1, "L"

           modify gd1(riga-div, 78-col-series),   cell-data = como-xx1 
           modify gd1(riga-div, 78-col-reps),     cell-data = spaces 
           modify gd1(riga-div), row-color 304, row-font = 
           Calibri12B-Occidentale 
           .
      * <TOTEM:END>

      * EVENT PARAGRAPH
       TOOL-SALVA-LinkTo.
      * <TOTEM:PARA. TOOL-SALVA-LinkTo>
           INQUIRE TOOL-MODIFICA, VALUE IN MOD           

           INQUIRE TOOL-SALVA, ENABLED IN E-SALVA
           IF E-SALVA = 1
              PERFORM SALVA
           END-IF           
           .
      * <TOTEM:END>
       ANTEPRIMA-LinkTo.
      * <TOTEM:PARA. ANTEPRIMA-LinkTo>
           INQUIRE TOOL-ANTEPRIMA, ENABLED IN E-ANTEPRIMA.
           IF E-ANTEPRIMA = 1
              PERFORM ANTEPRIMA
           END-IF 
           .
      * <TOTEM:END>
       STAMPA-LinkTo.
      * <TOTEM:PARA. STAMPA-LinkTo>
           INQUIRE TOOL-STAMPA, ENABLED IN E-STAMPA
           IF E-STAMPA = 1
              PERFORM STAMPA
           END-IF 
           .
      * <TOTEM:END>
       TOOL-CERCA-LinkTo.
      * <TOTEM:PARA. TOOL-CERCA-LinkTo>
           inquire tool-cerca, enabled in e-cerca
           if e-cerca = 1
              perform CERCA
           end-if 
           .
      * <TOTEM:END>
       ginqui-Ev-Before-Program.
      * <TOTEM:PARA. ginqui-Ev-Before-Program>
           move LK-BL-PROG-ID    TO COMO-PROG-ID.
           call "C$NARG" using ws-narg.
           if ws-narg = 1
              set chiamata-normale to true
              move 1 to v-form1
           else
              set chiamata-lookup  to true
              move 0 to v-form1
           end-if.

           accept como-data from century-date.
           accept como-ora  from time.
                 
           accept  path-tmp-exe from environment "PATH_ST".
           inspect path-tmp-exe replacing trailing spaces by low-value.
           string  path-tmp-exe delimited low-value
                   "tmp-exe_"   delimited size
                   como-data    delimited size
                   "_"          delimited size
                   como-ora     delimited size
              into path-tmp-exe
           end-string.                                                  
                 
           inspect path-tmp-exe replacing trailing low-value by spaces.
           open output tmp-exe.
           close       tmp-exe.
           open i-o    tmp-exe. 
                 
           accept  path-tmp-hit from environment "PATH_ST".
           inspect path-tmp-hit replacing trailing spaces by low-value.
           string  path-tmp-hit delimited low-value
                   "tmp-hit_"   delimited size
                   como-data    delimited size
                   "_"          delimited size
                   como-ora     delimited size
              into path-tmp-hit
           end-string.                                                  
                 
           inspect path-tmp-hit replacing trailing low-value by spaces.
           open output tmp-hit.
           close       tmp-hit.
           open i-o    tmp-hit. 

           accept  path-tmp-exe-effort from environment "PATH_ST".
           inspect path-tmp-exe-effort replacing trailing spaces by 
           low-value.
           string  path-tmp-exe-effort delimited low-value
                   "tmp-exe-effort_"   delimited size
                   como-data           delimited size
                   "_"                 delimited size
                   como-ora            delimited size
              into path-tmp-exe-effort
           end-string.                                                  
                 
           inspect path-tmp-exe-effort replacing trailing low-value by 
           spaces.
           open output tmp-exe-effort.    
           close       tmp-exe-effort.
           open i-o    tmp-exe-effort.
                 
           accept  path-tmp-wod-exe from environment "PATH_ST".
           inspect path-tmp-wod-exe replacing trailing spaces by 
           low-value.
           string  path-tmp-wod-exe delimited low-value
                   "tmp-wod-exe_"   delimited size
                   como-data        delimited size
                   "_"              delimited size
                   como-ora         delimited size
              into path-tmp-wod-exe
           end-string.                                                  
                 
           inspect path-tmp-wod-exe replacing trailing low-value by 
           spaces.
           open output tmp-wod-exe.
           close       tmp-wod-exe.
           open i-o    tmp-wod-exe.

           accept  path-tmp-exe-dupl from environment "PATH_ST".
           inspect path-tmp-exe-dupl replacing trailing spaces by 
           low-value.
           string  path-tmp-exe-dupl delimited low-value
                   "path-tmp-exe-dupl_"   delimited size
                   como-data           delimited size
                   "_"                 delimited size
                   como-ora            delimited size
              into path-tmp-exe-dupl
           end-string.                                                  
                 
           inspect path-tmp-exe-dupl replacing trailing low-value by 
           spaces. 
           open output tmp-exe-dupl.    
           close       tmp-exe-dupl.
           open i-o    tmp-exe-dupl                                
           
           .
      * <TOTEM:END>
       ginqui-Ev-After-Program.
      * <TOTEM:PARA. ginqui-Ev-After-Program>
           set environment "KEYSTROKE" to "DATA=44 44".
           set environment "KEYSTROKE" to "DATA=46 46".
           SET LK-BL-CANCELLAZIONE TO TRUE.
           MOVE COMO-PROG-ID       TO LK-BL-PROG-ID.
           CALL "BLOCKPGM"  USING LK-BLOCKPGM.
               

           close       tmp-hit.
           delete file tmp-hit.

           close       tmp-exe.
           delete file tmp-exe.

           close       tmp-exe-effort.
           delete file tmp-exe-effort.

           close       tmp-wod-exe.
           delete file tmp-wod-exe.

           close       tmp-exe-dupl.
           delete file tmp-exe-dupl                                
           
           .
      * <TOTEM:END>
       gd1-Ev-Msg-Begin-Drag.
      * <TOTEM:PARA. gd1-Ev-Msg-Begin-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd1-Ev-Msg-End-Drag.
      * <TOTEM:PARA. gd1-Ev-Msg-End-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd1-Ev-Msg-Goto-Cell.
      * <TOTEM:PARA. gd1-Ev-Msg-Goto-Cell>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd1-Ev-Msg-Goto-Cell-Drag.
      * <TOTEM:PARA. gd1-Ev-Msg-Goto-Cell-Drag>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd1-Ev-Msg-Goto-Cell-Mouse.
      * <TOTEM:PARA. gd1-Ev-Msg-Goto-Cell-Mouse>
           perform SPOSTAMENTO 
           .
      * <TOTEM:END>
       gd1-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd1-Ev-Msg-Begin-Entry>
           if event-data-1 = 78-col-prg or 
                             78-col-grp-code or 
                             78-col-grp-desc or 
                             78-col-exe-code or 
                             78-col-exe-desc
              set  event-action to event-action-fail-terminate
           end-if.

           inquire gd1(event-data-2, 78-col-day), hidden-data in 
           hiddenData
           if hid-tex-day = 0                   
              set  event-action to event-action-fail-terminate
           end-if.

           if event-data-1 = 78-col-exe-code
              inquire gd1, entry-reason in como-x
              if como-x = x"00" or x"0d" or x"0D"
                 set ApriLookup to true
              end-if
           end-if.

      *     else
      *        perform X-Y
      *        inquire gd1(riga, 78-col-data), cell-data OLD-col-data
      *        move OLD-col-data to como-data
      *        inquire gd1(riga, 78-col-art),  cell-data OLD-col-art
      *
      *        if como-col-data = 0 and colonna not = 78-col-data
      *           set event-action to event-action-fail
      *        end-if
      *
      *        inquire gd1(riga, 78-col-des),     cell-data OLD-col-des
      *        inquire gd1(riga, 78-col-qta),     cell-data OLD-col-qta
      *        inquire gd1(riga, 78-col-sc1),     cell-data OLD-col-sc1
      ******        inquire gd1(riga, 78-col-sc2),     cell-data OLD-col-sc2
      *        inquire gd1(riga, 78-col-netto),   cell-data OLD-col-netto
      *        inquire gd1(riga, 78-col-note),    cell-data OLD-col-note
      *        inquire gd1(riga, 78-col-numdoc),  cell-data OLD-col-numdoc
      *        inquire gd1(riga, 78-col-datadoc), cell-data OLD-col-datadoc
      *
      *        move OLD-col-numdoc to como-col-numdoc
      *        if como-col-numdoc not = 0
      *           if colonna >= 78-col-numdoc
      *              set  event-action to event-action-fail-terminate
      *              inquire gd1, entry-reason in como-x
      *              evaluate como-x
      *              when X"00"|doppio click
      *              when X"0D"|invio
      ******                   move OLD-col-numdoc  to tfa-numero
      ******                   move OLD-col-datadoc to como-data
      ******                   perform DATE-TO-FILE
      ******                   move como-data(1:4)  to tfa-numero
      *                   set VediFattura to true
      *              end-evaluate
      *           else
      *              set event-action to event-action-fail
      *           end-if
      *        else
      *           evaluate colonna
      *           when 78-col-data
      *           when 78-col-art
      *                continue
      *           when 78-col-des
      *                if col-art = spaces
      *                   continue
      *                else
      *                   set event-action to event-action-fail 
      *                end-if
      *           when 78-col-netto
      *           when 78-col-numdoc
      *           when 78-col-datadoc
      *                set event-action to event-action-fail 
      *           when 78-col-qta 
      *           when 78-col-note
      *                continue
      *           when other
      *                set environment "KEYSTROKE" to "DATA=44 46"    
      *           end-evaluate
      *        end-if
      *
      *     end-if 
           .
      * <TOTEM:END>
       gd1-Ev-Msg-Finish-Entry.
      * <TOTEM:PARA. gd1-Ev-Msg-Finish-Entry>
           set tutto-ok to true.
           perform X-Y.
           perform VALORE-RIGA.
           perform CONTROLLO-RIGA.
      *
      *     evaluate colonna
      *     when 78-col-data
      *          if como-col-data = 0
      *             if not RigaVuota
      *                display message "Cancellare la riga?"
      *                          title titolo
      *                           type mb-yes-no
      *                        default mb-no
      *                         giving scelta
      *                if scelta = mb-no
      *                   set errori to true
      *                else
      *                   initialize rec-grid 
      *                              replacing numeric data by zeroes
      *                                   alphanumeric data by spaces
      *
      *                   move riga to store-riga
      *                   add 1 to riga
      *                   perform VALORE-RIGA
      *                   move rsc-rec to old-rsc-rec
      *                   move store-riga to riga
      *           
      *                   modify gd1, record-to-delete = riga
      *                   modify gd1, insert-rows = 1
      *                end-if
      *             end-if
      *          else
      *             perform CONTROLLO-RIGA
      *          end-if
      *          if tutto-ok
      *             if rsc-data not = old-rsc-data
      *                move riga to RigaCambiata
      *                move 1    to ColonnaCambiata
      *             end-if
      *          end-if
      *
      *     when 78-col-art
      *          perform CONTROLLO-RIGA
      *          if tutto-ok
      *             if col-art not = old-col-art
      *                move riga        to RigaCambiata
      *                move 78-col-art  to ColonnaCambiata
      *             end-if
      *          end-if
      *
      *     when 78-col-des
      *          if col-des not = old-col-des
      *             move riga        to RigaCambiata
      *             move 78-col-des  to ColonnaCambiata
      *          end-if
      *
      *     when 78-col-qta
      *          if col-qta not = old-col-qta
      *             move riga        to RigaCambiata
      *             move 78-col-qta  to ColonnaCambiata
      *          end-if
      *
      *     when 78-col-prz 
      *          if como-col-prz not = 0
      *             if como-col-sc1 = 0 |and como-col-sc2 = 0
      *                move cli-sconto1 to como-col-sc1 col-sc1
      ******                move cli-sconto2 to como-col-sc2 col-sc2
      *                modify gd1(riga, 78-col-sc1), cell-data col-sc1
      ******                modify gd1(riga, 78-col-sc2), cell-data col-sc2
      *             end-if
      *          end-if
      *          perform CONTROLLO-RIGA
      *          if tutto-ok
      *             if col-prz not = old-col-prz
      *                move riga        to RigaCambiata
      *                move 78-col-prz  to ColonnaCambiata
      *             end-if
      *          end-if
      *
      *     when 78-col-sc1
      *          perform CONTROLLO-RIGA
      *          if col-sc1 not = old-col-sc1
      *             move riga        to RigaCambiata
      *             move 78-col-sc1  to ColonnaCambiata
      *          end-if
      *
      ******     when 78-col-sc2
      ******          perform CONTROLLO-RIGA
      ******          if col-sc1 not = old-col-sc1
      ******             move riga        to RigaCambiata
      ******             move 78-col-sc2  to ColonnaCambiata
      ******          end-if
      *
      *     when 78-col-note
      *          if col-note not = old-col-note
      *             move riga        to RigaCambiata
      *             move 78-col-note to ColonnaCambiata
      *          end-if 
      *     end-evaluate.
      *
      *     if errori
      *        move 78-ID-gd1 to store-id
      *        set event-action to event-action-fail
      *     else                                              
      *        modify gd1(riga, 78-col-qta),   cell-data col-qta
      *        modify gd1(riga, 78-col-prz),   cell-data col-prz
      *        modify gd1(riga, 78-col-sc1),   cell-data col-sc1
      ******        modify gd1(riga, 78-col-sc2),   cell-data col-sc2
      *        modify gd1(riga, 78-col-netto), cell-data col-netto
      *        set environment "KEYSTROKE" to "DATA=44 44"
      *        set environment "KEYSTROKE" to "DATA=46 46"
      *     end-if 
           .
      * <TOTEM:END>
       cb-mg1-BeforeProcedure.
      * <TOTEM:PARA. cb-mg1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 1 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg2-BeforeProcedure.
      * <TOTEM:PARA. cb-mg2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 2 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg3-BeforeProcedure.
      * <TOTEM:PARA. cb-mg3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 3 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg4-BeforeProcedure.
      * <TOTEM:PARA. cb-mg4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 4 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg5-BeforeProcedure.
      * <TOTEM:PARA. cb-mg5-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 5 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg1-AfterProcedure.
      * <TOTEM:PARA. cb-mg1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-mg2-AfterProcedure.
      * <TOTEM:PARA. cb-mg2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-mg3-AfterProcedure.
      * <TOTEM:PARA. cb-mg3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-mg4-AfterProcedure.
      * <TOTEM:PARA. cb-mg4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-mg5-AfterProcedure.
      * <TOTEM:PARA. cb-mg5-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-int-BeforeProcedure.
      * <TOTEM:PARA. cb-int-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cb-dur-BeforeProcedure.
      * <TOTEM:PARA. cb-dur-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cb-rnd-BeforeProcedure.
      * <TOTEM:PARA. cb-rnd-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cb-int-AfterProcedure.
      * <TOTEM:PARA. cb-int-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform VALORIZZA-WOD 
           .
      * <TOTEM:END>
       cb-dur-AfterProcedure.
      * <TOTEM:PARA. cb-dur-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform VALORIZZA-WOD 
           .
      * <TOTEM:END>
       cb-rnd-AfterProcedure.
      * <TOTEM:PARA. cb-rnd-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI 
           .
      * <TOTEM:END>
       pb-genera-LinkTo.
      * <TOTEM:PARA. pb-genera-LinkTo>
           perform SCR-ATTESA-OPEN-ROUTINE 
           .
      * <TOTEM:END>
       pb-random-LinkTo.
      * <TOTEM:PARA. pb-random-LinkTo>
           inquire cb-wod, value in wom-desc.
           read wodmap key wom-k-desc.
                                      
           move tab-mcg   to como-tab-mcg.
           move tab-mcg-p to como-tab-mcg-p.

           perform varying idx1 from 1 by 1 
                     until idx1 > 10
              if como-el-mcg-desc(idx1) = spaces
                 subtract 1 from idx1
                 exit perform
              end-if
           end-perform.

           perform varying idx1-p from 1 by 1 
                     until idx1-p > 10
              if como-el-mcg-desc-p(idx1-p) = spaces
                 subtract 1 from idx1-p
                 exit perform
              end-if
           end-perform.

           if idx1 = 0 or idx1-p = 0
              exit paragraph
           end-if.

           perform varying riga from 1 by 1 
                     until riga > 7
              evaluate riga
              when 1 inquire cb-mg1, enabled = como-e
              when 2 inquire cb-mg2, enabled = como-e
              when 3 inquire cb-mg3, enabled = como-e
              when 4 inquire cb-mg4, enabled = como-e
              when 5 inquire cb-mg5, enabled = como-e
              when 6 inquire cb-mg6, enabled = como-e
              when 7 inquire cb-mg7, enabled = como-e
              end-evaluate

              if como-e = 0
                 exit perform cycle
              end-if

              perform until 1 = 2 
                 if como-prim(riga) = 1
                    compute idx = function random * (tot-mcg-p)
                    add 1 to idx
                    if como-el-mcg-desc-p(idx) not = spaces
                       move como-el-mcg-desc(idx) to mcg-desc
                       read macrogroups key mcg-k-desc
                       evaluate riga
                       when 1 modify cb-mg1, value = 
           como-el-mcg-desc-p(idx)
                       when 2 modify cb-mg2, value = 
           como-el-mcg-desc-p(idx)
                       when 3 modify cb-mg3, value = 
           como-el-mcg-desc-p(idx)
                       when 4 modify cb-mg4, value = 
           como-el-mcg-desc-p(idx)
                       when 5 modify cb-mg5, value = 
           como-el-mcg-desc-p(idx)
                       when 6 modify cb-mg6, value = 
           como-el-mcg-desc-p(idx)
                       when 7 modify cb-mg7, value = 
           como-el-mcg-desc-p(idx)
                       end-evaluate
                       move spaces to como-el-mcg-desc-p(idx) 
                       if idx1-p = 1 |Ho finito i gruppi e riparto
                          move tab-mcg-p to como-tab-mcg-p
                       else
                          subtract 1 from idx1-p
                       end-if                                        
                       exit perform
                    end-if
                 else
                    compute idx = function random * (tot-mcg)
                    add 1 to idx
                    if como-el-mcg-desc(idx) not = spaces
                       move como-el-mcg-desc(idx) to mcg-desc
                       read macrogroups key mcg-k-desc
                       evaluate riga
                       when 1 modify cb-mg1, value = 
           como-el-mcg-desc(idx)
                       when 2 modify cb-mg2, value = 
           como-el-mcg-desc(idx)
                       when 3 modify cb-mg3, value = 
           como-el-mcg-desc(idx)
                       when 4 modify cb-mg4, value = 
           como-el-mcg-desc(idx)
                       when 5 modify cb-mg5, value = 
           como-el-mcg-desc(idx)
                       when 6 modify cb-mg6, value = 
           como-el-mcg-desc(idx)
                       when 7 modify cb-mg7, value = 
           como-el-mcg-desc(idx)
                       end-evaluate
                       move spaces to como-el-mcg-desc(idx) 
                       if idx1 = 1 |Ho finito i gruppi e riparto
                          move tab-mcg to como-tab-mcg
                       else
                          subtract 1 from idx1
                       end-if                             
                       exit perform
                    end-if
                 end-if
              end-perform                
           end-perform.

           perform ABILITA-MACROGRUPPI 
           .
      * <TOTEM:END>
       cb-wod-AfterProcedure.
      * <TOTEM:PARA. cb-wod-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       cb-gio-AfterProcedure.
      * <TOTEM:PARA. cb-gio-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform VALORIZZA-WOD 
           .
      * <TOTEM:END>
       cb-gio-BeforeProcedure.
      * <TOTEM:PARA. cb-gio-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       cb-wod-BeforeProcedure.
      * <TOTEM:PARA. cb-wod-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       gd-schema-Ev-Msg-Begin-Entry.
      * <TOTEM:PARA. gd-schema-Ev-Msg-Begin-Entry>
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       NUOVO-LinkTo.
      * <TOTEM:PARA. NUOVO-LinkTo>
           perform NUOVO 
           .
      * <TOTEM:END>
       pb-mcg1-LinkTo.
      * <TOTEM:PARA. pb-mcg1-LinkTo>
           move 1 to idx.               
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       pb-mcg2-LinkTo.
      * <TOTEM:PARA. pb-mcg2-LinkTo>
           move 2 to idx.
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       pb-mcg7-LinkTo.
      * <TOTEM:PARA. pb-mcg7-LinkTo>
           move 7 to idx.
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       pb-mcg6-LinkTo.
      * <TOTEM:PARA. pb-mcg6-LinkTo>
           move 6 to idx.
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       pb-mcg5-LinkTo.
      * <TOTEM:PARA. pb-mcg5-LinkTo>
           move 5 to idx.
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       pb-mcg4-LinkTo.
      * <TOTEM:PARA. pb-mcg4-LinkTo>
           move 4 to idx.
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       pb-mcg3-LinkTo.
      * <TOTEM:PARA. pb-mcg3-LinkTo>
           move 3 to idx.
           perform CREA-TMP-GRP-EXE     
           .
      * <TOTEM:END>
       cb-mg6-BeforeProcedure.
      * <TOTEM:PARA. cb-mg6-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 6 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg6-AfterProcedure.
      * <TOTEM:PARA. cb-mg6-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-mg7-BeforeProcedure.
      * <TOTEM:PARA. cb-mg7-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           move 7 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       cb-mg7-AfterProcedure.
      * <TOTEM:PARA. cb-mg7-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform ABILITA-MACROGRUPPI.
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-su-LinkTo.
      * <TOTEM:PARA. pb-su-LinkTo>
           inquire gd1, cursor-y in riga.
           if riga = 2
              exit paragraph 
           end-if.  
                                                                      
           inquire gd1(riga - 1, 78-col-exe-code), cell-data exe-code.
           read exercises no lock
                invalid move spaces to grp-mcg-code exe-desc grp-desc 
           grp-code
            not invalid
                move exe-grp-code to grp-code
                read groups no lock
                     invalid move spaces to grp-mcg-code exe-desc 
           grp-desc grp-code
                end-read
           end-read.
           move exe-code     to tex-exe-code.
           move grp-mcg-code to tex-mcg-code
           move exe-desc     to tex-exe-desc
           move grp-desc     to como-grp-desc.
           move grp-code     to como-grp-code.

           inquire gd1(riga, 78-col-exe-code), cell-data exe-code.
           read exercises no lock
                invalid move spaces to grp-mcg-code exe-desc grp-desc 
           grp-code
            not invalid
                move exe-grp-code to grp-code
                read groups no lock
                     invalid move spaces to grp-mcg-code exe-desc 
           grp-desc grp-code
                end-read
           end-read.
           move grp-mcg-code to mcg-code
           move exe-desc     to exe-desc

           if tex-mcg-code not = mcg-code
              exit paragraph
           end-if.
                                                                      
           modify gd1(riga, 78-col-grp-code),     cell-data 
           como-grp-code.
           modify gd1(riga, 78-col-grp-desc),     cell-data 
           como-grp-desc.
           modify gd1(riga, 78-col-exe-code),     cell-data 
           tex-exe-code.
           modify gd1(riga, 78-col-exe-desc),     cell-data 
           tex-exe-desc.

           modify gd1(riga - 1, 78-col-grp-code), cell-data grp-code.
           modify gd1(riga - 1, 78-col-grp-desc), cell-data grp-desc.
           modify gd1(riga - 1, 78-col-exe-code), cell-data exe-code.
           modify gd1(riga - 1, 78-col-exe-desc), cell-data exe-desc.  
           
           inquire gd1(riga - 1, 78-col-day), cell-data in tex-day.
           inquire gd1(riga - 1, 78-col-prg), cell-data in tex-split.
           read tmp-exe no lock.       
           move tex-rec to como-tex-rec

           inquire gd1(riga, 78-col-day), cell-data in tex-day.
           inquire gd1(riga, 78-col-prg), cell-data in tex-split.    
           read tmp-exe no lock.    
           
           move tex-exe-code    to s-tex-exe-code.  
           move tex-exe-desc    to s-tex-exe-desc.   
           move tex-exe-isMulti to s-tex-exe-isMulti. 
           
           move como-tex-exe-code    to tex-exe-code.   
           move como-tex-exe-desc    to tex-exe-desc.   
           move como-tex-exe-isMulti to tex-exe-isMulti.
           rewrite tex-rec.                              

           move como-tex-key to tex-key.
           read tmp-exe no lock.

           move s-tex-exe-code    to tex-exe-code.   
           move s-tex-exe-desc    to tex-exe-desc.   
           move s-tex-exe-isMulti to tex-exe-isMulti.
           rewrite tex-rec.                

           subtract 1 from riga giving event-data-2.
           perform SPOSTAMENTO.
           modify gd1, cursor-y event-data-2 
           .
      * <TOTEM:END>
       pb-giu-LinkTo.
      * <TOTEM:PARA. pb-giu-LinkTo>
           inquire gd1, cursor-y in riga, last-row in tot-righe.
           if riga = tot-righe
              exit paragraph 
           end-if.  
                                                                      
           inquire gd1(riga + 1, 78-col-exe-code), cell-data exe-code.
           read exercises no lock
                invalid move spaces to grp-mcg-code exe-desc grp-desc 
           grp-code
            not invalid
                move exe-grp-code to grp-code
                read groups no lock
                     invalid move spaces to grp-mcg-code exe-desc 
           grp-desc grp-code
                end-read
           end-read.
           move exe-code     to tex-exe-code.
           move grp-mcg-code to tex-mcg-code
           move exe-desc     to tex-exe-desc
           move grp-desc     to como-grp-desc.
           move grp-code     to como-grp-code.

           inquire gd1(riga, 78-col-exe-code), cell-data exe-code.
           read exercises no lock
                invalid move spaces to grp-mcg-code exe-desc grp-desc 
           grp-code
            not invalid
                move exe-grp-code to grp-code
                read groups no lock
                     invalid move spaces to grp-mcg-code exe-desc 
           grp-desc grp-code
                end-read
           end-read.
           move grp-mcg-code to mcg-code
           move exe-desc     to exe-desc

           if tex-mcg-code not = mcg-code
              exit paragraph
           end-if.  
                                                                      
           modify gd1(riga, 78-col-grp-code), cell-data como-grp-code.
           modify gd1(riga, 78-col-grp-desc), cell-data como-grp-desc.
           modify gd1(riga, 78-col-exe-code), cell-data tex-exe-code.
           modify gd1(riga, 78-col-exe-desc), cell-data tex-exe-desc.

           modify gd1(riga + 1, 78-col-grp-code), cell-data grp-code.
           modify gd1(riga + 1, 78-col-grp-desc), cell-data grp-desc.
           modify gd1(riga + 1, 78-col-exe-code), cell-data exe-code.
           modify gd1(riga + 1, 78-col-exe-desc), cell-data exe-desc.
           
           inquire gd1(riga + 1, 78-col-day), cell-data in tex-day.
           inquire gd1(riga + 1, 78-col-prg), cell-data in tex-split.
           read tmp-exe no lock.       
           move tex-rec to como-tex-rec

           inquire gd1(riga, 78-col-day), cell-data in tex-day.
           inquire gd1(riga, 78-col-prg), cell-data in tex-split.    
           read tmp-exe no lock.    
           
           move tex-exe-code    to s-tex-exe-code.  
           move tex-exe-desc    to s-tex-exe-desc.   
           move tex-exe-isMulti to s-tex-exe-isMulti. 
           
           move como-tex-exe-code    to tex-exe-code.   
           move como-tex-exe-desc    to tex-exe-desc.   
           move como-tex-exe-isMulti to tex-exe-isMulti.
           rewrite tex-rec.                              

           move como-tex-key to tex-key.
           read tmp-exe no lock.

           move s-tex-exe-code    to tex-exe-code.   
           move s-tex-exe-desc    to tex-exe-desc.   
           move s-tex-exe-isMulti to tex-exe-isMulti.
           rewrite tex-rec.                

           add 1 to riga giving event-data-2.
           perform SPOSTAMENTO.
           modify gd1, cursor-y event-data-2 
           .
      * <TOTEM:END>
       pb-elimina-LinkTo.
      * <TOTEM:PARA. pb-elimina-LinkTo>
           inquire gd1, cursor-y in riga.                       
           if riga < 2 exit paragraph end-if.

           inquire gd1(riga, 78-col-day), hidden-data hiddenData.
           if hid-tex-day = 0
              inquire gd1(riga, 78-col-day), hidden-data hid-tot-exe
              if hid-tot-exe = 0
                 modify gd1, record-to-delete = riga
              end-if                                
              exit paragraph
           end-if.

           perform ELIMINA-RIGA.

           inquire gd1, last-row in tot-righe.
           if tot-righe = 1
              move 0 to mod
              perform ABILITAZIONI
           else
              perform RELOAD-GRID
           end-if 
           
           .
      * <TOTEM:END>
       pb-aggiungi-LinkTo.
      * <TOTEM:PARA. pb-aggiungi-LinkTo>
           inquire gd1, cursor-y riga, last-row in tot-righe.

           inquire gd1(riga, 78-col-day) hidden-data hiddenData
           if hid-tex-day = 0                                  
              inquire gd1(riga, 78-col-day) hidden-data hid-tot-exe
              if hid-tot-exe = 0
                 modify gd1, record-to-delete riga
              end-if
           end-if.
                                
           if riga <= tot-righe
              inquire gd1(riga, 78-col-day), cell-data in col-day
              inquire gd1(riga, 78-col-prg), cell-data in col-exe-prg

              inquire gd1(riga, 78-col-exe-code), cell-data in exe-code
              inquire gd1(riga, 78-col-grp-code), cell-data in grp-code
              inquire gd1(riga, 78-col-ss), cell-data col-ss
      
              if col-exe-prg = 0
                 inquire gd1(riga - 1, 78-col-day), cell-data in col-day
                 inquire gd1(riga - 1, 78-col-prg), cell-data in 
           col-exe-prg
                 inquire gd1(riga - 1, 78-col-exe-code), cell-data in 
           exe-code
                 inquire gd1(riga - 1, 78-col-grp-code), cell-data in 
           grp-code 
                 inquire gd1(riga - 1, 78-col-ss), cell-data col-ss
                 add 1 to col-exe-prg
              end-if
           end-if.            

           modify gd1, insertion-index riga, record-to-add rec-grid.

           modify gd1(riga, 78-col-day),    cell-data col-day, 
                                          hidden-data hiddenData.
           modify gd1(riga, 78-col-prg),    cell-data col-exe-prg.
           modify gd1(riga, 78-col-reps),   cell-data spaces.
           modify gd1(riga, 78-col-series), cell-data spaces.
           modify gd1(riga, 78-col-grp-code), cell-data spaces.
           modify gd1(riga, 78-col-grp-desc), cell-data spaces.
           modify gd1(riga, 78-col-exe-code), cell-data spaces.
           modify gd1(riga, 78-col-exe-desc), cell-data spaces.

           move col-day     to s-tex-day.
           move col-exe-prg to s-tex-split.

           perform LOOKUP-EXE.
           if stato-zoom not = 0
              move 0 to grp-code
              perform LOOKUP-EXE
              if stato-zoom not = 0
                 modify gd1, record-to-delete riga
                 exit paragraph
              end-if
           end-if. 

           move riga to riga-aggiunta.
                   
           inquire gd1(event-data-2, 1), hidden-data hiddendata. 
                               
           move s-tex-day to tex-day.
           move low-value to tex-split.
           start tmp-exe key >= tex-key
                 invalid continue
             not invalid
                 perform until 1 = 2
                    read tmp-exe next at end exit perform end-read
                    if tex-day not = s-tex-day
                       exit perform
                    end-if
                    delete tmp-exe record
                 end-perform
           end-start.     

           if riga > 2
              perform varying riga from riga by -1 
                        until riga = 2
                 inquire gd1(riga, 78-col-prg), cell-data col-exe-prg
                 if col-exe-prg = 0
                    add 1 to riga
                    exit perform
                 end-if
              end-perform
           end-if.

           perform varying riga from riga by 1 
                     until riga > tot-righe
              inquire gd1(riga, 78-col-prg), cell-data col-exe-prg
              if col-exe-prg = 0
                 inquire gd1(riga, 78-col-day), hidden-data hid-tot-exe
                 add 1 to hid-tot-exe                                  
                 modify gd1(riga, 78-col-day), hidden-data hid-tot-exe
                 exit perform
              end-if                             
              inquire gd1(riga, 78-col-day),    cell-data tex-day      
              inquire gd1(riga, 78-col-prg),    cell-data tex-split
              inquire gd1(riga, 78-col-series), cell-data col-series
              inquire gd1(riga, 78-col-reps),   cell-data col-reps
              inquire gd1(riga, 78-col-ss),     cell-data tex-ss

              inquire gd1(riga, 78-col-exe-code), cell-data exe-code
              read exercises no lock
              move exe-grp-code to grp-code
              read groups no lock

              move exe-code     to tex-exe-code
              move exe-desc     to tex-exe-desc
              move grp-mcg-code to tex-mcg-code
              move spaces       to tex-nome-dupl
              move exe-int-code to tex-int-code
              move exe-isMulti  to tex-exe-isMulti
              move col-series   to tex-series 
              move col-reps     to tex-reps
              perform until 1 = 2
                 write tex-rec
                       invalid add 1 to tex-split
                   not invalid exit perform
                 end-write
              end-perform
           end-perform.
                             
           modify gd1, mass-update = 1.
           modify gd1, reset-grid = 1.
           perform GD1-CONTENT.

           perform RELOAD-GRID.       

           perform RICALCOLA-HIT-DIV.
           perform CALCOLA-HIT-BOTTONI.

           move 78-ID-gd1 to control-id.
           move 4         to accept-control.
           move riga-aggiunta to event-data-2.
           move 78-col-series to event-data-1.
           modify gd1, cursor-x event-data-1, cursor-y riga-aggiunta.
           perform SPOSTAMENTO.
           set event-action to event-action-fail 
           .
      * <TOTEM:END>
       pb-mcg2-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg2-BeforeProcedure>
           move 2 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg1-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg1-BeforeProcedure>
           move 1 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg3-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg3-BeforeProcedure>
           move 3 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg4-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg4-BeforeProcedure>
           move 4 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg5-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg5-BeforeProcedure>
           move 5 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg6-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg6-BeforeProcedure>
           move 6 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg7-BeforeProcedure.
      * <TOTEM:PARA. pb-mcg7-BeforeProcedure>
           move 7 to idx.
           perform EVIDENZIA-GRUPPI 
           .
      * <TOTEM:END>
       pb-mcg7-AfterProcedure.
      * <TOTEM:PARA. pb-mcg7-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-mcg6-AfterProcedure.
      * <TOTEM:PARA. pb-mcg6-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-mcg5-AfterProcedure.
      * <TOTEM:PARA. pb-mcg5-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-mcg4-AfterProcedure.
      * <TOTEM:PARA. pb-mcg4-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-mcg3-AfterProcedure.
      * <TOTEM:PARA. pb-mcg3-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-mcg2-AfterProcedure.
      * <TOTEM:PARA. pb-mcg2-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       pb-mcg1-AfterProcedure.
      * <TOTEM:PARA. pb-mcg1-AfterProcedure>
           perform RESETTA-FONT 
           .
      * <TOTEM:END>
       cb-wod-Ex-Ntf-Selchange.
      * <TOTEM:PARA. cb-wod-Ex-Ntf-Selchange>

           perform ABILITA-MACROGRUPPI 
           .
      * <TOTEM:END>
       pb-int-LinkTo.
      * <TOTEM:PARA. pb-int-LinkTo>
           perform X-Y.
           if riga > 1
              move "intexe"    to Como-File
              call   "zoom-gt" using como-file, int-rec
                              giving stato-zoom
              cancel "zoom-gt"
              if stato-zoom = 0
                 inquire gd1(riga, 78-col-day), hidden-data hiddenData
                 move 0 to exe-isMulti |Non è mai multi ma è quello che scelgo
                 perform IMPOSTA-SERIES-REPS
                 modify gd1(riga, 78-col-reps),   cell-data col-reps
                 modify gd1(riga, 78-col-series), cell-data int-series
                 move hid-tex-key to tex-key
                 read tmp-exe no lock
                 move int-code      to tex-int-code
                 move col-reps      to tex-reps
                 move col-series    to tex-series
                 move int-restpause to tex-int-restpause
                 rewrite tex-rec          
                 perform RELOAD-GRID
              end-if 
           end-if 
           .
      * <TOTEM:END>
       pb-ok-BeforeProcedure.
      * <TOTEM:PARA. pb-ok-BeforeProcedure>
           modify pb-ok, bitmap-number 2 
           .
      * <TOTEM:END>
       pb-ok-AfterProcedure.
      * <TOTEM:PARA. pb-ok-AfterProcedure>
           modify pb-ok, bitmap-number 1 
           .
      * <TOTEM:END>
       pb-cancel-BeforeProcedure.
      * <TOTEM:PARA. pb-cancel-BeforeProcedure>
           modify pb-cancel, bitmap-number 2 
           .
      * <TOTEM:END>
       pb-cancel-AfterProcedure.
      * <TOTEM:PARA. pb-cancel-AfterProcedure>
           modify pb-cancel, bitmap-number 1 
           .
      * <TOTEM:END>
       pb-ok-LinkTo.
      * <TOTEM:PARA. pb-ok-LinkTo>
           perform varying control-id from 78-ID-ef-gg1 by 1 
                     until control-id > 78-ID-ef-gg7
              perform CONTROLLO-DATE
              if errori 
                 exit perform 
              end-if
           end-perform.


           if ( ef-gg1-buf not = "00/00/0000" ) and 
              ( ef-gg1-buf = ef-gg2-buf or ef-gg3-buf or ef-gg4-buf or
                             ef-gg5-buf or ef-gg6-buf or ef-gg7-buf )
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if
           if ( ef-gg2-buf not = "00/00/0000" ) and 
              ( ef-gg2-buf = ef-gg1-buf or ef-gg3-buf or ef-gg4-buf or
                             ef-gg5-buf or ef-gg6-buf or ef-gg7-buf )
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if.
           if ( ef-gg3-buf not = "00/00/0000" ) and 
              ( ef-gg3-buf = ef-gg1-buf or ef-gg2-buf or ef-gg4-buf or
                             ef-gg5-buf or ef-gg6-buf or ef-gg7-buf ) 
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if.
           if ( ef-gg4-buf not = "00/00/0000" ) and 
              ( ef-gg4-buf = ef-gg1-buf or ef-gg2-buf or ef-gg3-buf or
                             ef-gg5-buf or ef-gg6-buf or ef-gg7-buf ) 
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if.
           if ( ef-gg5-buf not = "00/00/0000" ) and 
              ( ef-gg5-buf = ef-gg1-buf or ef-gg2-buf or ef-gg3-buf or
                             ef-gg4-buf or ef-gg6-buf or ef-gg7-buf ) 
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if.
           if ( ef-gg6-buf not = "00/00/0000" ) and 
              ( ef-gg6-buf = ef-gg1-buf or ef-gg1-buf or ef-gg3-buf or
                             ef-gg4-buf or ef-gg5-buf or ef-gg7-buf ) 
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if.
           if ( ef-gg7-buf not = "00/00/0000" ) and 
              ( ef-gg7-buf = ef-gg1-buf or ef-gg2-buf or ef-gg3-buf or
                             ef-gg4-buf or ef-gg5-buf or ef-gg6-buf )
              display message "Le date devono essere diverse"
                        title tit-err
                         icon 2
              exit paragraph
           end-if.

           perform SALVATAGGIO 
           .
      * <TOTEM:END>
       ef-gg1-BeforeProcedure.
      * <TOTEM:PARA. ef-gg1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg2-BeforeProcedure.
      * <TOTEM:PARA. ef-gg2-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg3-BeforeProcedure.
      * <TOTEM:PARA. ef-gg3-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg4-BeforeProcedure.
      * <TOTEM:PARA. ef-gg4-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg5-BeforeProcedure.
      * <TOTEM:PARA. ef-gg5-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg6-BeforeProcedure.
      * <TOTEM:PARA. ef-gg6-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg7-BeforeProcedure.
      * <TOTEM:PARA. ef-gg7-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gg1-AfterProcedure.
      * <TOTEM:PARA. ef-gg1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       ef-gg2-AfterProcedure.
      * <TOTEM:PARA. ef-gg2-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       ef-gg3-AfterProcedure.
      * <TOTEM:PARA. ef-gg3-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       ef-gg4-AfterProcedure.
      * <TOTEM:PARA. ef-gg4-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       ef-gg5-AfterProcedure.
      * <TOTEM:PARA. ef-gg5-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       ef-gg6-AfterProcedure.
      * <TOTEM:PARA. ef-gg6-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       ef-gg7-AfterProcedure.
      * <TOTEM:PARA. ef-gg7-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-DATE 
           .
      * <TOTEM:END>
       TOOL-SELEZIONA-LinkTo.
      * <TOTEM:PARA. TOOL-SELEZIONA-LinkTo>
           inquire tool-seleziona, enabled in e-seleziona
           if e-seleziona = 1
              perform SELEZIONA
           end-if 
           .
      * <TOTEM:END>
       ef-desc-BeforeProcedure.
      * <TOTEM:PARA. ef-desc-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-desc-AfterProcedure.
      * <TOTEM:PARA. ef-desc-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       CANCELLA-LinkTo.
      * <TOTEM:PARA. CANCELLA-LinkTo>
           inquire tool-cancella, enabled in e-cancella
           if e-cancella = 1
              perform CANCELLA
           end-if 
           .
      * <TOTEM:END>
       pb-ripristino-LinkTo.
      * <TOTEM:PARA. pb-ripristino-LinkTo>
           move spaces to s-cb-wod-buf.
           perform ABILITA-MACROGRUPPI 
           .
      * <TOTEM:END>
       ef-des-BeforeProcedure.
      * <TOTEM:PARA. ef-des-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dta-from-BeforeProcedure.
      * <TOTEM:PARA. ef-dta-from-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dta-to-BeforeProcedure.
      * <TOTEM:PARA. ef-dta-to-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dtc-from-BeforeProcedure.
      * <TOTEM:PARA. ef-dtc-from-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dtc-to-BeforeProcedure.
      * <TOTEM:PARA. ef-dtc-to-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-map-BeforeProcedure.
      * <TOTEM:PARA. ef-map-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-exe-BeforeProcedure.
      * <TOTEM:PARA. ef-exe-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mul-BeforeProcedure.
      * <TOTEM:PARA. ef-mul-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-rep-BeforeProcedure.
      * <TOTEM:PARA. ef-rep-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-gss-BeforeProcedure.
      * <TOTEM:PARA. ef-gss-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-des-AfterProcedure.
      * <TOTEM:PARA. ef-des-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-dta-from-AfterProcedure.
      * <TOTEM:PARA. ef-dta-from-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-dta-to-AfterProcedure.
      * <TOTEM:PARA. ef-dta-to-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-dtc-from-AfterProcedure.
      * <TOTEM:PARA. ef-dtc-from-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-dtc-to-AfterProcedure.
      * <TOTEM:PARA. ef-dtc-to-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-map-AfterProcedure.
      * <TOTEM:PARA. ef-map-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-exe-AfterProcedure.
      * <TOTEM:PARA. ef-exe-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-mul-AfterProcedure.
      * <TOTEM:PARA. ef-mul-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-rep-AfterProcedure.
      * <TOTEM:PARA. ef-rep-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       ef-gss-AfterProcedure.
      * <TOTEM:PARA. ef-gss-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       rb-tut-BeforeProcedure.
      * <TOTEM:PARA. rb-tut-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-des-BeforeProcedure.
      * <TOTEM:PARA. rb-des-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-dta-BeforeProcedure.
      * <TOTEM:PARA. rb-dta-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-dtc-BeforeProcedure.
      * <TOTEM:PARA. rb-dtc-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-map-BeforeProcedure.
      * <TOTEM:PARA. rb-map-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-exe-BeforeProcedure.
      * <TOTEM:PARA. rb-exe-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-mul-BeforeProcedure.
      * <TOTEM:PARA. rb-mul-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-rep-BeforeProcedure.
      * <TOTEM:PARA. rb-rep-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-gss-BeforeProcedure.
      * <TOTEM:PARA. rb-gss-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-tut-AfterProcedure.
      * <TOTEM:PARA. rb-tut-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-des-AfterProcedure.
      * <TOTEM:PARA. rb-des-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-dta-AfterProcedure.
      * <TOTEM:PARA. rb-dta-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-dtc-AfterProcedure.
      * <TOTEM:PARA. rb-dtc-AfterProcedure>
           modify control-handle, color = colore-or
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       rb-map-AfterProcedure.
      * <TOTEM:PARA. rb-map-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-exe-AfterProcedure.
      * <TOTEM:PARA. rb-exe-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-mul-AfterProcedure.
      * <TOTEM:PARA. rb-mul-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-rep-AfterProcedure.
      * <TOTEM:PARA. rb-rep-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-gss-AfterProcedure.
      * <TOTEM:PARA. rb-gss-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-tut-LinkTo.
      * <TOTEM:PARA. rb-tut-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-des-LinkTo.
      * <TOTEM:PARA. rb-des-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-dta-LinkTo.
      * <TOTEM:PARA. rb-dta-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-dtc-LinkTo.
      * <TOTEM:PARA. rb-dtc-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-map-LinkTo.
      * <TOTEM:PARA. rb-map-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-exe-LinkTo.
      * <TOTEM:PARA. rb-exe-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-mul-LinkTo.
      * <TOTEM:PARA. rb-mul-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-rep-LinkTo.
      * <TOTEM:PARA. rb-rep-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-gss-LinkTo.
      * <TOTEM:PARA. rb-gss-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       pb-ok-f-BeforeProcedure.
      * <TOTEM:PARA. pb-ok-f-BeforeProcedure>
           modify pb-ok-f, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-ok-f-AfterProcedure.
      * <TOTEM:PARA. pb-ok-f-AfterProcedure>
           modify pb-ok-f, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-cancel-f-BeforeProcedure.
      * <TOTEM:PARA. pb-cancel-f-BeforeProcedure>
           modify pb-cancel-f, bitmap-number = 2 
           .
      * <TOTEM:END>
       pb-cancel-f-AfterProcedure.
      * <TOTEM:PARA. pb-cancel-f-AfterProcedure>
           modify pb-cancel-f, bitmap-number = 1 
           .
      * <TOTEM:END>
       pb-map-LinkTo.
      * <TOTEM:PARA. pb-map-LinkTo>
           move "wodmap"     to como-file.
           call "zoom-gt" using como-file, wom-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move wom-code to ef-map-buf
              display ef-map
              move wom-desc to lab-map-buf
              display lab-map
           end-if 
           .
      * <TOTEM:END>
       pb-exe-LinkTo.
      * <TOTEM:PARA. pb-exe-LinkTo>
           move "exercises"  to como-file.
           call "zoom-gt" using como-file, exe-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move exe-code to ef-exe-buf
              display ef-exe
              move exe-desc to lab-exe-buf
              display lab-exe
           end-if 
           .
      * <TOTEM:END>
       pb-mul-LinkTo.
      * <TOTEM:PARA. pb-mul-LinkTo>
           move "macrogroups"  to como-file.
           call "zoom-gt" using como-file, mcg-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move mcg-code to ef-mul-buf
              display ef-mul
              move mcg-desc to lab-mul-buf
              display lab-mul
           end-if 
           .
      * <TOTEM:END>
       pb-rep-LinkTo.
      * <TOTEM:PARA. pb-rep-LinkTo>
           move "macrogroups"  to como-file.
           call "zoom-gt" using como-file, mcg-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move mcg-code to ef-rep-buf
              display ef-rep
              move mcg-desc to lab-rep-buf
              display lab-rep
           end-if 
           .
      * <TOTEM:END>
       pb-gss-LinkTo.
      * <TOTEM:PARA. pb-gss-LinkTo>
           move "macrogroups"  to como-file.
           call "zoom-gt" using como-file, mcg-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move mcg-code to ef-gss-buf
              display ef-gss
              move mcg-desc to lab-gss-buf
              display lab-gss
           end-if 
           .
      * <TOTEM:END>
       pb-mcg-LinkTo.
      * <TOTEM:PARA. pb-mcg-LinkTo>
           move "macrogroups"  to como-file.
           call "zoom-gt" using como-file, mcg-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move mcg-code to ef-mcg-buf
              display ef-mcg
              move mcg-desc to lab-mcg-buf
              display lab-mcg
           end-if 
           .
      * <TOTEM:END>
       ef-mcg-BeforeProcedure.
      * <TOTEM:PARA. ef-mcg-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-mcg-AfterProcedure.
      * <TOTEM:PARA. ef-mcg-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       rb-mcg-BeforeProcedure.
      * <TOTEM:PARA. rb-mcg-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-mcg-AfterProcedure.
      * <TOTEM:PARA. rb-mcg-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       pb-ok-f-LinkTo.
      * <TOTEM:PARA. pb-ok-f-LinkTo>
           perform varying control-id from 78-ID-ef-des by 1
                     until control-id > 78-ID-ef-dur
              perform CONTROLLO-FILTRO
              if errori
                 exit perform
              end-if
           end-perform.
           move 0 to tot-righe.

           if errori exit paragraph end-if.

           accept como-data from century-date.
           accept como-ora  from time
           accept  path-zoom-wodbook from environment "PATH_ST".
           inspect path-zoom-wodbook replacing trailing spaces by 
           low-value.
           string  path-zoom-wodbook delimited low-value
                   "zoom-wodbook_"   delimited size
                   como-data         delimited size
                   "-"               delimited size
                   como-ora          delimited size
              into path-zoom-wodbook 
           end-string.
           open output zoom-wodbook.
           close       zoom-wodbook.
           open i-o    zoom-wodbook.

           set tutto-ok to true.
           move low-value to tod-rec rod-rec.
           evaluate tipo-filtro
           when 1          
                set filtro-testa to true        
                move 0 to tod-code
                start twodbook key >= tod-key
                      invalid set errori to true
                end-start
                move 78-ID-rb-tut to control-id
           when 2                               
                set filtro-testa to true        
                move 0 to tod-code
                move 100 to text-len
                call "C$TOUPPER" using ef-des-buf, value text-len
                move ef-des-buf to tod-desc
                start twodbook key >= tod-k-desc
                      invalid set errori to true
                end-start                                               
            
                inspect ef-des-buf replacing trailing spaces by 
           low-value
                move 0 to countChar
                inspect ef-des-buf tallying countChar for characters 
           before low-value  
                inspect ef-des-buf replacing trailing low-value by 
           spaces
                move 78-ID-rb-des to control-id
           when 3                               
                set filtro-testa to true        
                move 0 to tod-code
                move como-data-from to tod-day-ini
                start twodbook key >= tod-k-ini
                      invalid set errori to true
                end-start        
                move 78-ID-rb-dta to control-id
           when 4                               
                set filtro-testa to true        
                move 0 to tod-code
                move como-data-from to tod-data-creazione
                start twodbook key >= tod-k-creazione
                      invalid set errori to true
                end-start        
                move 78-ID-rb-dta to control-id                   
           when 5                               
                set filtro-testa to true        
                move 0 to tod-code
                move ef-map-buf to wom-code tod-wom-code
                start twodbook key >= tod-k-wom
                      invalid set errori to true
                end-start        
                move 78-ID-rb-map to control-id
           when 11                              
                set filtro-testa to true        
                move 0 to tod-code
                move ef-dur-buf  to tod-code
                move como-effort to tod-wom-effort
                start twodbook key >= tod-k-eff
                      invalid set errori to true
                end-start        
                move 78-ID-rb-eff to control-id
           when 12                              
                set filtro-testa to true        
                move 0 to tod-code
                move ef-dur-buf to dur-code tod-dur-code
                start twodbook key >= tod-k-dur
                      invalid set errori to true
                end-start     
                move 78-ID-rb-dur to control-id
           when 6                               
                set filtro-righe to true        
                move low-value  to rod-rec
                move ef-exe-buf to rod-exe-code
                start rwodbook key >= rod-k-exe
                      invalid set errori to true
                end-start        
                move 78-ID-rb-exe to control-id
           when 7                               
                set filtro-righe to true 
                move ef-mul-buf to rod-mcg-code
                move 1 to rod-exe-isMulti
                start rwodbook key >= rod-k-multi
                      invalid set errori to true
                end-start                      
                move 78-ID-rb-mul to control-id
           when 8                               
                set filtro-righe to true 
                move ef-rep-buf to rod-mcg-code
                move 1 to rod-int-restpause
                start rwodbook key >= rod-k-rp
                      invalid set errori to true
                end-start        
                move 78-ID-rb-rep to control-id
           when 9                               
                set filtro-righe to true 
                move ef-gss-buf to rod-mcg-code
                move 1 to rod-ss
                start rwodbook key >= rod-k-ss
                      invalid set errori to true
                end-start        
                move 78-ID-rb-gss to control-id
           when 10                              
                set filtro-righe to true 
                move ef-mcg-buf to rod-mcg-code
                start rwodbook key >= rod-k-mcg
                      invalid set errori to true
                end-start        
                move 78-ID-rb-mcg to control-id
           end-evaluate.       
           move 4 to accept-control.

           if tutto-ok          
              perform until 1 = 2
                 if filtro-testa 
                    read twodbook next no lock at end exit perform 
           end-read
                 else                                              
                    read rwodbook next no lock at end exit perform 
           end-read
                 end-if
                 set record-ok to false
                 evaluate tipo-filtro
                 when 1  |Tutto               
                      set record-ok to true
                 when 2  |Descrizione                             
                      if ef-des-buf not = spaces                        
                         move 100 to text-len
                         call "C$TOUPPER" using tod-desc, value text-len
                         if tod-desc(1:countChar) =
                            ef-des-buf
                            set record-ok to true
                         end-if
                      else
                         set record-ok to true
                      end-if
                 when 3  |Data allenamento            
                      inquire ef-dta-from, value in como-data
                      perform DATE-TO-FILE
                      move como-data to como-data-from

                      inquire ef-dta-to, value in como-data
                      perform DATE-TO-FILE
                      move como-data to como-data-to

                      set filtro-testa to true
                      if tod-day-ini > como-data-to
                         exit perform
                      else
                         if tod-day-ini >= como-data-from and <= 
           como-data-to
                            set record-ok to true
                         end-if
                      end-if
                 when 4  |Data creazione              
                      inquire ef-dtc-from, value in como-data
                      perform DATE-TO-FILE
                      move como-data to como-data-from

                      inquire ef-dtc-to, value in como-data
                      perform DATE-TO-FILE
                      move como-data to como-data-to

                      set filtro-testa to true
                      if tod-data-creazione > como-data-to
                         exit perform
                      else
                         if tod-data-creazione >= como-data-from and <= 
           como-data-to
                            set record-ok to true
                         end-if
                      end-if
                 when 5  |Mappatura           
                      if wom-code not = tod-wom-code and
                         wom-code not = spaces
                         exit perform
                      else
                         set record-ok to true
                      end-if
                 when 11  |Effort             
                      if como-effort not = tod-wom-effort and
                         como-effort not = 0
                         exit perform
                      else
                         set record-ok to true
                      end-if
                 when 12  |Durata             
                      if dur-code not = tod-dur-code and
                         dur-code not = spaces
                         exit perform
                      else
                         set record-ok to true
                      end-if
                 when 6  |Esercizio           
                      if rod-exe-code = ef-exe-buf or ef-exe-buf = 
           spaces
                         set record-ok to true           
                      else
                         exit perform
                      end-if
                 when 7  |Multi                                          
                      if rod-exe-isMulti = 0
                         exit perform
                      else
                         if rod-mcg-code = ef-mul-buf or 
                            ef-mul-buf = spaces
                            set record-ok to true
                         end-if
                      end-if
                 when 8  |RP                                       
                      if rod-mcg-code = ef-rep-buf or ef-rep-buf = 
           spaces
                         if rod-int-restpause > 0
                            set record-ok to true
                         end-if
                      end-if
                 when 9  |SS        
                      if rod-mcg-code = ef-gss-buf or ef-gss-buf = 
           spaces
                         if rod-ss > 0
                            set record-ok to true
                         end-if
                      end-if
                 when 10 |Gruppo
                      if rod-mcg-code = ef-mcg-buf or ef-mcg-buf = 
           spaces
                         set record-ok to true
                      else
                         exit perform
                      end-if
                 end-evaluate

                 if record-ok  
                    if filtro-righe
                       move rod-code to tod-code
                       read twodbook
                    end-if
                    add 1 to tot-righe                 
                    move tod-code           to zwod-code     
                    inspect zwod-code replacing leading x"30" by x"20"
                    call "C$JUSTIFY" using zwod-code, "L"
                    move tod-desc           to zwod-desc
                    move tod-data-creazione to zwod-creation 
                    move tod-day-ini        to zwod-ini      
                    move tod-gg             to zwod-gg       
                    move tod-tot-exe        to zwod-exe      
                    move tod-wom-code       to wom-code
                    read wodmap             
                    move wom-desc           to zwod-wom-desc 
                    move tod-dur-code       to dur-code
                    read duration             
                    move dur-desc           to zwod-dur-desc 
                    evaluate tod-wom-effort                  
                    when 1 move "Light wod effort"  to zwod-effort
                    when 2 move "Medium wod effort" to zwod-effort
                    when 3 move "Heavy wod effort"  to zwod-effort
                    end-evaluate
                    
                    write zwod-rec invalid rewrite zwod-rec end-write
                 end-if
              end-perform
           end-if.

           close zoom-wodbook.
                                
           move 0 to tod-code.
           if tot-righe = 0     
              display message "Nessun WOD disponibile nei filtri richies
      -    "ti"
                        title titolo
                         icon 2
           else
               move path-zoom-wodbook to ext-file
               move "zoom-wodbook"    to Como-File
               call   "zoom-gt"   using como-file, zwod-rec
                                 giving stato-zoom
               cancel "zoom-gt"
           
               if stato-zoom = 0
                  move 0 to nessuna-scelta
                  move zwod-code to tod-code
               else
                  move 1 to nessuna-scelta
               end-if                    
               move 27 to key-status
           end-if.
           delete file zoom-wodbook
                                     
           .
      * <TOTEM:END>
       Screen3-Cm-1-BeforeProcedure.
      * <TOTEM:PARA. Screen3-Cm-1-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       Screen3-Cm-1-AfterProcedure.
      * <TOTEM:PARA. Screen3-Cm-1-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           .
      * <TOTEM:END>
       rb-eff-LinkTo.
      * <TOTEM:PARA. rb-eff-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       rb-eff-BeforeProcedure.
      * <TOTEM:PARA. rb-eff-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-eff-AfterProcedure.
      * <TOTEM:PARA. rb-eff-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-dur-BeforeProcedure.
      * <TOTEM:PARA. rb-dur-BeforeProcedure>
           modify control-handle, color = colore-nu
           .
      * <TOTEM:END>
       rb-dur-AfterProcedure.
      * <TOTEM:PARA. rb-dur-AfterProcedure>
           modify control-handle, color = colore-or
           .
      * <TOTEM:END>
       rb-dur-LinkTo.
      * <TOTEM:PARA. rb-dur-LinkTo>
           perform SEL-FILTRO 
           .
      * <TOTEM:END>
       ef-dur-BeforeProcedure.
      * <TOTEM:PARA. ef-dur-BeforeProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-NU
           .
      * <TOTEM:END>
       ef-dur-AfterProcedure.
      * <TOTEM:PARA. ef-dur-AfterProcedure>
           MODIFY CONTROL-HANDLE COLOR = COLORE-OR
           perform CONTROLLO-FILTRO 
           .
      * <TOTEM:END>
       pb-dur-LinkTo.
      * <TOTEM:PARA. pb-dur-LinkTo>
           move "duration"   to como-file.
           call "zoom-gt" using como-file, dur-rec
                         giving stato-zoom.
           cancel "zoom-gt".
           if stato-zoom = 0           
              move dur-code to ef-dur-buf
              display ef-dur
              move dur-desc to lab-dur-buf
              display lab-dur
           end-if 
           .
      * <TOTEM:END>
       pb-mod-LinkTo.
      * <TOTEM:PARA. pb-mod-LinkTo>
           unlock twodbook all records.
           unlock rwodbook all records.
           call   "modwod" using lk-blockpgm, tod-code.
           cancel "modwod" 
           .
      * <TOTEM:END>

      *{TOTEM}END

      *{TOTEM}SHOW-MSG
       MESSAGE-FOR-FILEERROR.
           CALL "C$RERRNAME" USING TOTEM-MSG-ERR-FILE
           CALL "C$RERR" USING EXTEND-STAT, TEXT-MESSAGE
              MOVE PRIMARY-ERROR TO TOTEM-MSG-ID
           .

       SHOW-TRANSACTION-ROUTINE.
           IF TOTEM-TRANSACTION-FLAG = SPACES
              IF TRANSACTION-STATUS NOT = 0
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-1
              END-IF
           ELSE
              PERFORM SHOW-MSG-ROUTINE
              IF TRANSACTION-STATUS = 0
                 MOVE "Transazione terminata con Rollback." TO 
           TOTEM-MSG-3
              ELSE
                 STRING "TRANSACTION ERROR ", TRANSACTION-STATUS
                    DELIMITED BY SIZE INTO TOTEM-MSG-3
              END-IF
           END-IF
           .

       SHOW-MSG-ROUTINE.
           MOVE SPACE TO TOTEM-MSG-1 TOTEM-MSG-2 TOTEM-MSG-3
           EVALUATE TOTEM-MSG-ID
               WHEN "10"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Nessun altro dato." TO TOTEM-MSG-2
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "22"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Chiave Duplicata." TO TOTEM-MSG-2
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "23"
                    STRING "File:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-1
                    MOVE "Raggiunta fine file." TO TOTEM-MSG-2
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "101"
                    MOVE "Terminare l'applicazione?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "201"
                    MOVE "Aggiungere un nuovo record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "202"
                    MOVE "Aggiornare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "203"
                    MOVE "Cancellare il Record?" TO TOTEM-MSG-1
                    MOVE 4 TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-YES-NO TO TOTEM-MSG-BUTTON-TYPE
               WHEN "204"
                    MOVE "Chiave duplicata." TO TOTEM-MSG-1
                    MOVE MB-WARNING-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "301"
                    MOVE "Inserimento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "302"
                    MOVE "Aggiornamento avvenuto con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "303"
                    MOVE "Cancellazione avvenuta con Successo." TO 
           TOTEM-MSG-1
                    MOVE MB-DEFAULT-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN "401"
                    MOVE "Shell non trovata." TO TOTEM-MSG-1
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
               WHEN OTHER
                    MOVE TEXT-MESSAGE TO TOTEM-MSG-1
                    STRING "FILE:" TOTEM-MSG-ERR-FILE DELIMITED BY SPACE
                       INTO TOTEM-MSG-3
                    MOVE 0 TO TOTEM-IDX1
                    INSPECT TOTEM-MSG-3 TALLYING TOTEM-IDX1
                       FOR TRAILING SPACE
                    STRING TOTEM-MSG-3(1:TOTEM-MSG-LENGTH - 
           TOTEM-IDX1), 
                       ", FILE STATUS ", PRIMARY-ERROR "," 
                       SECONDARY-ERROR
                    DELIMITED BY SIZE INTO TOTEM-MSG-2
                    MOVE SPACES TO TOTEM-MSG-3
                    MOVE MB-ERROR-ICON TO TOTEM-MSG-ICON-TYPE
                    MOVE MB-OK TO TOTEM-MSG-BUTTON-TYPE
           END-EVALUATE
           PERFORM MESSAGE-BOX-ROUTINE
           .

       MESSAGE-BOX-ROUTINE.
           MOVE 1 TO TOTEM-MSG-TEXT-POINTER
           IF TOTEM-MSG-1 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-1 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              STRING TOTEM-MSG-1( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                 DELIMITED BY SIZE
                 INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-2 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-2 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-2( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-3 NOT = SPACE
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-3 TALLYING TOTEM-MSG-SIZE FOR TRAILING 
           SPACE
              IF TOTEM-MSG-TEXT-POINTER > 1
                 STRING X"0A" DELIMITED BY SIZE
                     INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
              END-IF
              STRING TOTEM-MSG-3( 1 : TOTEM-MSG-LENGTH - TOTEM-MSG-SIZE 
           )
                  DELIMITED BY SIZE
                  INTO TOTEM-MSG-TEXT, POINTER TOTEM-MSG-TEXT-POINTER
           END-IF

           IF TOTEM-MSG-TEXT-POINTER = 1
              MOVE 0 TO TOTEM-MSG-SIZE
              INSPECT TOTEM-MSG-TEXT TALLYING TOTEM-MSG-SIZE FOR 
           TRAILING SPACE
                  COMPUTE TOTEM-MSG-TEXT-POINTER = 
           TOTEM-MSG-FULL-LENGTH - TOTEM-MSG-SIZE + 1
           END-IF
           MOVE LOW-VALUES TO TOTEM-MSG-TEXT(TOTEM-MSG-TEXT-POINTER : 1 
           )
           .

       MESSAGE-BOX-DISPLAY.
           PERFORM SHOW-MSG-ROUTINE
           PERFORM MESSAGE-BOX-ROUTINE
           DISPLAY MESSAGE BOX TOTEM-MSG-TEXT
               TITLE IS TOTEM-MSG-TITLE
               TYPE  IS TOTEM-MSG-BUTTON-TYPE
               ICON  IS TOTEM-MSG-DEFAULT-BUTTON
               RETURNING TOTEM-MSG-RETURN-VALUE
           .

      *{TOTEM}END

